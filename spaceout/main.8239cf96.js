parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function ld(a){return a&&a.__esModule?{d:a.default}:{d:a}}var sb=this;function Si(e){return(Si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function md(){return(md="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,a){var r=Ti(e,t);if(r){var $=Object.getOwnPropertyDescriptor(r,t);return $.get?$.get.call(arguments.length<3?e:a):$.value}}).apply(this,arguments)}function Ti(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=tb(e)););return e}function Ui(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vi(e,t)}function Vi(e,t){return(Vi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Wi(e){var t=Yi();return function(){var a,r=tb(e);if(t){var $=tb(this).constructor;a=Reflect.construct(r,arguments,$)}else a=r.apply(this,arguments);return Xi(this,a)}}function Xi(e,t){if(t&&("object"===Si(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ta(e)}function Ta(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function tb(e){return(tb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jf(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nd(e,t,a){return t&&jf(e.prototype,t),a&&jf(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function od(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kf(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $i(e,t,o){return t&&kf(e.prototype,t),o&&kf(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _i(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function lf(a,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}function aj(a,t,e){return t&&lf(a.prototype,t),e&&lf(a,e),Object.defineProperty(a,"prototype",{writable:!1}),a}function bj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mf(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function cj(t,e,a){return e&&mf(t.prototype,e),a&&mf(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}var ub=function(){function t(){bj(this,t),this.data={},this.dataAsList=[]}return cj(t,[{key:"register",value:function(t,e){this.data[t]&&console.warn(t," ALREADY EXIST IN DATA HOLDER"),this.data[t]=e,this.dataAsList.push(e)}},{key:"hasKey",value:function(t){return!!this.data[t]}},{key:"getData",value:function(t){return console.assert(this.data[t],t," not in: ",this.data),this.data[t]}},{key:"getDataAsList",value:function(){return this.dataAsList}}]),t}();var nf=new ub,ab=function(){function a(){_i(this,a)}return aj(a,null,[{key:"AddInteraction",value:function(a,t){nf.register(a,t)}},{key:"RunInteractionAtAccessor",value:function(a,t,e){nf.getData(a)[t](e)}}]),a}();var ta=window.lodash.merge;var of=window.lodash;function dj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pf(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ej(e,t,a){return t&&pf(e.prototype,t),a&&pf(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function fj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qf(e,t){for(var o=0;o<t.length;o++){var $=t[o];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(e,$.key,$)}}function gj(e,t,o){return t&&qf(e.prototype,t),o&&qf(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}var Xb="SCENE_GAME";var vb="SCENE_GAMEPLAY";var qc="SCENE_INTERFACE";var rc="SCENE_PAUSE";var sc="SCENE_ROTATE";var tc=new ub,sa=function(){function e(){fj(this,e)}return gj(e,null,[{key:"RegisterScene",value:function(e,t,o){return tc.register(t,{sceneRef:e,name:t,canBePaused:o}),e}},{key:"GetScene",value:function(e){return tc.getData(e).sceneRef}},{key:"GetGameplayScene",value:function(){return tc.getData(vb).sceneRef}},{key:"GetSceneList",value:function(){return tc.getDataAsList()}}]),e}();function rf(e,a){for(var t=0;t<a.length;t++){var n=a[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pd(e,a,t){return a&&rf(e.prototype,a),t&&rf(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qd(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}var wb,xb,yb={},qa=yb={};function rd(){throw new Error("setTimeout has not been defined")}function sd(){throw new Error("clearTimeout has not been defined")}function sf(r){if(wb===setTimeout)return setTimeout(r,0);if((wb===rd||!wb)&&setTimeout)return wb=setTimeout,setTimeout(r,0);try{return wb(r,0)}catch($){try{return wb.call(null,r,0)}catch($){return wb.call(this,r,0)}}}function hj(r){if(xb===clearTimeout)return clearTimeout(r);if((xb===sd||!xb)&&clearTimeout)return xb=clearTimeout,clearTimeout(r);try{return xb(r)}catch($){try{return xb.call(null,r)}catch($){return xb.call(this,r)}}}!function(){try{wb="function"==typeof setTimeout?setTimeout:rd}catch(r){wb=rd}try{xb="function"==typeof clearTimeout?clearTimeout:sd}catch(r){xb=sd}}();var Yb,bb=[],td=!1,tf=-1;function ij(){td&&Yb&&(td=!1,Yb.length?bb=Yb.concat(bb):tf=-1,bb.length&&uf())}function uf(){if(!td){var r=sf(ij);td=!0;for(var $=bb.length;$;){for(Yb=bb,bb=[];++tf<$;)Yb&&Yb[tf].run();tf=-1,$=bb.length}Yb=null,td=!1,hj(r)}}function vf(r,$){this.fun=r,this.array=$}function Ra(){}qa.nextTick=function(r){var $=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)$[e-1]=arguments[e];bb.push(new vf(r,$)),1!==bb.length||td||sf(uf)},vf.prototype.run=function(){this.fun.apply(null,this.array)},qa.title="browser",qa.env={},qa.argv=[],qa.version="",qa.versions={},qa.on=Ra,qa.addListener=Ra,qa.once=Ra,qa.off=Ra,qa.removeListener=Ra,qa.removeAllListeners=Ra,qa.emit=Ra,qa.prependListener=Ra,qa.prependOnceListener=Ra,qa.listeners=function(r){return[]},qa.binding=function(r){throw new Error("process.binding is not supported")},qa.cwd=function(){return"/"},qa.chdir=function(r){throw new Error("process.chdir is not supported")},qa.umask=function(){return 0};function jj(o){return(jj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(o)}var fa={android:!1,chromeOS:!1,cordova:!1,crosswalk:!1,desktop:!1,ejecta:!1,electron:!1,iOS:!1,iOSVersion:0,iPad:!1,iPhone:!1,kindle:!1,linux:!1,macOS:!1,node:!1,nodeWebkit:!1,pixelRatio:1,webApp:!1,windows:!1,windowsPhone:!1},kj=!1;function Ja(){if(kj)return fa;kj=!0;var o=navigator.userAgent;/Windows/.test(o)?fa.windows=!0:/Mac OS/.test(o)&&!/like Mac OS/.test(o)?navigator.maxTouchPoints&&navigator.maxTouchPoints>2?(fa.iOS=!0,fa.iPad=!0,navigator.appVersion.match(/Version\/(\d+)/),fa.iOSVersion=parseInt(RegExp.$1,10)):fa.macOS=!0:/Android/.test(o)?fa.android=!0:/Linux/.test(o)?fa.linux=!0:/iP[ao]d|iPhone/i.test(o)?(fa.iOS=!0,navigator.appVersion.match(/OS (\d+)/),fa.iOSVersion=parseInt(RegExp.$1,10),fa.iPhone=-1!==o.toLowerCase().indexOf("iphone"),fa.iPad=-1!==o.toLowerCase().indexOf("ipad")):/Kindle/.test(o)||/\bKF[A-Z][A-Z]+/.test(o)||/Silk.*Mobile Safari/.test(o)?fa.kindle=!0:/CrOS/.test(o)&&(fa.chromeOS=!0),(/Windows Phone/i.test(o)||/IEMobile/i.test(o))&&(fa.android=!1,fa.iOS=!1,fa.macOS=!1,fa.windows=!0,fa.windowsPhone=!0);var $=/Silk/.test(o);return(fa.windows||fa.macOS||fa.linux&&!$||fa.chromeOS)&&(fa.desktop=!0),(fa.windowsPhone||/Windows NT/i.test(o)&&/Touch/i.test(o))&&(fa.desktop=!1),navigator.standalone&&(fa.webApp=!0),void 0!==window.cordova&&(fa.cordova=!0),void 0!==yb&&yb.versions&&yb.versions.node&&(fa.node=!0),fa.node&&"object"===jj(yb.versions)&&(fa.nodeWebkit=!!yb.versions["node-webkit"],fa.electron=!!yb.versions.electron),void 0!==window.ejecta&&(fa.ejecta=!0),/Crosswalk/.test(o)&&(fa.crosswalk=!0),fa.pixelRatio=window.devicePixelRatio||1,fa}var ud=function(t,$,e){return Math.max($,Math.min(e,t))};function wf(e,a){for(var $=0;$<a.length;$++){var g=a[$];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(e,g.key,g)}}function xf(e,a,$){return a&&wf(e.prototype,a),$&&wf(e,$),Object.defineProperty(e,"prototype",{writable:!1}),e}function yf(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function lj(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function zf(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function mj(e,o,t){return o&&zf(e.prototype,o),t&&zf(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function nj(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function Af(e,a){for(var r=0;r<a.length;r++){var t=a[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function oj(e,a,r){return a&&Af(e.prototype,a),r&&Af(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bf(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vd(t,e,a){return e&&Bf(t.prototype,e),a&&Bf(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function wd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pj(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Cf(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function qj(e,r,t){return r&&Cf(e.prototype,r),t&&Cf(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function rj(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function Df(e,a){for(var i=0;i<a.length;i++){var t=a[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function sj(e,a,i){return a&&Df(e.prototype,a),i&&Df(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function tj(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function Ef(e,a){for(var r=0;r<a.length;r++){var n=a[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function uj(e,a,r){return a&&Ef(e.prototype,a),r&&Ef(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var uc=new ub,ja=function(){function e(){tj(this,e)}return uj(e,null,[{key:"AddCommandHandlerRequiringActor",value:function(e,a){var r={name:e,func:a,requireActor:!0};uc.register(e,r)}},{key:"AddCommandHandler",value:function(e,a){var r={name:e,func:a,requireActor:!1};uc.register(e,r)}},{key:"RunCommandByActor",value:function(e,a,r){var n=uc.getData(e);n.requireActor?n.func(a,r):n.func(r)}},{key:"RunCommand",value:function(e,a){var r=uc.getData(e);r.requireActor?console.error("IMPLEMENTED EDGE CASE"):r.func(a)}}]),e}();function vj(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function Ff(e,a){for(var t=0;t<a.length;t++){var $=a[t];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(e,$.key,$)}}function wj(e,a,t){return a&&Ff(e.prototype,a),t&&Ff(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function xj(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function Gf(e,a){for(var r=0;r<a.length;r++){var t=a[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function yj(e,a,r){return a&&Gf(e.prototype,a),r&&Gf(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var xd=[],Hf=function(){function e(){xj(this,e)}return yj(e,null,[{key:"RefreshSaveDataReferenceFromStorage",value:function(e,a){var r={name:e,data:null};return localStorage.getItem(e)&&void 0!==localStorage.getItem(e)&&"undefined"!==localStorage.getItem(e)?(console.log("Loaded GameData: ",localStorage.getItem(e)),a=JSON.parse(localStorage.getItem(e))):console.log("Init GameData: ",localStorage.getItem(e),a),r.data=a,xd.push(r),a}},{key:"SaveData",value:function(){for(var e in xd){var a=xd[e];localStorage.setItem(a.name,JSON.stringify(a.data))}}}]),e}();function zj(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function If(e,r){for(var a=0;a<r.length;a++){var t=r[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function Aj(e,r,a){return r&&If(e.prototype,r),a&&If(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bj(t){return(Bj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Cj=function(t){if("object"!==Bj(t)||t.nodeType||t===t.window)return!1;try{if(t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(o){return!1}return!0};var Jf=new ub,Dj="_";function Kf(e){return Dj+e}var Lf=function(){function e(){zj(this,e)}return Aj(e,null,[{key:"RegisterNodeTree",value:function(e){for(var r in e)Jf.register(r,e[r])}},{key:"CreateFromNode",value:function(e,r){var a=[],t=Jf.getData(e);for(var o in t){var $=t[o];if(Cj($)){null==$.times&&($.times=1);for(var n=function(e){for(var a=ga.GetBakedFromDef($.prefab,r),t=JSON.parse(JSON.stringify($.post)),o=0;o<t.length;o++){var n=t[o];of.forIn(n,function(r,a){null!=r._iteratorMultiplier&&(r._iterator=e)})}ga.TriggerCommandList(a,t)},u=0;u<$.times;u++)n(u)}else a.push(ga.GetBakedFromDef($,r))}for(var i in a){var l=a[i];Da.InjectIntoActor(l,[Kf(e)])}return ia.CallHook("CreateFromNode",{name:e,fullname:Kf(e)}),a}}]),e}();var Zb=0,$b=1,Ej=-1,_b=-2,cb=new ub,ha={enterQueue:[],exitQueue:[],nextEnterQueue:[],exitAfterEnterQueue:[]},Fj=!1,db="_nano_state_",da=function(){function e(){vj(this,e)}return wj(e,null,[{key:"GetNanoStateBagQualifier",value:function(){return db}},{key:"CallStatesUpdate",value:function(e){for(var a=cb.getDataAsList(),t=0;t<a.length;t++){var $=a[t];$.onPreUpdate&&$.substate==$b&&$.onPreUpdate(e)}for(var r=0;r<a.length;r++){var v=a[r];v.onUpdate&&v.substate==$b&&v.onUpdate(e)}for(var n=0;n<a.length;n++){var N=a[n];N.onPostUpdate&&N.substate==$b&&N.onPostUpdate(e)}Fj=!0}},{key:"ExitQueuedStates",value:function(e){for(var a=e,t=0;t<ha.exitQueue.length;t++){var $=ha.exitQueue[t],r=cb.getData($);r.substate>Zb&&(r.substate=Ej,ga.ListTriggerCommandsAtKey(db+$,"NodeExit"),r.onExit&&r.onExit(db+$))}if(ha.enterQueue.length>0)for(var v=0;v<ha.enterQueue.length;v++){var n=ha.enterQueue[v],N=cb.getData(n);0!=N.substate&&N.substate!=_b&&(N.substate=_b)}for(var u=cb.getDataAsList(),o=0;o<u.length;o++){var R=u[o];R.substate<Zb&&(R.curExitTime+=a,R.curExitTime>=R.maxExitTime&&R.substate!=_b&&(R.curExitTime=0,R.substate=_b))}for(var s=0;s<u.length;s++){var i=u[s];i.substate==_b&&(i.substate=Zb,i.onQuit&&i.onQuit(db+i.name),pa.TriggerCommandOnActorsInBag("Dispose",db+i.name))}ha.exitQueue.length>0&&(ha.exitQueue=[])}},{key:"EnterQueuedStates",value:function(){for(var e=0;e<ha.enterQueue.length;e++){var a=ha.enterQueue[e],t=cb.getData(a),$=t.substate;if($<=Zb){if(t.substate=$b,t.nodes)for(var r=0;r<t.nodes.length;r++){var v=t.nodes[r];Lf.CreateFromNode(v,a)}t.onEnter&&t.onEnter(db+a),ga.ListTriggerCommandsAtKey(db+a,"NodeEnter"),Hf.SaveData(),console.log("GameData Saved from: EnterQueuedStates")}else console.warn("wanted to enter state that is in substate:",$,a)}if(ha.enterQueue.length>0&&(ha.enterQueue=[]),ha.nextEnterQueue.length>0){for(var n=0;n<ha.nextEnterQueue.length;n++)ha.enterQueue.push(ha.nextEnterQueue[n]);ha.nextEnterQueue=[]}Fj=!1,0==ha.nextEnterQueue.length&&0==ha.enterQueue.length&&ha.exitAfterEnterQueue.length>0&&0==ha.exitQueue.length&&(ha.exitQueue=ha.exitAfterEnterQueue,ha.exitAfterEnterQueue=[])}},{key:"RegisterState",value:function(e,a,t){null==a&&(a=null);var $={name:e,substate:Zb,curExitTime:0,maxExitTime:.5,nodes:a};ta($,t),cb.register(e,$)}},{key:"EnterState",value:function(e){var a;(a=Fj?ha.nextEnterQueue:ha.enterQueue).indexOf(e)>-1?console.warn("CALLED ENTER STATE WHILE STATE IS QUEUED TO ENTER"):a.push(e)}},{key:"ExitState",value:function(e){if(ha.enterQueue.indexOf(e)>-1||ha.nextEnterQueue.indexOf(e)>-1){if(ha.exitAfterEnterQueue.indexOf(e)>-1)return;ha.exitAfterEnterQueue.push(e)}else ha.exitQueue.indexOf(e)>-1||ha.exitQueue.push(e)}},{key:"IsStateActive",value:function(e){return cb.getData(e).substate==$b}}]),e}();function Gj(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function Mf(e,a){for(var t=0;t<a.length;t++){var r=a[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hj(e,a,t){return a&&Mf(e.prototype,a),t&&Mf(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var zb=new ub,La=function(){function e(){Gj(this,e)}return Hj(e,null,[{key:"RegisterSystem",value:function(e){var a=e.SystemName;return console.assert(a,"No SystemName in: ",e),zb.register(a,e),e}},{key:"HasSystemKey",value:function(e){return!!zb.hasKey(e)}},{key:"AddActorToSystem",value:function(e,a){zb.getData(a)||console.warn("NO SYSTEM OF NAME: ",a);var t=zb.getData(a);t.AddActor||console.warn("No Method: AddActor IN: ",a),t.AddActor(e)}},{key:"CleanupActorInSystem",value:function(e,a){zb.getData(a)||console.warn("NO SYSTEM OF NAME: ",a);var t=zb.getData(a);t.CleanupActor||console.warn("No Method: CleanupActor IN: ",a),t.CleanupActor(e)}}]),e}();function Ij(r,n,$){var e=n&&$||0;"string"==typeof r&&(n="binary"==r?new Array(16):null,r=null);var o=(r=r||{}).random||(r.rng||Nf)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,n)for(var t=0;t<16;++t)n[e+t]=o[t];return n||Jj(o)}var Nf;var yd="undefined"!=typeof sb&&(sb.crypto||sb.msCrypto);if(yd&&yd.getRandomValues){var Of=new Uint8Array(16);Nf=function(){return yd.getRandomValues(Of),Of}}if(!Nf){var Pf=new Array(16);Nf=function(){for(var $,r=0;r<16;r++)0==(3&r)&&($=4294967296*Math.random()),Pf[r]=$>>>((3&r)<<3)&255;return Pf}}for(var Qf=[],vc=0;vc<256;++vc)Qf[vc]=(vc+256).toString(16).substr(1);function Jj($,r){var u=r||0,t=Qf;return t[$[u++]]+t[$[u++]]+t[$[u++]]+t[$[u++]]+"-"+t[$[u++]]+t[$[u++]]+"-"+t[$[u++]]+t[$[u++]]+"-"+t[$[u++]]+t[$[u++]]+"-"+t[$[u++]]+t[$[u++]]+t[$[u++]]+t[$[u++]]+t[$[u++]]+t[$[u++]]}function Rf(e,a){for(var r=0;r<a.length;r++){var t=a[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function Sf(e,a,r){return a&&Rf(e.prototype,a),r&&Rf(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tf(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}var Kj=Sf(function e(){Tf(this,e),this.components={}}),zd=new Kj,la=function(){function e(){Tf(this,e)}return Sf(e,null,[{key:"RegisterComponentClass",value:function(e,a){zd.components[e]=a}},{key:"GetComponentClass",value:function(e){return zd.components[e]}},{key:"HasComponentKey",value:function(e){return!!zd.components[e]}}]),e}();function Lj(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Uf(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function Mj(e,r,n){return r&&Uf(e.prototype,r),n&&Uf(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var ac="commands";var wc=function(){function e(){Lj(this,e)}return Mj(e,null,[{key:"GetEmptyValues",value:function(){return{onCreate:[]}}},{key:"InjectIntoActor",value:function(r,n){var t;return t=e.Has(r)?r.vals[ac]:e.GetEmptyValues(),ta(t,n),r.vals[ac]=t,r}},{key:"GetCommandsUnderTrigger",value:function(e,r){return e.vals[ac][r]}},{key:"PreBake",value:function(e){}},{key:"Bake",value:function(e){}},{key:"PostBake",value:function(e,r){}},{key:"Cleanup",value:function(e){}},{key:"Name",get:function(){return ac}},{key:"Has",value:function(e){return!!e.vals[ac]}}]),e}();function Nj(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Vf(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Oj(e,r,t){return r&&Vf(e.prototype,r),t&&Vf(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ua="virtual_position";var Ab=function(){function e(){Nj(this,e)}return Oj(e,null,[{key:"InjectIntoJsonAsEmpty",value:function(r){r[Ua]={};var t=e.GetEmptyValues();return ta(r[Ua],t),r[Ua]}},{key:"GetEmptyValues",value:function(){return{x:0,y:0}}},{key:"InjectIntoActor",value:function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=e.GetEmptyValues();return n.x=t,n.y=a,r.vals[Ua]=n,r}},{key:"GetProperty_X",value:function(e){return e.vals[Ua].x}},{key:"GetProperty_Y",value:function(e){return e.vals[Ua].y}},{key:"PreBake",value:function(e){}},{key:"Bake",value:function(e){}},{key:"PostBake",value:function(e){}},{key:"Cleanup",value:function(e){}},{key:"Name",get:function(){return Ua}}]),e}();var ga=function(){function e(){rj(this,e),this.sessionTemp={nanostateOwner:null},this.sessionTweenInstances={},this.sessionRexTemp={},this.vals=null,this.baked=!1,this.displayed=null,this.prefabName=null,this.disposed=!1,this.disposeQueued=!1}return sj(e,[{key:"initialize",value:function(){this.vals={}}},{key:"dispose",value:function(){var e=[],a=[],i=[];for(var t in this.vals)la.HasComponentKey(t)?e.push(t):La.HasSystemKey(t)?a.push(t):i.push(t);for(var o=0;o<e.length;o++){var r=e[o];la.GetComponentClass(r).Cleanup(this)}for(var n in a){var s=a[n];La.CleanupActorInSystem(this,s)}if(null!=this.displayed){var $=this.displayed;$.refSelfActor=null,$.destroy(),this.displayed=null}else console.log(this),console.warn("fKillvis -> displayed is already destroyed");this.sessionTweenInstances&&(this.sessionTweenInstances.position&&(this.sessionTweenInstances.position.stop(0),this.sessionTweenInstances.position.remove()),this.sessionTweenInstances.scale&&(this.sessionTweenInstances.scale.stop(0),this.sessionTweenInstances.scale.remove())),this.sessionTweenInstances=null,this.sessionTemp=null,this.sessionRexTemp=null,this.vals=null,this.disposed=!0}},{key:"bake",value:function(){Da.InjectIntoActor(this,["ALL"]),this.vals.guid||(this.vals.guid=Ij()),Pj(this);var a=[],i=[],t=[];for(var o in this.vals)la.HasComponentKey(o)?a.push(o):La.HasSystemKey(o)?i.push(o):t.push(o);for(var r=0;r<a.length;r++){var n=a[r],s=la.GetComponentClass(n);s.PreBake&&s.PreBake(this)}for(var $=0;$<a.length;$++){var l=a[$];la.GetComponentClass(l).Bake(this)}this.baked=!0;for(var p=0;p<a.length;p++){var m=a[p];la.GetComponentClass(m).PostBake(this)}for(var u in i){var d=i[u];La.AddActorToSystem(this,d)}return ta(this.vals,{commands:{Dispose:[{name:"DoDispose"}]}}),e.TriggerCommandsAtKey(this,"Create"),this}},{key:"getJSON",value:function(){return JSON.stringify(this.vals)}},{key:"loadFromJSON",value:function(e){this.vals=JSON.parse(e)}}],[{key:"OnTweenComplete",value:function(a,i){e.TriggerCommandsAtKey(a,i)}},{key:"TriggerCommandList",value:function(e,a){var i=a;for(var t in i){var o=Wf(JSON.stringify(i[t]));ja.RunCommandByActor(o.name,e,o)}}},{key:"TriggerCommandsAtKey",value:function(e,a){if(wc.Has(e)){var i=wc.GetCommandsUnderTrigger(e,a);if(i)for(var t=0;t<i.length;t++){var o=Wf(JSON.stringify(i[t]));ja.RunCommandByActor(o.name,e,o)}}}},{key:"TriggerDispose",value:function(a){a.disposed||a.disposeQueued||e.TriggerCommandsAtKey(a,"Dispose")}},{key:"TriggerDisposeSafely",value:function(a){a&&e.TriggerDispose(a)}},{key:"TriggerDisposeSafelyByAlias",value:function(a){e.TriggerDisposeSafely(Wa(a))}},{key:"ListTriggerCommandsAtKey",value:function(a,i){for(var t=pa.GetBagItemsList(a),o=0;o<t.length;o++)e.TriggerCommandsAtKey(t[o],i)}},{key:"CastAs",value:function(e){return e}},{key:"GetEmptyActor",value:function(){var a=new e;return a.initialize(),a}},{key:"GetGUID",value:function(e){return e.vals.guid}},{key:"GetBakedFromDef",value:function(e,a){var i=this.GetUnbakedFromDef(e,a);return i.bake(),i}},{key:"GetUnbakedFromDef",value:function(e,a){console.assert(a);var i=ia.GetJsonPrefabCopyAtKey(e);i[Ua]||Ab.InjectIntoJsonAsEmpty(i);var t=Rj(i,e,a);return a?Da.InjectIntoActor(t,[da.GetNanoStateBagQualifier()+a]):console.error(this),t}}]),e}();var Pj=function(e){var a=[],i=[],t=[];for(var o in e.vals)la.HasComponentKey(o)?a.push(o):La.HasSystemKey(o)?i.push(o):t.push(o);for(var r=0;r<a.length;r++){var n=a[r],s=la.GetComponentClass(n);s.Validate&&s.Validate(e)}},Qj=function(e){var a=ga.GetEmptyActor();return ta(a.vals,e),a},Rj=function(e,a,i){var t=Qj(e);return t.sessionTemp.nanostateOwner=i,t.prefabName=a,t},Wf=function(e){var a=JSON.parse(e);return of.forIn(a,function(e,i){var t=e,o=!1;null!=e._intMin&&(o=!0,t=Phaser.Math.Between(e._intMin,e._intMax)),null!=e._iteratorMultiplier&&(null==e._iterator&&(e._iterator=0),isNaN(t)&&(t=0),o=!0,t+=e._iterator*e._iteratorMultiplier),o&&(a[i]=t)}),a};var Va="bags";var Da=function(){function e(){pj(this,e)}return qj(e,null,[{key:"InjectIntoJsonAsEmpty",value:function(r){r[Va]={};var t=e.GetEmptyValues();return ta(r[Va],t),r[Va]}},{key:"GetEmptyValues",value:function(){return{list:[]}}},{key:"InjectIntoActor",value:function(r,t){var a;(void 0===t&&console.warn("UNDEFINED BAG"),a=e.Has(r)?r.vals[Va]:e.GetEmptyValues(),Array.isArray(t))||(t=[t]);for(var o=0;o<t.length;o++)-1==a.list.indexOf(t[o])&&a.list.push(t[o]);return r.vals[Va]=a,r.baked&&(this.PreBake(r),this.Bake(r),this.PostBake(r)),r}},{key:"GetBags",value:function(e){return e.vals[Va].list}},{key:"PreBake",value:function(e){}},{key:"Bake",value:function(e){}},{key:"PostBake",value:function(e){pa.AddActorToBags(e)}},{key:"Cleanup",value:function(e){pa.DeleteActorInAllBags(e)}},{key:"Name",get:function(){return Va}},{key:"Has",value:function(e){return!!e.vals[Va]}}]),e}();var Sj=vd(function t(){wd(this,t),this.bags={},this.entitiesByAliasDictionary={},this.entitiesByGUIDDictionary={}}),na=new Sj,a=function(){function t(){wd(this,t)}return vd(t,null,[{key:"DumpBag",value:function(t){console.log(na.bags[t])}},{key:"DumpBags",value:function(){console.log("--DUMP BAGS--"),console.log("BAGS: ",na.bags),console.log("ALIAS: ",na.entitiesByAliasDictionary),console.log("--DUMP ENDS--")}},{key:"DumpBagLength",value:function(t){na.bags[t]&&na.bags[t].keys&&console.log("Bag:"+t+" length: "+na.bags[t].keys.length)}},{key:"DumpAllActorsBagLength",value:function(){pa._MakeBagIfNotExisting("ALL"),console.log(na.bags.ALL.keys.length)}}]),t}();var pa=function(){function t(){wd(this,t)}return vd(t,null,[{key:"AddActorToBags",value:function(e){for(var a=0;a<Da.GetBags(e).length;a++)t._AddActorToBagAtKey(e,Da.GetBags(e)[a])}},{key:"AddAliasActor",value:function(t){Xa.Has(t)&&(na.entitiesByAliasDictionary[Xa.GetAlias(t)]||(na.entitiesByAliasDictionary[Xa.GetAlias(t)]=t))}},{key:"DeleteAliasActor",value:function(t){Xa.Has(t)&&na.entitiesByAliasDictionary[Xa.GetAlias(t)]&&delete na.entitiesByAliasDictionary[Xa.GetAlias(t)]}},{key:"GetActorByAlias",value:function(t){return na.entitiesByAliasDictionary[t]}},{key:"GetActorByGUID",value:function(t){return na.entitiesByGUIDDictionary[t]}},{key:"DeleteActorInAllBags",value:function(e){var a=e.vals.guid;if(Da.GetBags(e).length<=0)console.assert(!0,"entity is not in any bags");else{for(var r=0;r<Da.GetBags(e).length;r++){var i=Da.GetBags(e)[r];t._DeleteActorFromBag(e,i)}t._DeleteActorFromBag(e,"ALL"),delete na.entitiesByGUIDDictionary[a]}}},{key:"GetBagItemCount",value:function(t){return na.bags[t]?(console.assert(na.bags[t],"ActorBagsModel->GetBagItemCount:: no bag of alias: ",t," debug ActorBagsModel:",this),na.bags[t].keys.length):0}},{key:"GetBagItemsList",value:function(e){return t._MakeBagIfNotExisting(e),na.bags[e].itemsList}},{key:"PerformFunctionOnEachActorInBag",value:function(t,e){var a=na.bags[t];if(console.assert(a,"ActorBagsModel::PerformFunctionOnEachActorInBag-> no bag for alias:",t),a)for(var r=0;r<a.keys.length;r++)e(a.itemsDictionary[a.keys[r]])}},{key:"TriggerCommandOnActorsInBag",value:function(e,a){for(var r=t.GetBagItemsList(a),i=0;i<r.length;i++){var o=r[i];ga.TriggerCommandsAtKey(o,e)}}},{key:"_MakeBagIfNotExisting",value:function(t){if(!na.bags[t]){var e={itemsDictionary:{},keys:[],itemsList:[]};na.bags[t]=e}}},{key:"_AddActorToBagAtKey",value:function(t,e){this._MakeBagIfNotExisting(e);var a=na.bags[e];a.itemsDictionary[t.vals.guid]||(na.entitiesByGUIDDictionary[t.vals.guid]=t,a.itemsDictionary[t.vals.guid]=t,a.keys.push(t.vals.guid),a.itemsList.push(t))}},{key:"_DeleteActorFromBag",value:function(t,e){var a=na.bags[e];delete a.itemsDictionary[t.vals.guid],a.keys.indexOf(t.vals.guid)>-1&&a.keys.splice(a.keys.indexOf(t.vals.guid),1),a.itemsList.indexOf(t)>-1&&a.itemsList.splice(a.itemsList.indexOf(t),1)}}]),t}();function Wa(t){return pa.GetActorByAlias(t)}var bc="alias",Xa=function(){function e(){nj(this,e)}return oj(e,null,[{key:"InjectIntoActor",value:function(e,a){e.vals[bc]={},e.vals[bc].alias=a,e.baked&&(this.PreBake(e),this.Bake(e),this.PostBake(e))}},{key:"GetAlias",value:function(e){return e.vals[bc].alias}},{key:"PreBake",value:function(e){}},{key:"Bake",value:function(e){}},{key:"PostBake",value:function(e){pa.AddAliasActor(e)}},{key:"Cleanup",value:function(e){pa.DeleteAliasActor(e)}},{key:"Name",get:function(){return bc}},{key:"Has",value:function(e){return!!e.vals[bc]}}]),e}();function Tj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xf(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Uj(e,t,a){return t&&Xf(e.prototype,t),a&&Xf(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}var Bb="physics",ua=function(){function e(){Tj(this,e)}return Uj(e,null,[{key:"GetEmptyValues",value:function(){return{}}},{key:"InjectEmpty",value:function(t){return t.vals[Bb]={},ta(t.vals[Bb],e.GetEmptyValues()),t.vals[Bb]}},{key:"PreBake",value:function(e){}},{key:"Bake",value:function(e){}},{key:"PostBake",value:function(t){var a=t.vals[Bb];if(t.displayed.body&&1==a.static&&console.warn("TODO: IMPLEMENT EDGE CASE"),!t.displayed.body){var r=!1;1==a.static&&(r=!0),t.displayed.scene.physics.add.existing(t.displayed,r)}var l=e.GetBody(t),o=0,i=0,n=0,s=0;if(a.modWidth&&(o=a.modHeight),a.modHeight&&(i=a.modHeight),a.offsetX&&(n=a.offsetX),a.offsetY&&(s=a.offsetY),"circle"==a.type){var c,$;c=e.GetBody(t).halfWidth-a.radius,$=e.GetBody(t).halfHeight-a.radius,t.displayed.body.setCircle(a.radius),t.displayed.body.setOffset(c,$)}else l.setSize(l.width+o,l.height+i),l.setOffset(n,s)}},{key:"Cleanup",value:function(e){}},{key:"Name",get:function(){return Bb}},{key:"Has",value:function(e){return!!e.vals[Bb]}},{key:"GetBody",value:function(e){return e.displayed.body}},{key:"DestroyBody",value:function(e){e.displayed.body.destroy()}},{key:"DisableBody",value:function(t){e.GetBody(t).stop(),e.GetBody(t).enable=!1,e.GetBody(t).gameObject.active=!1}}]),e}();function Vj(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Yf(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Wj(e,r,t){return r&&Yf(e.prototype,r),t&&Yf(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var xc={groups:{}},Cb=function(e){return xc.groups[e]?xc.groups[e]:(console.warn("NO GROUP: ",e),null)};var Db=function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return xc.groups[e]=r?sa.GetGameplayScene().physics.add.staticGroup():sa.GetGameplayScene().physics.add.group(),xc.groups[e]};var yc=function(e,r,$){var o=Cb(e),s=Cb(r);sa.GetGameplayScene().physics.add.collider(o,s,$,null)};var Xj=function(e,r,$){var o=Cb(e),s=Cb(r);sa.GetGameplayScene().physics.add.overlap(o,s,$,null)};var Yj=function(e,r){for(var $=0;$<r.length;$++){var o=r[$],s=Cb(o);console.assert(s,"No group named: ",o),s.add(e.displayed)}};var cc="physics_groups";var Zf=function(){function e(){Vj(this,e)}return Wj(e,null,[{key:"GetEmptyValues",value:function(){return{list:[]}}},{key:"InjectIntoActor",value:function(r,t){var a;(a=e.Has(r)?r.vals[cc]:e.GetEmptyValues(),Array.isArray(t))||(t=[t]);for(var n=0;n<t.length;n++)-1==a.list.indexOf(t[n])&&a.list.push(t[n]);r.vals[cc]=a,r.baked&&(this.PreBake(r),this.Bake(r),this.PostBake(r))}},{key:"PreBake",value:function(e){}},{key:"Bake",value:function(e){}},{key:"PostBake",value:function(e){Yj(e,e.vals[cc].list)}},{key:"Cleanup",value:function(e){}},{key:"Name",get:function(){return cc}},{key:"Has",value:function(e){return!!e.vals[cc]}}]),e}();function Zj(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function $f(e,a){for(var t=0;t<a.length;t++){var r=a[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $j(e,a,t){return a&&$f(e.prototype,a),t&&$f(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _j(e){return(_j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ak(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bk(e,t,r){return t&&_f(e.prototype,t),r&&_f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ck(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dk(e,t)}function dk(e,t){return(dk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ek(e){var t=hk();return function(){var r,n=ag(e);if(t){var o=ag(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return fk(this,r)}}function fk(e,t){if(t&&("object"===_j(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return gk(e)}function gk(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hk(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function ag(e){return(ag=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ik(t){return(ik="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jk(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bg(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function kk(t,e,r){return e&&bg(t.prototype,e),r&&bg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function cg(){return(cg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var o=lk(t,e);if(o){var a=Object.getOwnPropertyDescriptor(o,e);return a.get?a.get.call(arguments.length<3?t:r):a.value}}).apply(this,arguments)}function lk(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=dc(t)););return t}function mk(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nk(t,e)}function nk(t,e){return(nk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ok(t){var e=rk();return function(){var r,o=dc(t);if(e){var a=dc(this).constructor;r=Reflect.construct(o,arguments,a)}else r=o.apply(this,arguments);return pk(this,r)}}function pk(t,e){if(e&&("object"===ik(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return qk(t)}function qk(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rk(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function dc(t){return(dc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sk(t){return(sk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tk(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dg(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function uk(t,e,o){return e&&dg(t.prototype,e),o&&dg(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function vk(){return(vk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,o){var r=wk(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(arguments.length<3?t:o):n.value}}).apply(this,arguments)}function wk(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=zc(t)););return t}function xk(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yk(t,e)}function yk(t,e){return(yk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function zk(t){var e=Ck();return function(){var o,r=zc(t);if(e){var n=zc(this).constructor;o=Reflect.construct(r,arguments,n)}else o=r.apply(this,arguments);return Ak(this,o)}}function Ak(t,e){if(e&&("object"===sk(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Bk(t)}function Bk(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ck(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function zc(t){return(zc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dk(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eg(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ek(e,t,s){return t&&eg(e.prototype,t),s&&eg(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ac={setEventEmitter:function(t,e){return void 0===e&&(e=Phaser.Events.EventEmitter),this._privateEE=!0===t||void 0===t,this._eventEmitter=this._privateEE?new e:t,this},destroyEventEmitter:function(){return this._eventEmitter&&this._privateEE&&this._eventEmitter.shutdown(),this},getEventEmitter:function(){return this._eventEmitter},on:function(){return this._eventEmitter&&this._eventEmitter.on.apply(this._eventEmitter,arguments),this},once:function(){return this._eventEmitter&&this._eventEmitter.once.apply(this._eventEmitter,arguments),this},off:function(){return this._eventEmitter&&this._eventEmitter.off.apply(this._eventEmitter,arguments),this},emit:function(t){return this._eventEmitter&&t&&this._eventEmitter.emit.apply(this._eventEmitter,arguments),this},addListener:function(){return this._eventEmitter&&this._eventEmitter.addListener.apply(this._eventEmitter,arguments),this},removeListener:function(){return this._eventEmitter&&this._eventEmitter.removeListener.apply(this._eventEmitter,arguments),this},removeAllListeners:function(){return this._eventEmitter&&this._eventEmitter.removeAllListeners.apply(this._eventEmitter,arguments),this},listenerCount:function(){return this._eventEmitter?this._eventEmitter.listenerCount.apply(this._eventEmitter,arguments):0},listeners:function(){return this._eventEmitter?this._eventEmitter.listeners.apply(this._eventEmitter,arguments):[]},eventNames:function(){return this._eventEmitter?this._eventEmitter.eventNames.apply(this._eventEmitter,arguments):[]}};function Fk(e){return(Fk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Gk=Phaser.Scene,Ad=function(e){return e instanceof Gk};var fg=function(e){return null==e||"object"!==Fk(e)?null:Ad(e)?e:e.scene&&Ad(e.scene)?e.scene:e.parent&&e.parent.scene&&Ad(e.parent.scene)?e.parent.scene:void 0};var Hk=Phaser.Utils.Objects.GetValue,gg=function(){function e(t,s){Dk(this,e),this.parent=t,this.scene=fg(t),this.isShutdown=!1,this.setEventEmitter(Hk(s,"eventEmitter",!0)),this.parent&&this.parent===this.scene?this.scene.sys.events.once("shutdown",this.onSceneDestroy,this):this.parent&&this.parent.once&&this.parent.once("destroy",this.onParentDestroy,this)}return Ek(e,[{key:"shutdown",value:function(e){this.isShutdown||(this.parent&&this.parent===this.scene?this.scene.sys.events.off("shutdown",this.onSceneDestroy,this):this.parent&&this.parent.once&&this.parent.off("destroy",this.onParentDestroy,this),this.destroyEventEmitter(),this.parent=void 0,this.scene=void 0,this.isShutdown=!0)}},{key:"destroy",value:function(e){this.shutdown(e)}},{key:"onSceneDestroy",value:function(){this.destroy(!0)}},{key:"onParentDestroy",value:function(e,t){this.destroy(t)}}]),e}();Object.assign(gg.prototype,Ac);var Ik=Phaser.Utils.Objects.GetValue,hg=function(t){xk(o,gg);var e=zk(o);function o(t,r){var n;return tk(this,o),(n=e.call(this,t,r))._isRunning=!1,n.isPaused=!1,n.tickingState=!1,n.setTickingMode(Ik(r,"tickingMode",1)),n}return uk(o,[{key:"boot",value:function(){2!==this.tickingMode||this.tickingState||this.startTicking()}},{key:"shutdown",value:function(t){this.isShutdown||(this.stop(),this.tickingState&&this.stopTicking(),vk(zc(o.prototype),"shutdown",this).call(this,t))}},{key:"setTickingMode",value:function(t){"string"==typeof t&&(t=Jk[t]),this.tickingMode=t}},{key:"startTicking",value:function(){this.tickingState=!0}},{key:"stopTicking",value:function(){this.tickingState=!1}},{key:"isRunning",get:function(){return this._isRunning},set:function(t){this._isRunning!==t&&(this._isRunning=t,1===this.tickingMode&&t!=this.tickingState&&(t?this.startTicking():this.stopTicking()))}},{key:"start",value:function(){return this.isPaused=!1,this.isRunning=!0,this}},{key:"pause",value:function(){return this.isRunning&&(this.isPaused=!0,this.isRunning=!1),this}},{key:"resume",value:function(){return this.isPaused&&(this.isRunning=!0),this}},{key:"stop",value:function(){return this.isPaused=!1,this.isRunning=!1,this}},{key:"complete",value:function(){this.isPaused=!1,this.isRunning=!1,this.emit("complete",this.parent,this)}}]),o}(),Jk={no:0,lazy:1,always:2};var Bc=function(t){mk(r,hg);var e=ok(r);function r(){return jk(this,r),e.apply(this,arguments)}return kk(r,[{key:"startTicking",value:function(){cg(dc(r.prototype),"startTicking",this).call(this),this.scene.sys.events.on("update",this.update,this)}},{key:"stopTicking",value:function(){cg(dc(r.prototype),"stopTicking",this).call(this),this.scene&&this.scene.sys.events.off("update",this.update,this)}}]),r}();var Bd=function(e,t,o,r){var c=e.body,$=c.velocity.x,l=c.velocity.y;t===$&&o===l||(c.setVelocity(t,o),r&&r(t,o,$,l))};var Cc=Phaser.Utils.Objects.GetValue,Kk=function(e){ck(r,Bc);var t=ek(r);function r(e,n){var o;return ak(this,r),(o=t.call(this,e,n)).resetFromJSON(n),o.boot(),o}return bk(r,[{key:"resetFromJSON",value:function(e){return this.parent.body||this.scene.physics.add.existing(this.parent,!1),this.setWrapMode(Cc(e,"wrap",!1),Cc(e,"padding",0)),this.setEnable(Cc(e,"enable",!0)),this.setSpeed(Cc(e,"speed",200)),this}},{key:"enable",get:function(){return this.isRunning},set:function(e){this.isRunning=e,e||Bd(this.parent,0,0)}},{key:"setEnable",value:function(e){return null==e&&(e=!0),this.enable=e,this}},{key:"setSpeed",value:function(e){return this.speed=e,this}},{key:"setWrapMode",value:function(e,t){return void 0===e&&(e=!0),this.wrap=e,this.padding=t,this}},{key:"update",value:function(e,t){var r=this.parent;if(!this.enable)return Bd(r,0,0),this;if(!r.active)return this;var n=r.rotation,o=this.speed*Math.cos(n),i=this.speed*Math.sin(n);return Bd(r,o,i),this.wrap&&r.body.world.wrap(r,this.padding),this}}]),r}();var Ma="rex_bullet";var ig=function(){function e(){Zj(this,e)}return $j(e,null,[{key:"GetEmptyValues",value:function(){return{speed:100,rotateToTarget:!1,enable:!0}}},{key:"Validate",value:function(e){ua.Has(e)||ua.InjectEmpty(e)}},{key:"PreBake",value:function(a){var t=e.GetEmptyValues();ta(t,a.vals[Ma]),a.vals[Ma]=t}},{key:"Bake",value:function(e){var a=sa.GetGameplayScene().plugins.get("rexBullet");e.sessionRexTemp[Ma]=a.add(e.displayed,e.vals[Ma])}},{key:"PostBake",value:function(a){e.SetEnable(a,a.vals[Ma].enable)}},{key:"Cleanup",value:function(e){}},{key:"Name",get:function(){return Ma}},{key:"Has",value:function(e){return!!e.vals[Ma]}},{key:"GetPlugin",value:function(e){return e.sessionRexTemp[Ma]}},{key:"SetEnable",value:function(a,t){a.baked&&e.GetPlugin(a).setEnable(t),a.vals[Ma].enable=t}},{key:"SetSpeed",value:function(a,t){a.baked&&e.GetPlugin(a).setSpeed(t),a.vals[Ma].speed=t}},{key:"GetSpeed",value:function(a){return e.GetPlugin(a).speed}}]),e}();function Lk(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function jg(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Mk(e,n,t){return n&&jg(e.prototype,n),t&&jg(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nk(e){return(Nk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ok(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kg(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pk(e,t,r){return t&&kg(e.prototype,t),r&&kg(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qk(){return(Qk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=Rk(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}}).apply(this,arguments)}function Rk(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Dc(e)););return e}function Sk(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tk(e,t)}function Tk(e,t){return(Tk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Uk(e){var t=Xk();return function(){var r,n=Dc(e);if(t){var o=Dc(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Vk(this,r)}}function Vk(e,t){if(t&&("object"===Nk(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Wk(e)}function Wk(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xk(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Dc(e){return(Dc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var eb=Phaser.Utils.Objects.GetValue,Yk=Phaser.Math.Distance.Between,lg=Phaser.Math.Linear,Zk=Phaser.Math.Angle.Between,$k=function(e){Sk(r,Bc);var t=Uk(r);function r(e,n){var o;return Ok(this,r),(o=t.call(this,e,n)).resetFromJSON(n),o.boot(),o}return Pk(r,[{key:"resetFromJSON",value:function(e){return this.isRunning=eb(e,"isRunning",!1),this.setEnable(eb(e,"enable",!0)),this.timeScale=eb(e,"timeScale",1),this.setSpeed(eb(e,"speed",400)),this.setRotateToTarget(eb(e,"rotateToTarget",!1)),this.targetX=eb(e,"targetX",0),this.targetY=eb(e,"targetY",0),this}},{key:"toJSON",value:function(){return{isRunning:this.isRunning,enable:this.enable,timeScale:this.timeScale,speed:this.speed,rotateToTarget:this.rotateToTarget,targetX:this.targetX,targetY:this.targetY,tickingMode:this.tickingMode}}},{key:"setEnable",value:function(e){return null==e&&(e=!0),this.enable=e,this}},{key:"setSpeed",value:function(e){return this.speed=e,this}},{key:"setRotateToTarget",value:function(e){return this.rotateToTarget=e,this}},{key:"moveTo",value:function(e,t){if("number"!=typeof e){var n=e;e=n.x,t=n.y}return this.targetX=e,this.targetY=t,Qk(Dc(r.prototype),"start",this).call(this),this}},{key:"moveFrom",value:function(e,t){if("number"!=typeof e){var r=e;e=r.x,t=r.y}var n=this.parent,o=n.x,a=n.y;return n.setPosition(e,t),this.moveTo(o,a),this}},{key:"moveToward",value:function(e,t){var r=this.parent,n=r.x+Math.cos(e)*t,o=r.y+Math.sin(e)*t;return this.moveTo(n,o),this}},{key:"update",value:function(e,t){if(!this.isRunning||!this.enable)return this;var r=this.parent;if(!r.active)return this;var n=r.x,o=r.y,a=this.targetX,i=this.targetY;if(n===a&&o===i)return this.complete(),this;if(0===this.speed||0===t||0===this.timeScale)return this;var u,s,$=t*this.timeScale/1e3,c=this.speed*$,l=Yk(n,o,a,i);if(c<l){var f=c/l;u=lg(n,a,f),s=lg(o,i,f)}else u=a,s=i;return r.setPosition(u,s),this.rotateToTarget&&(r.rotation=Zk(n,o,u,s)),this}}]),r}();var ec="rex_move_to";var Eb=function(){function e(){Lk(this,e)}return Mk(e,null,[{key:"PreBake",value:function(e){}},{key:"Bake",value:function(e){var n=sa.GetGameplayScene().plugins.get("rexMoveTo");e.sessionRexTemp[ec]=n.add(e.displayed,e.vals[ec])}},{key:"PostBake",value:function(e){}},{key:"Cleanup",value:function(e){}},{key:"Name",get:function(){return ec}},{key:"Has",value:function(e){return!!e.vals[ec]}},{key:"GetPlugin",value:function(e){return e.sessionRexTemp[ec]}},{key:"MoveTo",value:function(e,n,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null!=o&&o!=this.GetPlugin(e).speed&&this.GetPlugin(e).setSpeed(o),this.GetPlugin(e).moveTo(n,t)}},{key:"MoveToWithHandler",value:function(e,n,t,o){this.GetPlugin(e).once("complete",function(e,n){o(e.refSelfActor)}),this.GetPlugin(e).moveTo(n,t)}}]),e}();function _k(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function mg(e,a){for(var t=0;t<a.length;t++){var r=a[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function al(e,a,t){return a&&mg(e.prototype,a),t&&mg(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var Cd,Ec={},b=arguments[0];!function(e,u){"object"==typeof Ec?Ec=u():"function"==typeof Cd&&Cd.amd?Cd(u):e.v=u()}(Ec,function(){function e(e){return null==e}function u(u){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e(u)?r:Boolean(u)}function r(e){return"string"==typeof e}function n(u){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e(u)?n:r(u)?u:String(u)}function t(e,r){var t=n(e),i=u(r);return""===t?"":(i&&(t=t.toLowerCase()),t.substr(0,1).toUpperCase()+t.substr(1))}function i(e){return n(e,"").toLowerCase()}var a="\\uDC00-\\uDFFF",o="\\u0300-\\u036F\\u1AB0-\\u1AFF\\u1DC0-\\u1DFF\\u20D0-\\u20FF\\uFE20-\\uFE2F",c="\\0-\\u02FF\\u0370-\\u1AAF\\u1B00-\\u1DBF\\u1E00-\\u20CF\\u2100-\\uD7FF\\uE000-\\uFE1F\\uFE30-\\uFFFF",f=new RegExp("(["+c+"]|[\\uD800-\\uDBFF]["+a+"]|[\\uD800-\\uDBFF](?!["+a+"])|(?:[^\\uD800-\\uDBFF]|^)["+a+"])(["+o+"]+)","g"),s=new RegExp("([\\uD800-\\uDBFF])([\\uDC00-\\uDFFF])","g"),l=new RegExp("((?:["+c+"]|[\\uD800-\\uDBFF]["+a+"]|[\\uD800-\\uDBFF](?!["+a+"])|(?:[^\\uD800-\\uDBFF]|^)["+a+"])(?:["+o+"]+))|([\\uD800-\\uDBFF]["+a+"])|([\\n\\r\\u2028\\u2029])|(.)","g"),p=new RegExp("[\\s\\uFEFF\\xA0]"),g=new RegExp("^[\\s\\uFEFF\\xA0]+"),h=new RegExp("[\\s\\uFEFF\\xA0]+$"),v=new RegExp("^\\d+$"),d=/[-[\]{}()*+!<=:?./\\^$|#,]/g,F=/[^A-Za-z0-9]/g,x=/[<>&"'`]/g,b=/(%{1,2})(?:(\d+)\$)?(\+)?([ 0]|'.{1})?(-)?(\d+)?(?:\.(\d+))?([bcdiouxXeEfgGs])?/g,y=/\.?0+$/g,w=/[gimuy]*$/,D=/<([A-Za-z0-9]+)>/g,A="a-z\\xB5\\xDF-\\xF6\\xF8-\\xFF\\u0101\\u0103\\u0105\\u0107\\u0109\\u010B\\u010D\\u010F\\u0111\\u0113\\u0115\\u0117\\u0119\\u011B\\u011D\\u011F\\u0121\\u0123\\u0125\\u0127\\u0129\\u012B\\u012D\\u012F\\u0131\\u0133\\u0135\\u0137\\u0138\\u013A\\u013C\\u013E\\u0140\\u0142\\u0144\\u0146\\u0148\\u0149\\u014B\\u014D\\u014F\\u0151\\u0153\\u0155\\u0157\\u0159\\u015B\\u015D\\u015F\\u0161\\u0163\\u0165\\u0167\\u0169\\u016B\\u016D\\u016F\\u0171\\u0173\\u0175\\u0177\\u017A\\u017C\\u017E-\\u0180\\u0183\\u0185\\u0188\\u018C\\u018D\\u0192\\u0195\\u0199-\\u019B\\u019E\\u01A1\\u01A3\\u01A5\\u01A8\\u01AA\\u01AB\\u01AD\\u01B0\\u01B4\\u01B6\\u01B9\\u01BA\\u01BD-\\u01BF\\u01C6\\u01C9\\u01CC\\u01CE\\u01D0\\u01D2\\u01D4\\u01D6\\u01D8\\u01DA\\u01DC\\u01DD\\u01DF\\u01E1\\u01E3\\u01E5\\u01E7\\u01E9\\u01EB\\u01ED\\u01EF\\u01F0\\u01F3\\u01F5\\u01F9\\u01FB\\u01FD\\u01FF\\u0201\\u0203\\u0205\\u0207\\u0209\\u020B\\u020D\\u020F\\u0211\\u0213\\u0215\\u0217\\u0219\\u021B\\u021D\\u021F\\u0221\\u0223\\u0225\\u0227\\u0229\\u022B\\u022D\\u022F\\u0231\\u0233-\\u0239\\u023C\\u023F\\u0240\\u0242\\u0247\\u0249\\u024B\\u024D\\u024F",E="\\x41-\\x5a\\xc0-\\xd6\\xd8-\\xde\\u0100\\u0102\\u0104\\u0106\\u0108\\u010a\\u010c\\u010e\\u0110\\u0112\\u0114\\u0116\\u0118\\u011a\\u011c\\u011e\\u0120\\u0122\\u0124\\u0126\\u0128\\u012a\\u012c\\u012e\\u0130\\u0132\\u0134\\u0136\\u0139\\u013b\\u013d\\u013f\\u0141\\u0143\\u0145\\u0147\\u014a\\u014c\\u014e\\u0150\\u0152\\u0154\\u0156\\u0158\\u015a\\u015c\\u015e\\u0160\\u0162\\u0164\\u0166\\u0168\\u016a\\u016c\\u016e\\u0170\\u0172\\u0174\\u0176\\u0178\\u0179\\u017b\\u017d\\u0181\\u0182\\u0184\\u0186\\u0187\\u0189-\\u018b\\u018e-\\u0191\\u0193\\u0194\\u0196-\\u0198\\u019c\\u019d\\u019f\\u01a0\\u01a2\\u01a4\\u01a6\\u01a7\\u01a9\\u01ac\\u01ae\\u01af\\u01b1-\\u01b3\\u01b5\\u01b7\\u01b8\\u01bc\\u01c4\\u01c5\\u01c7\\u01c8\\u01ca\\u01cb\\u01cd\\u01cf\\u01d1\\u01d3\\u01d5\\u01d7\\u01d9\\u01db\\u01de\\u01e0\\u01e2\\u01e4\\u01e6\\u01e8\\u01ea\\u01ec\\u01ee\\u01f1\\u01f2\\u01f4\\u01f6-\\u01f8\\u01fa\\u01fc\\u01fe\\u0200\\u0202\\u0204\\u0206\\u0208\\u020a\\u020c\\u020e\\u0210\\u0212\\u0214\\u0216\\u0218\\u021a\\u021c\\u021e\\u0220\\u0222\\u0224\\u0226\\u0228\\u022a\\u022c\\u022e\\u0230\\u0232\\u023a\\u023b\\u023d\\u023e\\u0241\\u0243-\\u0246\\u0248\\u024a\\u024c\\u024e",C=new RegExp("(?:["+E+"]["+o+"]*)?(?:["+A+"]["+o+"]*)+|(?:["+E+"]["+o+"]*)+(?!["+A+"])|[\\d]+|[\\u2700-\\u27BF]|[^\\x00-\\x2F\\x3A-\\x40\\x5B-\\x60\\x7b-\\xBF\\xD7\\xF7\\u2000-\\u206F\\s\\uFEFF\\xA0]+","g"),m=/[A-Z\xC0-\xD6\xD8-\xDE]?[a-z\xDF-\xF6\xF8-\xFF]+|[A-Z\xC0-\xD6\xD8-\xDE]+(?![a-z\xDF-\xF6\xF8-\xFF])|\d+/g,B=new RegExp("^(?:["+A+E+"]["+o+"]*)+$"),k=new RegExp("^((?:["+A+E+"]["+o+"]*)|[\\d])+$"),$=/^[\x01-\xFF]*$/;function S(e,u){return null==e?u:e}function O(u){return e(u)?null:r(u)?u:String(u)}function j(u,r,t){var i=n(u),a=void 0;if(e(r))a=$.test(i)?m:C;else if(r instanceof RegExp)a=r;else{var o=O(S(t,""));a=new RegExp(O(r),o)}return S(i.match(a),[])}function R(e,u){return 0===u?i(e):t(e,!0)}function U(e){var u=n(e);return""===u?"":j(u).map(i).join("-")}function L(e,u){var r=u.toLowerCase(),n=u.toUpperCase();return e+(u===r?n:r)}function N(e,u,r){return e<=u?u:e>=r?r:e}var P=9007199254740991;function z(e){return e===1/0?P:e===-1/0?-P:~~e}function q(u,r,t){var i=n(u),a=e(r)?i.length:N(z(r),0,P),o=n(t,"...");return a>=i.length?i:i.substr(0,r-o.length)+o}var I=55296,_=56319,V=56320,Y=57343;function Z(u){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e(u)?r:"number"==typeof u?u:Number(u)}function T(e,u){return e!=e?u:e}function W(e,u){var r=n(e),t=r.length,i=Z(u);if(!((i=T(i,0))<0||i>=t)){var a,o=r.charCodeAt(i),c=void 0;return(a=o)>=I&&a<=_&&t>i+1&&function(e){return e>=V&&e<=Y}(c=r.charCodeAt(i+1))?1024*(o-I)+c-V+65536:o}}var G=Array.prototype.reduce;function H(){this.index=0}H.prototype.increment=function(){this.index++},H.prototype.incrementOnEmptyPosition=function(u){e(u)&&this.increment()},H.prototype.getIndexByPosition=function(u){return e(u)?this.index:u-1};var J="i",X="b",K="c",M="d",Q="o",ee="u",ue="x",re="X",ne="e",te="E",ie="f",ae="g",oe="G",ce="s",fe="+",se="-",le=2,pe=8,ge=16;function he(u,r){for(var t=n(u),i=e(r)?1:N(z(r),0,P),a="";i;)1&i&&(a+=t),i>1&&(t+=t),i>>=1;return a}function ve(e,u){return he(e,z(u/e.length)+u%e.length).substr(0,u)}function de(u,r,t){var i=n(u),a=e(r)?0:N(z(r),0,P),o=n(t," ");return a<=i.length?i:ve(o,a-i.length)+i}function Fe(u,r,t){var i=n(u),a=e(r)?0:N(z(r),0,P),o=n(t," ");return a<=i.length?i:i+ve(o,a-i.length)}function xe(e,u,r){return r.signSpecifier===fe&&e>=0&&(u=fe+u),u}function be(e,u){var r=parseFloat(e),t=void 0;isNaN(r)&&(r=0);var i=Z(u.precision,6);switch(u.typeSpecifier){case ie:t=r.toFixed(i);break;case ne:t=r.toExponential(i);break;case te:t=r.toExponential(i).toUpperCase();break;case ae:case oe:t=function(e,u,r){if(0===e)return"0";var n=0===u?1:u,t=e.toPrecision(n).replace(y,"");r.typeSpecifier===oe&&(t=t.toUpperCase());return t}(r,i,u);}return n(t=xe(r,t,u))}function ye(e,u){var r=parseInt(e);switch(isNaN(r)&&(r=0),r>>>=0,u.typeSpecifier){case K:r=String.fromCharCode(r);break;case X:r=r.toString(le);break;case Q:r=r.toString(pe);break;case ue:r=r.toString(ge);break;case re:r=r.toString(ge).toUpperCase();}return n(r)}function we(e,u){var r=parseInt(e);return isNaN(r)&&(r=0),xe(r,O(r),u)}function De(u,r){var n=u,t=r.precision;return!e(t)&&n.length>t&&(n=q(n,t,"")),n}function Ae(u,r){var n=void 0;switch(r.typeSpecifier){case ce:n=De;break;case M:case J:n=we;break;case K:case X:case Q:case ue:case re:case ee:n=ye;break;case ie:case ne:case te:case ae:case oe:n=be;}return function(u,r){var n=r.width;return e(n)||u.length>=n?u:(r.alignmentSpecifier===se?Fe:de)(u,n,r.getPaddingCharacter())}(n(u,r),r)}function Ee(e){this.percent=e.percent,this.signSpecifier=e.signSpecifier,this.paddingSpecifier=e.paddingSpecifier,this.alignmentSpecifier=e.alignmentSpecifier,this.width=e.width,this.precision=e.precision,this.typeSpecifier=e.typeSpecifier}function Ce(u,r,n,t,i,a,o,c,f,s,l){var p=new Ee({percent:t,signSpecifier:a,paddingSpecifier:o,alignmentSpecifier:c,width:Z(f,null),precision:Z(s,null),typeSpecifier:l});if(p.isPercentLiteral())return n.slice(1);var g=u.getIndexByPosition(i);return u.incrementOnEmptyPosition(i),function(u,r,n){if(e(n.typeSpecifier))throw new Error("sprintf(): Unknown type specifier");if(u>r-1)throw new Error("sprintf(): Too few arguments");if(u<0)throw new Error("sprintf(): Argument number must be greater than zero")}(g,r.length,p),Ae(r[g],p)}function me(e){var u=n(e);if(""===u)return u;for(var r=arguments.length,t=Array(r>1?r-1:0),i=1;i<r;i++)t[i-1]=arguments[i];var a=Ce.bind(void 0,new H,t);return u.replace(b,a)}Ee.prototype.isPercentLiteral=function(){return"%%"===this.percent},Ee.prototype.getPaddingCharacter=function(){var e=S(this.paddingSpecifier," ");return 2===e.length&&"'"===e[0]&&(e=e[1]),e};var Be={"<":"&lt;",">":"&gt;","&":"&amp;","\"":"&quot;","'":"&#x27;","`":"&#x60;"};function ke(e){return Be[e]}function $e(e){return n(e).replace(d,"\\$&")}var Se={"<":/(&lt;)|(&#x0*3c;)|(&#0*60;)/gi,">":/(&gt;)|(&#x0*3e;)|(&#0*62;)/gi,"&":/(&amp;)|(&#x0*26;)|(&#0*38;)/gi,"\"":/(&quot;)|(&#x0*22;)|(&#0*34;)/gi,"'":/(&#x0*27;)|(&#0*39;)/gi,"`":/(&#x0*60;)|(&#0*96;)/gi},Oe=Object.keys(Se);function je(e,u){return e.replace(Se[u],u)}var Re={3:"\u039E\u03BE",8:"\u0398\u03B8",A:"A\xC0\xC1\xC2\xC3\xC4\xC5\u0100\u0102\u0104\u01CD\u01DE\u01E0\u01FA\u0200\u0202\u0226\u023A\u1E00\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u24B6\u2C6F\uFF21\u0386\u0391\u0410",B:"B\u0181\u0182\u0243\u1E02\u1E04\u1E06\u24B7\uFF22\u0392\u0411",C:"C\xC7\u0106\u0108\u010A\u010C\u0187\u023B\u1E08\u24B8\uA73E\uFF23\u0426",D:"D\u010E\u0110\u0189\u018A\u018B\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u24B9\uA779\uFF24\xD0\u0394\u0414",E:"E\xC8\xC9\xCA\xCB\u0112\u0114\u0116\u0118\u011A\u018E\u0190\u0204\u0206\u0228\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u24BA\uFF25\u0388\u0395\u0415\u042D",F:"F\u0191\u1E1E\u24BB\uA77B\uFF26\u03A6\u0424",G:"G\u011C\u011E\u0120\u0122\u0193\u01E4\u01E6\u01F4\u1E20\u24BC\uA77D\uA77E\uA7A0\uFF27\u0393\u0413\u0490",H:"H\u0124\u0126\u021E\u1E22\u1E24\u1E26\u1E28\u1E2A\u24BD\u2C67\u2C75\uA78D\uFF28\u0389\u0397\u0425",I:"I\xCC\xCD\xCE\xCF\u0128\u012A\u012C\u012E\u0130\u0197\u01CF\u0208\u020A\u1E2C\u1E2E\u1EC8\u1ECA\u24BE\uFF29\u038A\u0399\u03AA\u0406\u0418",J:"J\u0134\u0248\u24BF\uFF2A\u0419",K:"K\u0136\u0198\u01E8\u1E30\u1E32\u1E34\u24C0\u2C69\uA740\uA742\uA744\uA7A2\uFF2B\u039A\u041A",L:"L\u0139\u013B\u013D\u013F\u0141\u023D\u1E36\u1E38\u1E3A\u1E3C\u24C1\u2C60\u2C62\uA746\uA748\uA780\uFF2C\u039B\u041B",M:"M\u019C\u1E3E\u1E40\u1E42\u24C2\u2C6E\uFF2D\u039C\u041C",N:"N\xD1\u0143\u0145\u0147\u019D\u01F8\u0220\u1E44\u1E46\u1E48\u1E4A\u24C3\uA790\uA7A4\uFF2E\u039D\u041D",O:"O\xD2\xD3\xD4\xD5\xD6\xD8\u014C\u014E\u0150\u0186\u019F\u01A0\u01D1\u01EA\u01EC\u01FE\u020C\u020E\u022A\u022C\u022E\u0230\u1E4C\u1E4E\u1E50\u1E52\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u24C4\uA74A\uA74C\uFF2F\u038C\u039F\u041E",P:"P\u01A4\u1E54\u1E56\u24C5\u2C63\uA750\uA752\uA754\uFF30\u03A0\u041F",Q:"Q\u024A\u24C6\uA756\uA758\uFF31",R:"R\u0154\u0156\u0158\u0210\u0212\u024C\u1E58\u1E5A\u1E5C\u1E5E\u24C7\u2C64\uA75A\uA782\uA7A6\uFF32\u03A1\u0420",S:"S\u015A\u015C\u015E\u0160\u0218\u1E60\u1E62\u1E64\u1E66\u1E68\u1E9E\u24C8\u2C7E\uA784\uA7A8\uFF33\u03A3\u0421",T:"T\u0162\u0164\u0166\u01AC\u01AE\u021A\u023E\u1E6A\u1E6C\u1E6E\u1E70\u24C9\uA786\uFF34\u03A4\u0422",U:"U\xD9\xDA\xDB\xDC\u0168\u016A\u016C\u016E\u0170\u0172\u01AF\u01D3\u01D5\u01D7\u01D9\u01DB\u0214\u0216\u0244\u1E72\u1E74\u1E76\u1E78\u1E7A\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u24CA\uFF35\u0423\u042A",V:"V\u01B2\u0245\u1E7C\u1E7E\u24CB\uA75E\uFF36\u0412",W:"W\u0174\u1E80\u1E82\u1E84\u1E86\u1E88\u24CC\u2C72\uFF37\u038F\u03A9",X:"X\u1E8A\u1E8C\u24CD\uFF38\u03A7",Y:"Y\xDD\u0176\u0178\u01B3\u0232\u024E\u1E8E\u1EF2\u1EF4\u1EF6\u1EF8\u1EFE\u24CE\uFF39\u038E\u03A5\u03AB\u042B",Z:"Z\u0179\u017B\u017D\u01B5\u0224\u1E90\u1E92\u1E94\u24CF\u2C6B\u2C7F\uA762\uFF3A\u0396\u0417",a:"a\xE0\xE1\xE2\xE3\xE4\xE5\u0101\u0103\u0105\u01CE\u01DF\u01E1\u01FB\u0201\u0203\u0227\u0250\u1E01\u1E9A\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u24D0\u2C65\uFF41\u03AC\u03B1\u0430",b:"b\u0180\u0183\u0253\u1E03\u1E05\u1E07\u24D1\uFF42\u03B2\u0431",c:"c\xE7\u0107\u0109\u010B\u010D\u0188\u023C\u1E09\u2184\u24D2\uA73F\uFF43\u0446",d:"d\u010F\u0111\u018C\u0256\u0257\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u24D3\uA77A\uFF44\xF0\u03B4\u0434",e:"e\xE8\xE9\xEA\xEB\u0113\u0115\u0117\u0119\u011B\u01DD\u0205\u0207\u0229\u0247\u025B\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u24D4\uFF45\u03AD\u03B5\u0435\u044D",f:"f\u0192\u1E1F\u24D5\uA77C\uFF46\u03C6\u0444",g:"g\u011D\u011F\u0121\u0123\u01E5\u01E7\u01F5\u0260\u1D79\u1E21\u24D6\uA77F\uA7A1\uFF47\u03B3\u0433\u0491",h:"h\u0125\u0127\u021F\u0265\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E96\u24D7\u2C68\u2C76\uFF48\u03AE\u03B7\u0445",i:"i\xEC\xED\xEE\xEF\u0129\u012B\u012D\u012F\u0131\u01D0\u0209\u020B\u0268\u1E2D\u1E2F\u1EC9\u1ECB\u24D8\uFF49\u0390\u03AF\u03B9\u03CA\u0438\u0456",j:"j\u0135\u01F0\u0249\u24D9\uFF4A\u0439",k:"k\u0137\u0199\u01E9\u1E31\u1E33\u1E35\u24DA\u2C6A\uA741\uA743\uA745\uA7A3\uFF4B\u03BA\u043A",l:"l\u013A\u013C\u013E\u0140\u0142\u017F\u019A\u026B\u1E37\u1E39\u1E3B\u1E3D\u24DB\u2C61\uA747\uA749\uA781\uFF4C\u03BB\u043B",m:"m\u026F\u0271\u1E3F\u1E41\u1E43\u24DC\uFF4D\u03BC\u043C",n:"n\xF1\u0144\u0146\u0148\u0149\u019E\u01F9\u0272\u1E45\u1E47\u1E49\u1E4B\u24DD\uA791\uA7A5\uFF4E\u03BD\u043D",o:"o\xF2\xF3\xF4\xF5\xF6\xF8\u014D\u014F\u0151\u01A1\u01D2\u01EB\u01ED\u01FF\u020D\u020F\u022B\u022D\u022F\u0231\u0254\u0275\u1E4D\u1E4F\u1E51\u1E53\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u24DE\uA74B\uA74D\uFF4F\u03BF\u03CC\u043E",p:"p\u01A5\u1D7D\u1E55\u1E57\u24DF\uA751\uA753\uA755\uFF50\u03C0\u043F",q:"q\u024B\u24E0\uA757\uA759\uFF51",r:"r\u0155\u0157\u0159\u0211\u0213\u024D\u027D\u1E59\u1E5B\u1E5D\u1E5F\u24E1\uA75B\uA783\uA7A7\uFF52\u03C1\u0440",s:"s\xDF\u015B\u015D\u015F\u0161\u0219\u023F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E9B\u24E2\uA785\uA7A9\uFF53\u03C2\u03C3\u0441",t:"t\u0163\u0165\u0167\u01AD\u021B\u0288\u1E6B\u1E6D\u1E6F\u1E71\u1E97\u24E3\u2C66\uA787\uFF54\u03C4\u0442",u:"u\xF9\xFA\xFB\xFC\u0169\u016B\u016D\u016F\u0171\u0173\u01B0\u01D4\u01D6\u01D8\u01DA\u01DC\u0215\u0217\u0289\u1E73\u1E75\u1E77\u1E79\u1E7B\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u24E4\uFF55\u0443\u044A",v:"v\u028B\u028C\u1E7D\u1E7F\u24E5\uA75F\uFF56\u0432",w:"w\u0175\u1E81\u1E83\u1E85\u1E87\u1E89\u1E98\u24E6\u2C73\uFF57\u03C9\u03CE",x:"x\u1E8B\u1E8D\u24E7\uFF58\u03C7",y:"y\xFD\xFF\u0177\u01B4\u0233\u024F\u1E8F\u1E99\u1EF3\u1EF5\u1EF7\u1EF9\u1EFF\u24E8\uFF59\u03B0\u03C5\u03CB\u03CD\u044B",z:"z\u017A\u017C\u017E\u01B6\u0225\u0240\u1E91\u1E93\u1E95\u24E9\u2C6C\uA763\uFF5A\u03B6\u0437",OE:"\x8C\u0152",oe:"\x9C\u0153",AE:"\xC6\u01E2\u01FC",ae:"\xE6\u01E3\u01FD",hv:"\u0195",OI:"\u01A2",oi:"\u01A3",DZ:"\u01C4\u01F1",Dz:"\u01C5\u01F2",dz:"\u01C6\u01F3",LJ:"\u01C7",Lj:"\u01C8",lj:"\u01C9",NJ:"\u01CA",Nj:"\u01CB",nj:"\u01CC",OU:"\u0222",ou:"\u0223",TZ:"\uA728",tz:"\uA729",AA:"\uA732",aa:"\uA733",AO:"\uA734",ao:"\uA735",AU:"\uA736",au:"\uA737",AV:"\uA738\uA73A",av:"\uA739\uA73B",AY:"\uA73C",ay:"\uA73D",OO:"\uA74E",oo:"\uA74F",VY:"\uA760",vy:"\uA761",TH:"\xDE",th:"\xFE",PS:"\u03A8",ps:"\u03C8",Yo:"\u0401",Ye:"\u0404",Yi:"\u0407",Zh:"\u0416",Ch:"\u0427",Sh:"\u0428\u0429","":"\u042C\u044C",Yu:"\u042E",Ya:"\u042F",zh:"\u0436",ch:"\u0447",sh:"\u0448\u0449",yu:"\u044E",ya:"\u044F",yo:"\u0451",ye:"\u0454",yi:"\u0457"},Ue=null;function Le(e){var u=(null!==Ue?Ue:(Ue={},Object.keys(Re).forEach(function(e){for(var u=Re[e],r=0;r<u.length;r++){var n=u[r];Ue[n]=e}}),Ue))[e];return u||e}function Ne(e,u){return u}function Pe(e){var u=n(e);return""===u?"":u.replace(F,Le).replace(f,Ne)}function ze(u,r,t){var i=n(u),a=O(r);return null!==a&&(""===a||(t=e(t)?0:N(z(t),0,i.length),-1!==i.indexOf(a,t)))}function qe(e,u){var r=e.toString().match(w)[0];return ze(r,u)?e:new RegExp(e.source,r+u)}var Ie=function(){return function(e,u){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,u){var r=[],n=!0,t=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done)&&(r.push(a.value),!u||r.length!==u);n=!0);}catch(c){t=!0,i=c}finally{try{!n&&o.return&&o.return()}finally{if(t)throw i}}return r}(e,u);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function _e(e,u){return e.length===u.length?0:e.length<u.length?1:-1}var Ve=Array.prototype.reduce;function Ye(u,r){var t=n(u);if(""===r||""===t)return t;var i=O(r);if(e(i))return t.replace(g,"");var a=!0;return Ve.call(t,function(e,u){return a&&ze(i,u)?e:(a=!1,e+u)},"")}var Ze=Array.prototype.reduceRight;function Te(u,r){var t=n(u);if(""===r||""===t)return t;var i=O(r);if(e(i))return t.replace(h,"");var a=!0;return Ze.call(t,function(e,u){return a&&ze(i,u)?e:(a=!1,u+e)},"")}var We="width",Ge="newLine",He="indent",Je="cut";function Xe(e){var u=n(e);return B.test(u)}var Ke="\uFEFF";var Me=0,Qe=1,eu=2;function uu(e){for(var u=Me,r="",n=0;u!==eu;){var t=e[n++].toLowerCase();switch(t){case"<":break;case">":u=eu;break;default:p.test(t)?u===Qe&&(u=eu):(u===Me&&(u=Qe),"/"!==t&&(r+=t));}}return r}var ru=0,nu=1,tu=2,iu=3;var au=null;var ou=null!==au?au:au="object"==typeof sb&&sb.Object===Object?sb:"object"==typeof self&&self.Object===Object?self:new Function("return this")(),cu=ou.v;var fu={camelCase:function(e){var u=n(e);return""===u?"":j(u).map(R).join("")},capitalize:t,decapitalize:function(e){var u=n(e);return""===u?"":u.substr(0,1).toLowerCase()+u.substr(1)},kebabCase:U,lowerCase:i,snakeCase:function(e){var u=n(e);return""===u?"":j(u).map(i).join("_")},swapCase:function(e){return n(e).split("").reduce(L,"")},titleCase:function(e,u){var r=n(e),i=Array.isArray(u)?u:[],a=$.test(r)?m:C;return r.replace(a,function(e,u){return u>0&&i.indexOf(r[u-1])>=0?e.toLowerCase():t(e,!0)})},upperCase:function(e){return n(e).toUpperCase()},count:function(e){return n(e).length},countGraphemes:function(e){return n(e).replace(f,"*").replace(s,"*").length},countSubstrings:function(e,u){var r=n(e),t=n(u),i=t.length,a=0,o=0;if(""===r||""===t)return a;do{-1!==(o=r.indexOf(t,o))&&(a++,o+=i)}while(-1!==o);return a},countWhere:function(e,u,r){var t=n(e);if(""===t||"function"!=typeof u)return 0;var i=u.bind(r);return G.call(t,function(e,u,r){return i(u,r,t)?e+1:e},0)},countWords:function(e,u,r){return j(e,u,r).length},escapeHtml:function(e){return n(e).replace(x,ke)},escapeRegExp:$e,unescapeHtml:function(e){var u=n(e);return Oe.reduce(je,u)},sprintf:me,vprintf:function(e,u){return me.apply(void 0,[e].concat(function(e){if(Array.isArray(e)){for(var u=0,r=Array(e.length);u<e.length;u++)r[u]=e[u];return r}return Array.from(e)}(S(u,[]))))},indexOf:function(e,u,r){return n(e).indexOf(u,r)},lastIndexOf:function(e,u,r){return n(e).lastIndexOf(u,r)},search:function(u,r,t){var i=n(u),a=e(t)?0:N(z(t),0,i.length),o=i.substr(a).search(r);return-1===o||isNaN(a)||(o+=a),o},charAt:function(e,u){return n(e).charAt(u)},codePointAt:W,first:function(u,r){var t=n(u),i=e(r)?1:N(z(r),0,P);return t.length<=i?t:t.substr(0,i)},graphemeAt:function(e,u){var r=n(e),t=Z(u),i=void 0,a=0;for(t=T(t,0);null!==(i=l.exec(r));){if(a===t)return l.lastIndex=0,i[0];a++}return""},last:function(u,r){var t=n(u),i=e(r)?1:N(z(r),0,P);return t.length<=i?t:t.substr(t.length-i,i)},prune:function(u,r,t){var i=n(u),a=e(r)?i.length:N(z(r),0,P),o=n(t,"...");if(a>=i.length)return i;var c=$.test(i)?m:C,f=0;return i.replace(c,function(e,u){var r=u+e.length;r<=a-o.length&&(f=r)}),i.substr(0,f)+o},slice:function(e,u,r){return n(e).slice(u,r)},substr:function(e,u,r){return n(e).substr(u,r)},substring:function(e,u,r){return n(e).substring(u,r)},truncate:q,insert:function(e,u,r){var t=n(e),i=n(u),a=Z(r);return a<0||a>t.length||""===i?t:t.slice(0,a)+i+t.slice(a)},latinise:Pe,pad:function(u,r,t){var i=n(u),a=e(r)?0:N(z(r),0,P),o=n(t," ");if(a<=i.length)return i;var c=a-i.length,f=z(c/2),s=c%2;return ve(o,f)+i+ve(o,f+s)},padLeft:de,padRight:Fe,repeat:he,replace:function(e,u,r){return n(e).replace(u,r)},replaceAll:function(e,u,r){var t=n(e),i=u;return u instanceof RegExp?u.global||(i=qe(u,"g")):i=new RegExp($e(u),"g"),t.replace(i,r)},reverse:function(e){return n(e).split("").reverse().join("")},reverseGrapheme:function e(u){for(var r=n(u),t="",i=(r=r.replace(f,function(u,r,n){return e(n)+r}).replace(s,"$2$1")).length;i--;)t+=r.charAt(i);return t},slugify:function(e){var u=n(e);return""===u?"":U(Pe(u).replace(F,"-"))},splice:function(e,u,r,t){var i=n(e),a=n(t),o=Z(u);o<0?(o=i.length+o)<0&&(o=0):o>i.length&&(o=i.length);var c=Z(r,i.length-o);return c<0&&(c=0),i.slice(0,o)+a+i.slice(o+c)},tr:function(e,u,t){var i=n(e),a=void 0,o=void 0;if(r(u)&&r(t))a=u.split(""),o=t.split("");else{var c=function(e){var u=Object.keys(e),r=u.sort(_e).map(function(u){return e[u]});return[u,r]}(S(u,{})),f=Ie(c,2);a=f[0],o=f[1]}var s=a.length;if(0===s)return i;for(var l="",p=o.length,g=0;g<i.length;g++){for(var h=!1,v=void 0,d=0;d<s&&d<p;d++){var F=a[d];if(i.substr(g,F.length)===F){h=!0,v=o[d],g=g+F.length-1;break}}l+=h?v:i[g]}return l},trim:function(u,r){var t=n(u);if(""===r||""===t)return t;var i=O(r);return e(i)?t.trim():Te(Ye(t,i),i)},trimLeft:Ye,trimRight:Te,wordWrap:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n(e),i=function(e){return{width:Z(e[We],75),newLine:n(e[Ge],"\n"),indent:n(e[He],""),cut:u(e[Je],!1)}}(r),a=i.width,o=i.newLine,c=i.indent,f=i.cut;if(""===t||a<=0)return c;for(var s=t.length,l=t.substring.bind(t),p=0,g="";s-p>a;)if(" "!==t[p]){var h=t.lastIndexOf(" ",a+p);h>=p?(g+=c+l(p,h)+o,p=h+1):f?(g+=c+l(p,a+p)+o,p+=a):(h=t.indexOf(" ",a+p))>=0?(g+=c+l(p,h)+o,p=h+1):(g+=c+l(p),p=s)}else p++;return p<s&&(g+=c+l(p)),g},endsWith:function(u,r,t){if(e(r))return!1;var i=n(u),a=n(r);if(""===a)return!0;t=e(t)?i.length:N(z(t),0,i.length),t-=a.length;var o=i.indexOf(a,t);return-1!==o&&o===t},includes:ze,isAlpha:Xe,isAlphaDigit:function(e){var u=n(e);return k.test(u)},isBlank:function(e){return 0===n(e).trim().length},isDigit:function(e){var u=n(e);return v.test(u)},isEmpty:function(e){return 0===n(e).length},isLowerCase:function(e){var u=n(e);return Xe(u)&&u.toLowerCase()===u},isNumeric:function(u){var r="object"!=typeof u||e(u)?u:Number(u);return("number"==typeof r||"string"==typeof r)&&!isNaN(r-parseFloat(r))},isString:r,isUpperCase:function(e){var u=n(e);return Xe(u)&&u.toUpperCase()===u},matches:function(e,u,r){var t=n(e),i=n(r),a=void 0;if(!(u instanceof RegExp)){if(null===(a=O(u)))return!1;u=new RegExp(a,i)}return u.test(t)},startsWith:function(u,r,t){var i=n(u),a=O(r);return null!==a&&(""===a||(t=e(t)?0:N(z(t),0,i.length),i.substr(t,a.length)===a))},chars:function(e){return n(e).split("")},codePoints:function(e){for(var u=n(e),r=u.length,t=[],i=0,a=void 0;i<r;)a=W(u,i),t.push(a),i+=a>65535?2:1;return t},graphemes:function(e){return S(n(e).match(l),[])},split:function(e,u,r){return n(e).split(u,r)},words:j,stripBom:function(e){var u=n(e);return""===u?"":u[0]===Ke?u.substring(1):u},stripTags:function(e,u,r){if(""===(e=n(e)))return"";if(!Array.isArray(u)){var t=n(u);u=""===t?[]:function(e){for(var u=[],r=void 0;null!==(r=D.exec(e));)u.push(r[1]);return u}(t)}for(var i=n(r),a=e.length,o=u.length>0,c=function(e,u,r){var n=0;return(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])&&(n=1-u.length),e.substr(r+n,u.length).toLowerCase()===u}.bind(null,e),f=ru,s=0,l="",p="",g=null,h=0;h<a;h++){var v=e[h],d=!1;switch(v){case"<":if(g)break;if(c("< ",h,!1)){d=!0;break}if(f===ru){d=!0,f=nu;break}if(f===nu){s++;break}d=!0;break;case"!":if(f===nu&&c("<!",h)){f=tu;break}d=!0;break;case"-":if(f===tu&&c("!--",h)){f=iu;break}d=!0;break;case"\"":case"'":f===nu&&(g===v?g=null:g||(g=v)),d=!0;break;case"E":case"e":if(f===tu&&c("doctype",h)){f=nu;break}d=!0;break;case">":if(s>0){s--;break}if(g)break;if(f===nu){if(g=null,f=ru,o){var F=uu(p+=">");-1!==u.indexOf(F.toLowerCase())?l+=p:l+=i,p=""}else l+=i;break}if(f===tu||f===iu&&c("-->",h)){g=null,f=ru,p="";break}d=!0;break;default:d=!0;}if(d)switch(f){case ru:l+=v;break;case nu:o&&(p+=v);}}return l},noConflict:function(){return this===ou.v&&(ou.v=cu),this},version:"1.4.0"};function su(e,u){this._wrappedValue=e,this._explicitChain=u}function lu(e){return new su(e,!1)}return su.prototype.value=function(){return this._wrappedValue},su.prototype.valueOf=function(){return this.value()},su.prototype.toJSON=function(){return this.value()},su.prototype.toString=function(){return String(this.value())},su.prototype.chain=function(){return new su(this._wrappedValue,!0)},su.prototype.thru=function(e){return"function"==typeof e?new su(e(this._wrappedValue),this._explicitChain):this},su.prototype._explicitChain=!0,Object.keys(fu).forEach(function(e){var u;su.prototype[e]=(u=fu[e],function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];var t=u.apply(void 0,[this._wrappedValue].concat(r));return this._explicitChain||"string"==typeof t?new su(t,this._explicitChain):t})}),(Object.assign||function(e){for(var u=1;u<arguments.length;u++){var r=arguments[u];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e})(lu,fu,{chain:function(e){return new su(e,!0)}}),lu});function bl(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function ng(e,a){for(var s=0;s<a.length;s++){var l=a[s];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}function cl(e,a,s){return a&&ng(e.prototype,a),s&&ng(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function dl(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function og(a,e){for(var n=0;n<e.length;n++){var l=e[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(a,l.key,l)}}function el(a,e,n){return e&&og(a.prototype,e),n&&og(a,n),Object.defineProperty(a,"prototype",{writable:!1}),a}var Fa;function Ga(E,$,_){return $ in E?Object.defineProperty(E,$,{value:_,enumerable:!0,configurable:!0,writable:!0}):E[$]=_,E}var pg="LAYER_NAME_GAMEPLAY_ELEMS";var Na="LAYER_NAME_TOP_GUI";var qg="LAYER_NAME_PAUSE_SCREEN";var rg="LAYER_NAME_ROTATION_SCREEN";var fl=100;var Fc="LAYER_GAMEPLAY_11";var gl="LAYER_GUI_11";var hl="LAYER_GUI_12";var il="LAYER_GUI_13";var jl="LAYER_GUI_21";var kl="LAYER_GUI_22";var ll="LAYER_GUI_23";var ml="LAYER_GUI_31";var nl="LAYER_GUI_32";var ol="LAYER_GUI_33";var pl="LAYER_ROTATION_SCREEN_22";var ql="LAYER_PAUSE_SCREEN_22";var Dd=(Ga(Fa={},Fc,{layerName:pg,anchorAxisX:1,anchorAxisY:1,workaroundDepth:1e5}),Ga(Fa,gl,{layerName:Na,anchorAxisX:1,anchorAxisY:1,workaroundDepth:2e5}),Ga(Fa,hl,{layerName:Na,anchorAxisX:1,anchorAxisY:2,workaroundDepth:2e5}),Ga(Fa,il,{layerName:Na,anchorAxisX:1,anchorAxisY:3,workaroundDepth:2e5}),Ga(Fa,jl,{layerName:Na,anchorAxisX:2,anchorAxisY:1,workaroundDepth:2e5}),Ga(Fa,kl,{layerName:Na,anchorAxisX:2,anchorAxisY:2,workaroundDepth:2e5}),Ga(Fa,ll,{layerName:Na,anchorAxisX:2,anchorAxisY:3,workaroundDepth:2e5}),Ga(Fa,ml,{layerName:Na,anchorAxisX:3,anchorAxisY:1,workaroundDepth:2e5}),Ga(Fa,nl,{layerName:Na,anchorAxisX:3,anchorAxisY:2,workaroundDepth:2e5}),Ga(Fa,ol,{layerName:Na,anchorAxisX:3,anchorAxisY:3,workaroundDepth:2e5}),Ga(Fa,ql,{layerName:qg,anchorAxisX:2,anchorAxisY:2,workaroundDepth:4e5}),Ga(Fa,pl,{layerName:rg,anchorAxisX:2,anchorAxisY:2,workaroundDepth:5e5}),Fa);var ya="spine",fb=function(){function a(){dl(this,a)}return el(a,null,[{key:"GetEmptyValues",value:function(){return{asset:"none",layer:[Fc],sublayer:0,curAnimation:null,animations:{}}}},{key:"InjectIntoActor",value:function(e,n,l,t,o,r){var i=a.GetEmptyValues();return i.asset=n,i.curAnimation=l,i.layer=o,i.sublayer=r,i.animations[l]={loops:t},e.vals[ya]=i,e.vals.visualBase=e.vals[ya],e}},{key:"PreBake",value:function(a){a.vals[ya].animations||(a.vals[ya].animations={}),a.vals.visualBase=a.vals[ya]}},{key:"Bake",value:function(a){var e=ba.InBakeGetSceneFromLayerCfg(a),n=!0,l=a.vals[ya].curAnimation;a.vals[ya].animations[l]&&(n=a.vals[ya].animations[l].loops);var t=e.make.spine({x:0,y:0,key:a.vals[ya].asset,animationName:l,loop:n,add:!1},!1);ba.InBakeAddDisplayedAndSetSelfRef(a,t)}},{key:"PostBake",value:function(e){var n=e.displayed;n.state.addListener({complete:function(a){var e=ba.GetActorFromDisplayObject(this),n=a.animation.name,l=e.vals[ya].animations[n];l&&l.onCompleteCommand&&ga.TriggerCommandsAtKey(e,l.onCompleteCommand)}.bind(n)}),e.vals[ya].debug&&a.ListAnimations(e)}},{key:"Cleanup",value:function(a){}},{key:"Name",get:function(){return ya}},{key:"Has",value:function(a){return!!a.vals[ya]}},{key:"SetAnimation",value:function(a,e){if(a.vals[ya].curAnimation!=e){a.vals[ya].curAnimation=e;var n=a.vals[ya].animations[e];n&&null!=n.loop?a.displayed.setAnimation(0,e,n.loop):a.displayed.setAnimation(0,e,!0)}}},{key:"ListAnimations",value:function(a){for(var e=0;e<a.displayed.stateData.skeletonData.animations.length;e++){var n=a.displayed.stateData.skeletonData.animations[e].name;console.log(n)}}}]),a}();function rl(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function sg(e,r){for(var a=0;a<r.length;a++){var t=r[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function sl(e,r,a){return r&&sg(e.prototype,r),a&&sg(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}var gb="sprite",Gc=function(){function e(){rl(this,e)}return sl(e,null,[{key:"GetEmptyValues",value:function(){return{texture:"none",layer:[Fc],sublayer:0}}},{key:"InjectIntoActor",value:function(r){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[Fc],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,$=e.GetEmptyValues();return $.texture=a,$.layer=t,$.sublayer=n,r.vals[gb]=$,r.vals.visualBase=r.vals[gb],r}},{key:"PreBake",value:function(e){e.vals.visualBase=e.vals[gb]}},{key:"Bake",value:function(e){var r=ba.InBakeGetSceneFromLayerCfg(e),a=e.vals[gb].texture,t=null;ia.GetPhaserGame().textures.exists(a)||(a="megaset",t=e.vals[gb].texture,console.assert(ia.GetPhaserGame().textures.exists(a)," MISSING TEXTURE KEY AT IMAGE: ",a));var n=r.make.sprite({x:0,y:0,key:a,frame:t,add:!1},!1);ba.InBakeAddDisplayedAndSetSelfRef(e,n)}},{key:"PostBake",value:function(e){}},{key:"Cleanup",value:function(e){}},{key:"Name",get:function(){return gb}},{key:"Has",value:function(e){return!!e.vals[gb]}}]),e}();var Hc={};var tl="VisualBaseComponent",ba=function(){function e(){bl(this,e)}return cl(e,null,[{key:"SetPosition",value:function(e,a,s){console.assert(!isNaN(a),"pX is: ",a),console.assert(!isNaN(a),"pY is: ",a),e.displayed.x=a,e.displayed.y=s}},{key:"SetX",value:function(e,a){console.assert(!isNaN(a),"pX is: ",a),e.displayed.x=a}},{key:"SetY",value:function(e,a){console.assert(!isNaN(a),"pX is: ",a),e.displayed.y=a}},{key:"SetPositionToAnotherWithOffset",value:function(a,s,l,i){e.SetPosition(a,s.displayed.x+l,s.displayed.y+i)}},{key:"SetAlpha",value:function(e,a){e.vals.visualBase.alpha=a,e.baked&&e.displayed.setAlpha(e.vals.visualBase.alpha)}},{key:"GetAlpha",value:function(e){return e.displayed.alpha}},{key:"AddToAlpha",value:function(a,s){var l=a.displayed.alpha;(l+=s)<0&&(l=0),l>1&&(l=1),e.SetAlpha(a,l)}},{key:"SetLayer",value:function(e,a){e.vals.visualBase.layer=a}},{key:"SetAngle",value:function(e,a){e.vals.visualBase.angle=a,e.baked&&e.displayed.setAngle(e.vals.visualBase.angle)}},{key:"SortParentContainer",value:function(e,a){e.displayed.parentContainer.sort(a)}},{key:"SetScale",value:function(e,a){e.vals.visualBase.scale=a,e.baked&&e.displayed.setScale(e.vals.visualBase.scale)}},{key:"SetVisible",value:function(e,a){e.vals.visualBase.visible=a,e.baked&&e.displayed.setVisible(e.vals.visualBase.visible)}},{key:"Resize",value:function(e,a,s){a&&(e.vals.visualBase.displayWidth=a),s&&(e.vals.visualBase.displayHeight=s),e.baked&&(a&&(e.displayed.displayWidth=a),s&&(e.displayed.displayHeight=s))}},{key:"SetFlipX",value:function(e,a){e.vals.visualBase.flipX=a,e.baked&&(fb.Has(e)?e.displayed.scaleX=a?-1:1:e.displayed.setFlipX(a))}},{key:"InBakeAddDisplayedAndSetSelfRef",value:function(e,a){e.displayed=a;var s=Dd[e.vals.visualBase.layer];null==e.vals.visualBase.sublayer&&(e.vals.visualBase.sublayer=0),ka.GetLayerContainerLite(s,e.vals.visualBase.sublayer).add(e.displayed),e.displayed.refSelfActor=e,null!=e.vals.visualBase.alpha&&e.displayed.setAlpha(e.vals.visualBase.alpha),null!=e.vals.visualBase.displayWidth&&null!=e.vals.visualBase.displayHeight&&(e.displayed.displayWidth=e.vals.visualBase.displayWidth,e.displayed.displayHeight=e.vals.visualBase.displayHeight),null!=e.vals.visualBase.angle&&e.displayed.setAngle(e.vals.visualBase.angle),null!=e.vals.visualBase.scale&&e.displayed.setScale(e.vals.visualBase.scale),null!=e.vals.visualBase.visible&&e.displayed.setVisible(e.vals.visualBase.visible),null!=e.vals.visualBase.flipX&&(fb.Has(e)?e.vals.visualBase.flipX?e.displayed.scaleX=-1:e.displayed.scaleX=1:e.displayed.setFlipX(e.vals.visualBase.flipX)),e.displayed.x=Ab.GetProperty_X(e),e.displayed.y=Ab.GetProperty_Y(e)}},{key:"InBakeGetSceneFromLayerCfg",value:function(e){null==e.vals.visualBase.layer&&(e.vals.visualBase.layer="LAYER_GAMEPLAY_11");var a=Dd[e.vals.visualBase.layer],s=ka.GetSceneNameByLayerName(a.layerName);console.assert(s,"is: ",s);var l=sa.GetScene(s);return console.assert(l,"is: ",l),l}},{key:"Cleanup",value:function(e){}},{key:"ReparentToSublayer",value:function(e,a){var s=Dd[e.vals.visualBase.layer],l=ka.GetLayerContainerLite(s,e.vals.visualBase.sublayer);if(e.displayed.scene==l.scene){var i=e.displayed.parentContainer.x,t=e.displayed.parentContainer.y;e.vals.visualBase.layer=a,e.displayed.x+=ka.GetValueScaledByReverseScreenScale(i-l.x),e.displayed.y+=ka.GetValueScaledByReverseScreenScale(t-l.y),l.add(e.displayed)}else console.warn("DONT REPARENT OBJECT BETWEEN LAYERS THAT ARE ON DIFFERENT SCENES, ABORTING")}},{key:"GetActorFromDisplayObject",value:function(e){return e.refSelfActor}},{key:"BringToTop",value:function(e){e.displayed.parentContainer.bringToTop(e.displayed)}},{key:"SetFlipY",value:function(e,a){e.displayed.setFlipY(a)}},{key:"ChangeOrigin",value:function(e,a,s){e.displayed.setOrigin(a,s)}},{key:"GetDisplayWidth",value:function(e){return e.displayed.displayWidth}},{key:"GetHalfDisplayWidth",value:function(e){return e.displayed.displayWidth/2}},{key:"GetDisplayHeight",value:function(e){return e.displayed.displayHeight}},{key:"GetHalfDisplayHeight",value:function(e){return e.displayed.displayHeight/2}},{key:"ResizeWidth",value:function(e,a){e.displayed.displayWidth=a}},{key:"SetScaleX",value:function(e,a){e.displayed.setScale(a,e.displayed.scaleY)}},{key:"SetScaleY",value:function(e,a){e.displayed.setScale(e.displayed.scaleX,a)}},{key:"MoveBySizeMultiplied",value:function(e,a,s){e.displayed.x=e.displayed.x+e.displayed.displayWidth*a,e.displayed.y=e.displayed.y+e.displayed.displayHeight*s}},{key:"MoveByXY",value:function(e,a,s){return e.displayed.x+=a,e.displayed.y+=s,e}},{key:"GetBounds",value:function(a){if(fb.Has(a)){Hc[a.vals.spine.layer]||(console.log("DOESNT HAVE BOUND HELPER"),Hc[a.vals.spine.layer]=ul(null,0,0,"ViewHelper",a.vals.spine.layer,100).bake(),e.SetVisible(Hc[a.vals.spine.layer],!1));var s=Hc[a.vals.spine.layer];return a.vals.spine.maxWidth<a.displayed.displayWidth&&(a.vals.spine.maxWidth=a.displayed.displayWidth),a.vals.spine.maxHeight<a.displayed.displayHeight&&(a.vals.spine.maxHeight=a.displayed.displayHeight),s.displayed.x=a.displayed.x,s.displayed.y=a.displayed.y,s.displayed.displayWidth=a.vals.spine.maxWidth,s.displayed.displayHeight=a.vals.spine.maxHeight,s.displayed.x-=a.displayed.displayOriginX-s.displayed.displayWidth/2,s.displayed.y-=a.displayed.displayOriginY-s.displayed.displayHeight/2,s.displayed.getBounds()}return a.displayed.getBounds()}},{key:"IsActorOnScreen",value:function(a){var s=e.GetBounds(a),l=a.displayed.scene.cameras.main.worldView,i=new Phaser.Geom.Rectangle(l.x,l.y,l.width,l.height),t=new Phaser.Geom.Rectangle(l.x,l.y,l.width,l.height),n=Phaser.Geom.Rectangle.ContainsRect(i,s);return n||(n=!0,s.y+s.height<i.y&&(n=!1),s.y>i.y+i.height&&(n=!1),s.x+s.width<i.x&&(n=!1),s.x-s.width>t.x+t.width&&(n=!1)),n}},{key:"GetAsSprite",value:function(e){return e}},{key:"Name",get:function(){return tl}}]),e}();var ul=function(e,a,s,l,i,t){var n;return console.assert(l),n=e||ga.GetEmptyActor(),Ab.InjectIntoActor(n,a,s),Gc.InjectIntoActor(n,l,i,t),n};var hb="bitmap_text",ib=function(){function e(){_k(this,e)}return al(e,null,[{key:"SetText",value:function(e,a){return e.vals[hb].text=a,e.baked&&(e.displayed.text=a),e}},{key:"GetText",value:function(e){return e.displayed.text}},{key:"SetTextWithZeroPad",value:function(e,a,t){if(e&&(e.vals[hb].text=a,e.baked)){var $gqyU$$interop$default=ld(Ec);var r=$gqyU$$interop$default.d.padLeft(a,t,"0");e.displayed.text=r}}},{key:"PreBake",value:function(e){e.vals.visualBase=e.vals[hb]}},{key:"Bake",value:function(e){var a=ba.InBakeGetSceneFromLayerCfg(e),t=e.vals[hb].text;t||(t="0000");var r=a.make.bitmapText({x:0,y:0,font:e.vals[hb].texture,text:t,add:!1},!1);ba.InBakeAddDisplayedAndSetSelfRef(e,r)}},{key:"PostBake",value:function(e){}},{key:"Cleanup",value:function(e){}},{key:"Name",get:function(){return hb}},{key:"Has",value:function(e){return!!e.vals[hb]}}]),e}();function vl(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function tg(e,a){for(var r=0;r<a.length;r++){var n=a[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wl(e,a,r){return a&&tg(e.prototype,a),r&&tg(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var fc="image",Ed=function(){function e(){vl(this,e)}return wl(e,null,[{key:"PreBake",value:function(e){e.vals.visualBase=e.vals[fc]}},{key:"Bake",value:function(e){var a=ba.InBakeGetSceneFromLayerCfg(e);console.assert(a);var r=e.vals[fc].texture,n=null;ia.GetPhaserGame().textures.exists(r)||(r="megaset",n=e.vals[fc].texture,console.assert(ia.GetPhaserGame().textures.exists(r)," MISSING TEXTURE KEY AT IMAGE: ",r));var i=a.make.image({x:0,y:0,key:r,frame:n,add:!1},!1);ba.InBakeAddDisplayedAndSetSelfRef(e,i)}},{key:"PostBake",value:function(e){}},{key:"Cleanup",value:function(e){}},{key:"Name",get:function(){return fc}},{key:"Has",value:function(e){return!!e.vals[fc]}}]),e}();function xl(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function ug(e,a){for(var r=0;r<a.length;r++){var n=a[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yl(e,a,r){return a&&ug(e.prototype,a),r&&ug(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ic="particle_emitter",Fb=function(){function e(){xl(this,e)}return yl(e,null,[{key:"PreBake",value:function(e){e.vals.visualBase=e.vals[Ic],null!=e.vals.visualBase.angle&&0!=e.vals.visualBase.angle&&(e.vals.visualBase.angle=0,console.warn("DON'T SET ANGLE ON PARTICLE, PLEASE DON'T"))}},{key:"Bake",value:function(e){var a=ba.InBakeGetSceneFromLayerCfg(e),r=e.vals[Ic],n=JSON.parse(JSON.stringify(r.config)),t=a.add.particles(r.texture);null==n.x&&(n.x=-1e6),null==n.x&&(n.x=-1e6);t.createEmitter(n);e.displayed=t,ba.InBakeAddDisplayedAndSetSelfRef(e,e.displayed)}},{key:"PostBake",value:function(e){}},{key:"Cleanup",value:function(e){}},{key:"GetEmitter",value:function(e){return e.displayed.emitters.list[0]}},{key:"GetParticles",value:function(e){return e.displayed}},{key:"Name",get:function(){return Ic}},{key:"Has",value:function(e){return!!e.vals[Ic]}}]),e}();var Jc=function(e){return e/1e3};var va={chrome:!1,chromeVersion:0,edge:!1,firefox:!1,firefoxVersion:0,ie:!1,ieVersion:0,mobileSafari:!1,opera:!1,safari:!1,safariVersion:0,silk:!1,trident:!1,tridentVersion:0};function zl(){var r=navigator.userAgent;return /Edge\/\d+/.test(r)?va.edge=!0:/Chrome\/(\d+)/.test(r)&&!Ja().windowsPhone?(va.chrome=!0,va.chromeVersion=parseInt(RegExp.$1,10)):/Firefox\D+(\d+)/.test(r)?(va.firefox=!0,va.firefoxVersion=parseInt(RegExp.$1,10)):/AppleWebKit/.test(r)&&Ja().iOS?va.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(r)?(va.ie=!0,va.ieVersion=parseInt(RegExp.$1,10)):/Opera/.test(r)?va.opera=!0:/Safari/.test(r)&&!Ja().windowsPhone?va.safari=!0:/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(r)&&(va.ie=!0,va.trident=!0,va.tridentVersion=parseInt(RegExp.$1,10),va.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(r)&&(va.silk=!0),va}function Al(t){return(Al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vg(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Cl(t,e,r){return e&&vg(t.prototype,e),r&&vg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Dl(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&El(t,e)}function El(t,e){return(El=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Fl(t){var e=Il();return function(){var r,o=wg(t);if(e){var n=wg(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return Gl(this,r)}}function Gl(t,e){if(e&&("object"===Al(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Hl(t)}function Hl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Il(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function wg(t){return(wg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Jl=function(t){Dl(r,Phaser.Plugins.BasePlugin);var e=Fl(r);function r(t){return Bl(this,r),e.call(this,t)}return Cl(r,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"add",value:function(t,e){return new Kk(t,e)}}]),r}();function Kl(t){return(Kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ll(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xg(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ml(t,e,r){return e&&xg(t.prototype,e),r&&xg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Nl(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ol(t,e)}function Ol(t,e){return(Ol=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Pl(t){var e=Sl();return function(){var r,o=yg(t);if(e){var n=yg(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return Ql(this,r)}}function Ql(t,e){if(e&&("object"===Kl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Rl(t)}function Rl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Sl(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function yg(t){return(yg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zg(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function Ul(t,e,i){return e&&zg(t.prototype,e),i&&zg(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}var ma=function(r,e,t){if(r&&"number"!=typeof r){if(r.hasOwnProperty(e))return r[e];if(-1!==e.indexOf(".")){for(var f=e.split("."),n=r,$=t,o=0;o<f.length;o++){if(!n.hasOwnProperty(f[o])){$=t;break}$=n[f[o]],n=n[f[o]]}return $}return t}return t};var Fd,Gd={};!function(e,t){"function"==typeof Fd&&Fd.amd?Fd([],t):void 0!==Gd?Gd=t():e.Papa=t()}(Gd,function e(){var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},r=!t.document&&!!t.postMessage,i=r&&/blob:/i.test((t.location||{}).protocol),n={},s=0,a={parse:function(r,i){var o=(i=i||{}).dynamicTyping||!1;if(E(o)&&(i.dynamicTypingFunction=o,o={}),i.dynamicTyping=o,i.transform=!!E(i.transform)&&i.transform,i.worker&&a.WORKERS_SUPPORTED){var h=function(){if(!a.WORKERS_SUPPORTED)return!1;var r,i,o=(r=t.URL||t.webkitURL||null,i=e.toString(),a.BLOB_URL||(a.BLOB_URL=r.createObjectURL(new Blob(["(",i,")();"],{type:"text/javascript"})))),h=new t.Worker(o);return h.onmessage=_,h.id=s++,n[h.id]=h}();return h.userStep=i.step,h.userChunk=i.chunk,h.userComplete=i.complete,h.userError=i.error,i.step=E(i.step),i.chunk=E(i.chunk),i.complete=E(i.complete),i.error=E(i.error),delete i.worker,void h.postMessage({input:r,config:i,workerId:h.id})}var c=null;return a.NODE_STREAM_INPUT,"string"==typeof r?c=i.download?new u(i):new d(i):!0===r.readable&&E(r.read)&&E(r.on)?c=new l(i):(t.File&&r instanceof File||r instanceof Object)&&(c=new f(i)),c.stream(r)},unparse:function(e,t){var r=!1,i=!0,n=",",s="\r\n",o="\"",h=o+o,u=!1,f=null,d=!1;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||a.BAD_DELIMITERS.filter(function(e){return-1!==t.delimiter.indexOf(e)}).length||(n=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(r=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(u=t.skipEmptyLines),"string"==typeof t.newline&&(s=t.newline),"string"==typeof t.quoteChar&&(o=t.quoteChar),"boolean"==typeof t.header&&(i=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");f=t.columns}void 0!==t.escapeChar&&(h=t.escapeChar+o),("boolean"==typeof t.escapeFormulae||t.escapeFormulae instanceof RegExp)&&(d=t.escapeFormulae instanceof RegExp?t.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var l=new RegExp(p(o),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return c(null,e,u);if("object"==typeof e[0])return c(f||Object.keys(e[0]),e,u)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||f),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),c(e.fields||[],e.data||[],u);throw new Error("Unable to serialize unrecognized input");function c(e,t,r){var a="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var o=Array.isArray(e)&&0<e.length,h=!Array.isArray(t[0]);if(o&&i){for(var u=0;u<e.length;u++)0<u&&(a+=n),a+=g(e[u],u);0<t.length&&(a+=s)}for(var f=0;f<t.length;f++){var d=o?e.length:t[f].length,l=!1,c=o?0===Object.keys(t[f]).length:0===t[f].length;if(r&&!o&&(l="greedy"===r?""===t[f].join("").trim():1===t[f].length&&0===t[f][0].length),"greedy"===r&&o){for(var p=[],_=0;_<d;_++){var m=h?e[_]:_;p.push(t[f][m])}l=""===p.join("").trim()}if(!l){for(var y=0;y<d;y++){0<y&&!c&&(a+=n);var v=o&&h?e[y]:y;a+=g(t[f][v],y)}f<t.length-1&&(!r||0<d&&!c)&&(a+=s)}}return a}function g(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var i=!1;d&&"string"==typeof e&&d.test(e)&&(e="'"+e,i=!0);var s=e.toString().replace(l,h);return(i=i||!0===r||"function"==typeof r&&r(e,t)||Array.isArray(r)&&r[t]||function(e,t){for(var r=0;r<t.length;r++)if(-1<e.indexOf(t[r]))return!0;return!1}(s,a.BAD_DELIMITERS)||-1<s.indexOf(n)||" "===s.charAt(0)||" "===s.charAt(s.length-1))?o+s+o:s}}};if(a.RECORD_SEP=String.fromCharCode(30),a.UNIT_SEP=String.fromCharCode(31),a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r","\n","\"",a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!r&&!!t.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=g,a.ParserHandle=c,a.NetworkStreamer=u,a.FileStreamer=f,a.StringStreamer=d,a.ReadableStreamStreamer=l,t.jQuery){var o=t.jQuery;o.fn.parse=function(e){var r=e.config||{},i=[];return this.each(function(e){if("INPUT"!==o(this).prop("tagName").toUpperCase()||"file"!==o(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var n=0;n<this.files.length;n++)i.push({file:this.files[n],inputElem:this,instanceConfig:o.extend({},r)})}),n(),this;function n(){if(0!==i.length){var t,r,n,h=i[0];if(E(e.before)){var u=e.before(h.file,h.inputElem);if("object"==typeof u){if("abort"===u.action)return"AbortError",t=h.file,r=h.inputElem,n=u.reason,void(E(e.error)&&e.error({name:"AbortError"},t,r,n));if("skip"===u.action)return void s();"object"==typeof u.config&&(h.instanceConfig=o.extend(h.instanceConfig,u.config))}else if("skip"===u)return void s()}var f=h.instanceConfig.complete;h.instanceConfig.complete=function(e){E(f)&&f(e,h.file,h.inputElem),s()},a.parse(h.file,h.instanceConfig)}else E(e.complete)&&e.complete()}function s(){i.splice(0,1),n()}}}function h(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=v(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new c(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,r){if(this.isFirstChunk&&E(this._config.beforeFirstChunk)){var n=this._config.beforeFirstChunk(e);void 0!==n&&(e=n)}this.isFirstChunk=!1,this._halted=!1;var s=this._partialLine+e;this._partialLine="";var o=this._handle.parse(s,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var h=o.meta.cursor;this._finished||(this._partialLine=s.substring(h-this._baseIndex),this._baseIndex=h),o&&o.data&&(this._rowCount+=o.data.length);var u=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(i)t.postMessage({results:o,workerId:a.WORKER_ID,finished:u});else if(E(this._config.chunk)&&!r){if(this._config.chunk(o,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);o=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(o.data),this._completeResults.errors=this._completeResults.errors.concat(o.errors),this._completeResults.meta=o.meta),this._completed||!u||!E(this._config.complete)||o&&o.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),u||o&&o.meta.paused||this._nextChunk(),o}this._halted=!0},this._sendError=function(e){E(this._config.error)?this._config.error(e):i&&this._config.error&&t.postMessage({workerId:a.WORKER_ID,error:e,finished:!1})}}function u(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),h.call(this,e),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),r||(t.onload=k(this._chunkLoaded,this),t.onerror=k(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var i in e)t.setRequestHeader(i,e[i])}if(this._config.chunkSize){var n=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+n)}try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}r&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){var e;4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(null===(e=t.getResponseHeader("Content-Range"))?-1:parseInt(e.substring(e.lastIndexOf("/")+1))),this.parseChunk(t.responseText)))},this._chunkError=function(e){var r=t.statusText||e;this._sendError(new Error(r))}}function f(e){var t,r;(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),h.call(this,e);var i="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,r=e.slice||e.webkitSlice||e.mozSlice,i?((t=new FileReader).onload=k(this._chunkLoaded,this),t.onerror=k(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var n=Math.min(this._start+this._config.chunkSize,this._input.size);e=r.call(e,this._start,n)}var s=t.readAsText(e,this._config.encoding);i||this._chunkLoaded({target:{result:s}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function d(e){var t;h.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,r=this._config.chunkSize;return r?(e=t.substring(0,r),t=t.substring(r)):(e=t,t=""),this._finished=!t,this.parseChunk(e)}}}function l(e){h.call(this,e=e||{});var t=[],r=!0,i=!1;this.pause=function(){h.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){h.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){i&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=k(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=k(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=k(function(){this._streamCleanUp(),i=!0,this._streamData("")},this),this._streamCleanUp=k(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function c(e){var t,r,i,n=Math.pow(2,53),s=-n,o=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,h=/^(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))$/,u=this,f=0,d=0,l=!1,c=!1,_=[],m={data:[],errors:[],meta:{}};if(E(e.step)){var y=e.step;e.step=function(t){if(m=t,w())b();else{if(b(),0===m.data.length)return;f+=t.data.length,e.preview&&f>e.preview?r.abort():(m.data=m.data[0],y(m,u))}}}function k(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function b(){return m&&i&&(R("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),i=!1),e.skipEmptyLines&&(m.data=m.data.filter(function(e){return!k(e)})),w()&&function(){if(m)if(Array.isArray(m.data[0])){for(var t=0;w()&&t<m.data.length;t++)m.data[t].forEach(r);m.data.splice(0,1)}else m.data.forEach(r);function r(t,r){E(e.transformHeader)&&(t=e.transformHeader(t,r)),_.push(t)}}(),function(){if(!m||!e.header&&!e.dynamicTyping&&!e.transform)return m;function t(t,r){var i,n=e.header?{}:[];for(i=0;i<t.length;i++){var s=i,a=t[i];e.header&&(s=i>=_.length?"__parsed_extra":_[i]),e.transform&&(a=e.transform(a,s)),a=C(s,a),"__parsed_extra"===s?(n[s]=n[s]||[],n[s].push(a)):n[s]=a}return e.header&&(i>_.length?R("FieldMismatch","TooManyFields","Too many fields: expected "+_.length+" fields but parsed "+i,d+r):i<_.length&&R("FieldMismatch","TooFewFields","Too few fields: expected "+_.length+" fields but parsed "+i,d+r)),n}var r=1;return!m.data.length||Array.isArray(m.data[0])?(m.data=m.data.map(t),r=m.data.length):m.data=t(m.data,0),e.header&&m.meta&&(m.meta.fields=_),d+=r,m}()}function w(){return e.header&&0===_.length}function C(t,r){return i=t,e.dynamicTypingFunction&&void 0===e.dynamicTyping[i]&&(e.dynamicTyping[i]=e.dynamicTypingFunction(i)),!0===(e.dynamicTyping[i]||e.dynamicTyping)?"true"===r||"TRUE"===r||"false"!==r&&"FALSE"!==r&&(function(e){if(o.test(e)){var t=parseFloat(e);if(s<t&&t<n)return!0}return!1}(r)?parseFloat(r):h.test(r)?new Date(r):""===r?null:r):r;var i}function R(e,t,r,i){var n={type:e,code:t,message:r};void 0!==i&&(n.row=i),m.errors.push(n)}this.parse=function(n,s,o){var h=e.quoteChar||"\"";if(e.newline||(e.newline=function(e,t){e=e.substring(0,1048576);var r=new RegExp(p(t)+"([^]*?)"+p(t),"gm"),i=(e=e.replace(r,"")).split("\r"),n=e.split("\n"),s=1<n.length&&n[0].length<i[0].length;if(1===i.length||s)return"\n";for(var a=0,o=0;o<i.length;o++)"\n"===i[o][0]&&a++;return a>=i.length/2?"\r\n":"\r"}(n,h)),i=!1,e.delimiter)E(e.delimiter)&&(e.delimiter=e.delimiter(n),m.meta.delimiter=e.delimiter);else{var u=function(t,r,i,n,s){var o,h,u,f;s=s||[",","\t","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var d=0;d<s.length;d++){var l=s[d],c=0,p=0,_=0;u=void 0;for(var m=new g({comments:n,delimiter:l,newline:r,preview:10}).parse(t),y=0;y<m.data.length;y++)if(i&&k(m.data[y]))_++;else{var v=m.data[y].length;p+=v,void 0!==u?0<v&&(c+=Math.abs(v-u),u=v):u=v}0<m.data.length&&(p/=m.data.length-_),(void 0===h||c<=h)&&(void 0===f||f<p)&&1.99<p&&(h=c,o=l,f=p)}return{successful:!!(e.delimiter=o),bestDelimiter:o}}(n,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);u.successful?e.delimiter=u.bestDelimiter:(i=!0,e.delimiter=a.DefaultDelimiter),m.meta.delimiter=e.delimiter}var f=v(e);return e.preview&&e.header&&f.preview++,t=n,r=new g(f),m=r.parse(t,s,o),b(),l?{meta:{paused:!0}}:m||{meta:{paused:!1}}},this.paused=function(){return l},this.pause=function(){l=!0,r.abort(),t=E(e.chunk)?"":t.substring(r.getCharIndex())},this.resume=function(){u.streamer._halted?(l=!1,u.streamer.parseChunk(t,!0)):setTimeout(u.resume,3)},this.aborted=function(){return c},this.abort=function(){c=!0,r.abort(),m.meta.aborted=!0,E(e.complete)&&e.complete(m),t=""}}function p(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(e){var t,r=(e=e||{}).delimiter,i=e.newline,n=e.comments,s=e.step,o=e.preview,h=e.fastMode,u=t=void 0===e.quoteChar||null===e.quoteChar?"\"":e.quoteChar;if(void 0!==e.escapeChar&&(u=e.escapeChar),("string"!=typeof r||-1<a.BAD_DELIMITERS.indexOf(r))&&(r=","),n===r)throw new Error("Comment character same as delimiter");!0===n?n="#":("string"!=typeof n||-1<a.BAD_DELIMITERS.indexOf(n))&&(n=!1),"\n"!==i&&"\r"!==i&&"\r\n"!==i&&(i="\n");var f=0,d=!1;this.parse=function(e,a,l){if("string"!=typeof e)throw new Error("Input must be a string");var c=e.length,g=r.length,_=i.length,m=n.length,y=E(s),v=[],k=[],b=[],w=f=0;if(!e)return M();if(h||!1!==h&&-1===e.indexOf(t)){for(var C=e.split(i),R=0;R<C.length;R++){if(b=C[R],f+=b.length,R!==C.length-1)f+=i.length;else if(l)return M();if(!n||b.substring(0,m)!==n){if(y){if(v=[],D(b.split(r)),$(),d)return M()}else D(b.split(r));if(o&&o<=R)return v=v.slice(0,o),M(!0)}}return M()}for(var S=e.indexOf(r,f),x=e.indexOf(i,f),O=new RegExp(p(u)+p(t),"g"),I=e.indexOf(t,f);;)if(e[f]!==t){if(n&&0===b.length&&e.substring(f,f+m)===n){if(-1===x)return M();f=x+_,x=e.indexOf(i,f),S=e.indexOf(r,f)}else if(-1!==S&&(S<x||-1===x))b.push(e.substring(f,S)),f=S+g,S=e.indexOf(r,f);else{if(-1===x)break;if(b.push(e.substring(f,x)),z(x+_),y&&($(),d))return M();if(o&&v.length>=o)return M(!0)}}else for(I=f,f++;;){if(-1===(I=e.indexOf(t,I+1)))return l||k.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:v.length,index:f}),F();if(I===c-1)return F(e.substring(f,I).replace(O,t));if(t!==u||e[I+1]!==u){if(t===u||0===I||e[I-1]!==u){-1!==S&&S<I+1&&(S=e.indexOf(r,I+1)),-1!==x&&x<I+1&&(x=e.indexOf(i,I+1));var T=L(-1===x?S:Math.min(S,x));if(e.substr(I+1+T,g)===r){b.push(e.substring(f,I).replace(O,t)),e[f=I+1+T+g]!==t&&(I=e.indexOf(t,f)),S=e.indexOf(r,f),x=e.indexOf(i,f);break}var A=L(x);if(e.substring(I+1+A,I+1+A+_)===i){if(b.push(e.substring(f,I).replace(O,t)),z(I+1+A+_),S=e.indexOf(r,f),I=e.indexOf(t,f),y&&($(),d))return M();if(o&&v.length>=o)return M(!0);break}k.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:v.length,index:f}),I++}}else I++}return F();function D(e){v.push(e),w=f}function L(t){var r=0;if(-1!==t){var i=e.substring(I+1,t);i&&""===i.trim()&&(r=i.length)}return r}function F(t){return l||(void 0===t&&(t=e.substring(f)),b.push(t),f=c,D(b),y&&$()),M()}function z(t){f=t,D(b),b=[],x=e.indexOf(i,f)}function M(e){return{data:v,errors:k,meta:{delimiter:r,linebreak:i,aborted:d,truncated:!!e,cursor:w+(a||0)}}}function $(){s(M()),v=[],k=[]}},this.abort=function(){d=!0},this.getCharIndex=function(){return f}}function _(e){var t=e.data,r=n[t.workerId],i=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var s={abort:function(){i=!0,m(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:y,resume:y};if(E(r.userStep)){for(var a=0;a<t.results.data.length&&(r.userStep({data:t.results.data[a],errors:t.results.errors,meta:t.results.meta},s),!i);a++);delete t.results}else E(r.userChunk)&&(r.userChunk(t.results,s,t.file),delete t.results)}t.finished&&!i&&m(t.workerId,t.results)}function m(e,t){var r=n[e];E(r.userComplete)&&r.userComplete(t),r.terminate(),delete n[e]}function y(){throw new Error("Not implemented.")}function v(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var r in e)t[r]=v(e[r]);return t}function k(e,t){return function(){e.apply(t,arguments)}}function E(e){return"function"==typeof e}return i&&(t.onmessage=function(e){var r=e.data;if(void 0===a.WORKER_ID&&r&&(a.WORKER_ID=r.workerId),"string"==typeof r.input)t.postMessage({workerId:a.WORKER_ID,results:a.parse(r.input,r.config),finished:!0});else if(t.File&&r.input instanceof File||r.input instanceof Object){var i=a.parse(r.input,r.config);i&&t.postMessage({workerId:a.WORKER_ID,results:i,finished:!0})}}),(u.prototype=Object.create(h.prototype)).constructor=u,(f.prototype=Object.create(h.prototype)).constructor=f,(d.prototype=Object.create(d.prototype)).constructor=d,(l.prototype=Object.create(h.prototype)).constructor=l,a});function Vl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ag(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Wl(e,t,r){return t&&Ag(e.prototype,t),r&&Ag(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Xl(t){return(Xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Gb=function(t){if("object"!==Xl(t)||null===t)return t;if(Array.isArray(t))t.length=0;else for(var o in t)delete t[o];return t};var Bg=function(e,r){var l=Array.isArray(e);if(void 0===r?r=l?[]:{}:Gb(r),l){r.length=e.length;for(var $=0,a=e.length;$<a;$++)r[$]=e[$]}else for(var t in e)r[t]=e[t];return r};var Hd=Phaser.Utils.Objects.GetValue,Yl=function(){function e(t){Vl(this,e),this.scenario=t,this.queue=[],this.currentIdx=-1,this.nextIdx=0}return Wl(e,[{key:"resetFromJSON",value:function(e){var t=Hd(e,"queue",void 0);return void 0===t?Gb(this.queue):Bg(t,this.queue),this.currentIdx=Hd(e,"curIdx",-1),this.nextIdx=Hd(e,"nextIdx",0),this}},{key:"clear",value:function(){return this.currentIdx=-1,this.nextIdx=0,this.queue.length=0,this}},{key:"append",value:function(e){return this.queue.push(e),this}},{key:"setNextIndex",value:function(e){return void 0===e&&(e=this.currentIdx+1),this.nextIdx=e,this}},{key:"get",value:function(e){return void 0===e&&(e=this.nextIdx),this.currentIdx=e,this.queue[e]}},{key:"length",get:function(){return this.queue.length}}]),e}();function Zl(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Cg(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function $l(e,r,t){return r&&Cg(e.prototype,r),t&&Cg(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _l(e){return(_l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function am(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dg(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function bm(e,t,r){return t&&Dg(e.prototype,t),r&&Dg(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cm(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dm(e,t)}function dm(e,t){return(dm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function em(e){var t=hm();return function(){var r,o=Eg(e);if(t){var a=Eg(this).constructor;r=Reflect.construct(o,arguments,a)}else r=o.apply(this,arguments);return fm(this,r)}}function fm(e,t){if(t&&("object"===_l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return gm(e)}function gm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Eg(e){return(Eg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function im(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Fg(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function jm(e,r,t){return r&&Fg(e.prototype,r),t&&Fg(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var Hb=function(){function e(r,t){im(this,e),this.scenario=r,this.type=t}return jm(e,[{key:"resetFromJSON",value:function(e){}},{key:"toJSON",value:function(){return{}}},{key:"parse",value:function(e,r){return e}},{key:"run",value:function(e){}}]),e}();var km=function(t,e,$,r){void 0===$&&($=0),void 0===r&&(r=e.length),t.length=r-$;for(var o=0,x=t.length;o<x;o++)t[o]=e[o+$];return t};var lm=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,Gg=function($){return"string"!=typeof $?$:(""===$?$=null:lm.test($)?$=parseFloat($):"false"===$?$=!1:"true"===$&&($=!0),$)};var Hg=function(t){return"[object Array]"===Object.prototype.toString.call(t)};var Kc=Phaser.Utils.Objects.GetValue,Id=function($,a,r){var e,t=Kc(r,"reverse",!1);if(Hg($[0])){if(t)for(d=(l=$.length)-1;d>=0;d--)e=Id($[d],a,r);else for(var d=0,l=$.length;d<l;d++)e=Id($[d],a,r);}else e=mm($,a,r);return e},mm=function($,a,r){var e,t=Kc(r,"argsConvert",void 0),d=Kc(r,"argsConvertScope",void 0),l=$[0];if(Ib=km(Ib,$,1),t){!0===t&&(t=Gg,d=void 0);for(var v=0,o=Ib.length;v<o;v++)Ib[v]=d?t.call(d,Ib[v],$):t(Ib[v],$)}return"string"==typeof l?null==(e=a[l])&&(e=Kc(a,l,null)):e=l,e.apply(a,Ib)},Ib=[];var nm=Phaser.Utils.Array.SpliceOne,om=function(e){cm(r,Hb);var t=em(r);function r(e){var o;return am(this,r),(o=t.call(this,e,"-")).task=void 0,o}return bm(r,[{key:"resetFromJSON",value:function(e){this.task&&(this.task.off("complete",this.resume,this),this.task=void 0)}},{key:"parse",value:function(e,t){var r=nm(e,0),o=this.scenario,a=o.argsConvert,n=o.argsConvertScope;if(a){!0===a&&(a=Gg,n=void 0);for(var i=1,s=e.length;i<s;i++)e[i]=n?a.call(n,e[i],e):a(e[i],e)}return e=[r,e]}},{key:"run",value:function(e){var t=this.scenario,r=Id(e[1],t.scope);r&&"function"==typeof r.once?(r.once("complete",this.resume,this),this.pause(),this.task=r):this.task=void 0}},{key:"pause",value:function(){this.scenario.pause()}},{key:"resume",value:function(){this.task=void 0;var e=this.scenario;e.resume(),e.runNextCmd()}}]),r}();function pm(t){return(pm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qm(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ig(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function rm(t,e,r){return e&&Ig(t.prototype,e),r&&Ig(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function sm(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tm(t,e)}function tm(t,e){return(tm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function um(t){var e=xm();return function(){var r,o=Jg(t);if(e){var n=Jg(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return vm(this,r)}}function vm(t,e){if(e&&("object"===pm(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return wm(t)}function wm(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Jg(t){return(Jg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ym=function(t){sm(r,Hb);var e=um(r);function r(t){return qm(this,r),e.call(this,t,"wait")}return rm(r,[{key:"parse",value:function(t,e){t.length=2;var r=this.getEventName(t);return isNaN(r)||(t[1]=parseFloat(r)),t}},{key:"run",value:function(t){var e=this.getEventName(t);"number"==typeof e?this.waitTime(e):this.waitEvent(e)}},{key:"waitTime",value:function(t){t>this.scenario.offset?(t-=this.scenario.offset,this.scenario.offset=0,this.scenario.isDebugMode&&this.scenario.log("#WAIT: "+t),this.scenario.wait(t)):this.scenario.offset-=t}},{key:"waitEvent",value:function(t){this.scenario.isDebugMode&&this.scenario.log("#WAIT: "+t),this.scenario.wait(t)}},{key:"getEventName",value:function(t){var e=t[1];return null==e&&(e="",t[1]=e),e}}]),r}();function zm(e){return(zm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Am(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kg(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Bm(e,t,r){return t&&Kg(e.prototype,t),r&&Kg(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cm(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dm(e,t)}function Dm(e,t){return(Dm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Em(e){var t=Hm();return function(){var r,o=Lg(e);if(t){var a=Lg(this).constructor;r=Reflect.construct(o,arguments,a)}else r=o.apply(this,arguments);return Fm(this,r)}}function Fm(e,t){if(t&&("object"===zm(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Gm(e)}function Gm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Lg(e){return(Lg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Jd=Phaser.Utils.Objects.GetValue,Im=function(e){Cm(r,Hb);var t=Em(r);function r(e){var o;return Am(this,r),(o=t.call(this,e,"label")).labels={},o.prevLabel="",o.lastLabel="",o}return Bm(r,[{key:"resetFromJSON",value:function(e){this.prevLabel=Jd(e,"preLabel",""),this.lastLabel=Jd(e,"lastLabel","");var t=Jd(e,"labels",void 0);void 0===t?Gb(this.labels):Bg(t,this.labels)}},{key:"toJSON",value:function(){return{preLabel:this.prevLabel,lastLabel:this.lastLabel,labels:this.labels}}},{key:"parse",value:function(e,t){e.length=2;var r=this.getLabel(e);return this.addLabel(r,t),e}},{key:"run",value:function(e){var t=this.getLabel(e);this.scenario.isDebugMode&&this.scenario.log("#LABEL: "+t),this.prevLabel=this.lastLabel,this.lastLabel=t;var r=this.scenario;r.emit("labelchange",this.lastLabel,this.prevLabel,r.scope,r)}},{key:"getLabel",value:function(e){var t=e[1];return null==t&&(t="",e[1]=t),t}},{key:"addLabel",value:function(e,t){this.labels[e]=t}},{key:"getIndex",value:function(e){return""!==e&&this.hasLabel(e)?this.labels[e]:0}},{key:"hasLabel",value:function(e){return this.labels.hasOwnProperty(e)}}]),r}();function Jm(t){return(Jm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Km(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mg(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Lm(t,e,r){return e&&Mg(t.prototype,e),r&&Mg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Mm(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nm(t,e)}function Nm(t,e){return(Nm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Om(t){var e=Rm();return function(){var r,o=Ng(t);if(e){var n=Ng(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return Pm(this,r)}}function Pm(t,e){if(e&&("object"===Jm(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Qm(t)}function Qm(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Rm(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Ng(t){return(Ng=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Sm=function(t){Mm(r,Hb);var e=Om(r);function r(t){return Km(this,r),e.call(this,t,"exit")}return Lm(r,[{key:"parse",value:function(t,e){return t.length=1,t}},{key:"run",value:function(t){this.scenario.log("#EXIT"),this.scenario.complete()}}]),r}();function Tm(t){return(Tm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Um(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Og(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Vm(t,e,r){return e&&Og(t.prototype,e),r&&Og(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Wm(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xm(t,e)}function Xm(t,e){return(Xm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ym(t){var e=_m();return function(){var r,o=Pg(t);if(e){var n=Pg(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return Zm(this,r)}}function Zm(t,e){if(e&&("object"===Tm(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return $m(t)}function $m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Pg(t){return(Pg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var an=function(t){Wm(r,Hb);var e=Ym(r);function r(t){return Um(this,r),e.call(this,t,"goto")}return Vm(r,[{key:"parse",value:function(t,e){return t.length=2,t}},{key:"run",value:function(t){var e=this.getLabel(t);this.scenario.isDebugMode&&this.scenario.log("#GOTO label: "+e),this.scenario.goto(e)}},{key:"getLabel",value:function(t){var e=t[1];return null==e&&(e="",t[1]=e),e}}]),r}();function bn(e){return(bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qg(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function dn(e,t,r){return t&&Qg(e.prototype,t),r&&Qg(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function en(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fn(e,t)}function fn(e,t){return(fn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function gn(e){var t=kn();return function(){var r,o=Rg(e);if(t){var n=Rg(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return hn(this,r)}}function hn(e,t){if(t&&("object"===bn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return jn(e)}function jn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Rg(e){return(Rg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ln=function(e){en(r,Hb);var t=gn(r);function r(e){return cn(this,r),t.call(this,e,"if")}return dn(r,[{key:"parse",value:function(e,t){e.length=4;var r="("+this.getCond(e)+")";return e[1]=new Function("return "+r),e}},{key:"run",value:function(e){var t=this.getCond(e).call(this.scenario.scope),r=t?this.getTrueLabel(e):this.getFalseLabel(e);""!==r&&(this.scenario.isDebugMode&&this.scenario.log("#IF "+t+"- GOTO label: "+r),this.scenario.goto(r))}},{key:"getCond",value:function(e){var t=e[1];return null!=t&&""!==t||(t="true",e[1]=t),t}},{key:"getTrueLabel",value:function(e){var t=e[2];return null==t&&(t="",e[2]=t),t}},{key:"getFalseLabel",value:function(e){var t=e[3];return null==t&&(t="",e[3]=t),t}}]),r}();var mn=Phaser.Utils.Objects.GetValue,nn=function(){function e(r){Zl(this,e),this.cmds={"-":new om(r),wait:new ym(r),label:new Im(r),exit:new Sm(r),goto:new an(r),if:new ln(r)}}return $l(e,[{key:"resetFromJSON",value:function(e){for(var r in this.cmds)this.cmds[r].resetFromJSON(mn(e,r,void 0));return this}},{key:"toJSON",value:function(){var e={};for(var r in this.cmds)e[r]=this.cmds[r].toJSON();return e}},{key:"get",value:function(e){return this.cmds[e]}},{key:"isValidCmdName",value:function(e){return this.cmds.hasOwnProperty(e)}}]),e}();var Sg=function(){function t(e,i){Tl(this,t),this.setEventEmitter(ma(i,"eventEmitter",void 0)),this.scene=e,this.timer=void 0,this.instMem=new Yl(this),this.cmdHandlers=new nn(this),this.resetFromJSON(i),this.boot()}return Ul(t,[{key:"resetFromJSON",value:function(t){return this._inRunCmdLoop=!1,this.isRunning=ma(t,"state",!1),this.isPaused=ma(t,"pause",!1),this.waitEvent=ma(t,"wait",void 0),this.scope=ma(t,"scope",void 0),this.timeUnit=ma(t,"timeUnit",0),this.cmdPrefix=ma(t,"prefix",pn),this.argsConvert=ma(t,"argsConvert",!0),this.argsConvertScope=ma(t,"argsConvertScope",void 0),this.cmdHandlers.resetFromJSON(ma(t,"handlers",void 0)),this.instMem.resetFromJSON(ma(t,"instMem",void 0)),this.delimiter=ma(t,"delimiter",","),this}},{key:"toJSON",value:function(){return{state:this.isRunning,pause:this.isPaused,wait:this.waitEvent,scope:this.scope,timeUnit:this.timeUnit,prefix:this.cmdPrefix,argsConvert:this.argsConvert,argsConvertScope:this.argsConvertScope,handlers:this.cmdHandlers.toJSON(),instMem:this.instMem.toJSON(),delimiter:this.delimiter}}},{key:"boot",value:function(){this.scene.sys.events.once("shutdown",this.destroy,this)}},{key:"shutdown",value:function(){this.scene&&(this.destroyEventEmitter(),this.clear(),this.scene.sys.events.off("shutdown",this.destroy,this),this.scene=void 0)}},{key:"destroy",value:function(){this.shutdown()}},{key:"load",value:function(t,e,i){return this.clear(),this.timeUnit=ma(i,"timeUnit",this.timeUnit),"string"==typeof this.timeUnit&&(this.timeUnit=on[this.timeUnit]),this.cmdPrefix=ma(i,"prefix",this.cmdPrefix),"string"==typeof this.cmdPrefix&&(this.cmdPrefix=new RegExp(this.cmdPrefix)),this.argsConvert=ma(i,"argsConvert",this.argsConvert),this.argsConvertScope=ma(i,"argsConvertScope",this.argsConvertScope),this.scope=e,this.delimiter=ma(i,"delimiter",this.delimiter),this.append(t),this}},{key:"clear",value:function(){this.stop(),this.instMem.resetFromJSON(),this.cmdHandlers.resetFromJSON()}},{key:"start",value:function(t){this.stop();var e=ma(t,"label","");return this.offset=ma(t,"offset",0),this.isDebugMode&&this.log("Start at Label: "+e),!!this.goto(e)&&(this.isRunning=!0,this.runNextCmd(),!0)}},{key:"getIndex",value:function(t){var e=this.getCmdHandler("label").getIndex(t);return null==e&&this.error("Label: "+t+" is not found"),e}},{key:"goto",value:function(t){var e;return null!=(e="string"==typeof t?this.getIndex(t):t)&&(this.instMem.setNextIndex(e),!0)}},{key:"wait",value:function(t){if(this.waitEvent=t,"number"==typeof t){var e=t;1===this.timeUnit&&(e*=1e3),this.timer=this.scene.time.delayedCall(e,this.continue,[t],this)}return this}},{key:"stop",value:function(){return this.isRunning?(this.isRunning=!1,this.isPaused=!1,this.waitEvent=void 0,this.timer&&(this.timer.remove(),this.timer=void 0),this):this}},{key:"complete",value:function(){return this.emit("complete",this.scope,this),this.stop(),this}},{key:"append",value:function(t){var $rVYa$$interop$default=ld(Gd);var e=$rVYa$$interop$default.d.parse(t,{delimiter:this.delimiter}).data;return this.parse(e),this}},{key:"pause",value:function(){return this.isRunning?this.isPaused?this:(this.isPaused=!0,this.timer&&(this.timer.paused=!0),this):this}},{key:"resume",value:function(){return this.isRunning&&this.isPaused?(this.isPaused=!1,this.timer&&(this.timer.paused=!1),this):this}},{key:"continue",value:function(t){return!this.isRunning||this.isPaused||void 0===this.waitEvent?this:(t===this.waitEvent&&(this.timer=void 0,this.waitEvent=void 0,this.runNextCmd()),this)}},{key:"lastLabel",get:function(){return this.cmdHandlers.labelCmd.lastLabel}},{key:"previousLabel",get:function(){return this.cmdHandlers.labelCmd.preLabel}},{key:"getCmdHandler",value:function(t){return"string"!=typeof t&&(t=t[0]),this.cmdHandlers.get(t)}},{key:"parse",value:function(t){for(var e,i,s=this.cmdPrefix,r=0,n=t.length;r<n;r++)if("-"===(i=(e=t[r])[0]))this.appendCommand(e);else if(isNaN(i)){if(s.test(i)){var a=i.match(s);e[0]=a[1].toLowerCase(),this.appendCommand(e)||this.error("Line "+r+": "+JSON.stringify(e)+" is not a valid command")}else this.appendCommand(["wait",i]),e[0]="-",this.appendCommand(e);}else{var o=parseFloat(i);o>0&&this.appendCommand(["wait",o]),e[0]="-",this.appendCommand(e)}return this}},{key:"appendCommand",value:function(t){var e=this.getCmdHandler(t);return null!=e&&((t=e.parse(t,this.instMem.length))&&this.instMem.append(t),!0)}},{key:"runNextCmd",value:function(){if(!this._inRunCmdLoop){this.threadId;var t,e=this.instMem;for(this._inRunCmdLoop=!0;this.isRunning&&!this.isPaused&&void 0===this.waitEvent;){if(t=e.get(),e.setNextIndex(),null==t){this.complete();break}this.getCmdHandler(t).run(t)}return this._inRunCmdLoop=!1,this}}},{key:"log",value:function(t){return this.emit("log",t,this.scope,this),this}},{key:"isDebugMode",get:function(){return this.listenerCount("log")>0}},{key:"error",value:function(t){return this.emit("error",t,this.scope,this),this}}]),t}();Object.assign(Sg.prototype,Ac);var on={ms:0,s:1,sec:1},pn=/^#([a-zA-Z]+)/;var qn=function(t){Nl(r,Phaser.Plugins.BasePlugin);var e=Pl(r);function r(t){return Ll(this,r),e.call(this,t)}return Ml(r,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"add",value:function(t,e){return new Sg(t,e)}}]),r}();function rn(e){return(rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tg(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function tn(e,t,r){return t&&Tg(e.prototype,t),r&&Tg(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function un(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vn(e,t)}function vn(e,t){return(vn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function wn(e){var t=zn();return function(){var r,o=Ug(e);if(t){var n=Ug(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return xn(this,r)}}function xn(e,t){if(t&&("object"===rn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return yn(e)}function yn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Ug(e){return(Ug=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function An(t){return(An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vg(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Cn(t,e,r){return e&&Vg(t.prototype,e),r&&Vg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Kd(){return(Kd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var o=Dn(t,e);if(o){var a=Object.getOwnPropertyDescriptor(o,e);return a.get?a.get.call(arguments.length<3?t:r):a.value}}).apply(this,arguments)}function Dn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Jb(t)););return t}function En(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fn(t,e)}function Fn(t,e){return(Fn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Gn(t){var e=Jn();return function(){var r,o=Jb(t);if(e){var a=Jb(this).constructor;r=Reflect.construct(o,arguments,a)}else r=o.apply(this,arguments);return Hn(this,r)}}function Hn(t,e){if(e&&("object"===An(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return In(t)}function In(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Jb(t){return(Jb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kn(t){return(Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ln(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wg(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Mn(t,e,r){return e&&Wg(t.prototype,e),r&&Wg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Xg(){return(Xg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=Nn(t,e);if(n){var u=Object.getOwnPropertyDescriptor(n,e);return u.get?u.get.call(arguments.length<3?t:r):u.value}}).apply(this,arguments)}function Nn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=gc(t)););return t}function On(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pn(t,e)}function Pn(t,e){return(Pn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Qn(t){var e=Tn();return function(){var r,n=gc(t);if(e){var u=gc(this).constructor;r=Reflect.construct(n,arguments,u)}else r=n.apply(this,arguments);return Rn(this,r)}}function Rn(t,e){if(e&&("object"===Kn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Sn(t)}function Sn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Tn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function gc(t){return(gc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Un(t){return(Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yg(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Wn(t,e,r){return e&&Yg(t.prototype,e),r&&Yg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Lc(){return(Lc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var o=Xn(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(arguments.length<3?t:r):n.value}}).apply(this,arguments)}function Xn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=jb(t)););return t}function Yn(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zn(t,e)}function Zn(t,e){return(Zn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function $n(t){var e=bo();return function(){var r,o=jb(t);if(e){var n=jb(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return _n(this,r)}}function _n(t,e){if(e&&("object"===Un(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ao(t)}function ao(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function jb(t){return(jb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function co(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zg(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function eo(t,e,r){return e&&Zg(t.prototype,e),r&&Zg(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var Ya=Phaser.Utils.Objects.GetValue,$g=Phaser.Math.Clamp,fo=function(){function t(e){co(this,t),this.resetFromJSON(e)}return eo(t,[{key:"resetFromJSON",value:function(t){this.state=Ya(t,"state",hc),this.timeScale=Ya(t,"timeScale",1),this.delay=Ya(t,"delay",0),this.repeat=Ya(t,"repeat",0),this.repeatCounter=Ya(t,"repeatCounter",0),this.duration=Ya(t,"duration",0),this.nowTime=Ya(t,"nowTime",0),this.justRestart=Ya(t,"justRestart",!1)}},{key:"toJSON",value:function(){return{state:this.state,timeScale:this.timeScale,delay:this.delay,repeat:this.repeat,repeatCounter:this.repeatCounter,duration:this.duration,nowTime:this.nowTime,justRestart:this.justRestart}}},{key:"destroy",value:function(){}},{key:"setTimeScale",value:function(t){return this.timeScale=t,this}},{key:"setDelay",value:function(t){return void 0===t&&(t=0),this.delay=t,this}},{key:"setDuration",value:function(t){return this.duration=t,this}},{key:"setRepeat",value:function(t){return this.repeat=t,this}},{key:"setRepeatInfinity",value:function(){return this.repeat=-1,this}},{key:"start",value:function(){return this.nowTime=this.delay>0?-this.delay:0,this.state=this.nowTime>=0?Lb:Kb,this.repeatCounter=0,this}},{key:"stop",value:function(){return this.state=hc,this}},{key:"update",value:function(t,e){this.state!==hc&&this.state!==Mc&&0!==e&&0!==this.timeScale&&(this.nowTime+=e*this.timeScale,this.state=this.nowTime>=0?Lb:Kb,this.justRestart=!1,this.nowTime>=this.duration&&(-1===this.repeat||this.repeatCounter<this.repeat?(this.repeatCounter++,this.justRestart=!0,this.nowTime-=this.duration):(this.nowTime=this.duration,this.state=Mc)))}},{key:"t",get:function(){var t;switch(this.state){case hc:case Kb:t=0;break;case Lb:t=this.nowTime/this.duration;break;case Mc:t=1;}return $g(t,0,1)},set:function(t){(t=$g(t,-1,1))<0?(this.state=Kb,this.nowTime=-this.delay*t):(this.state=Lb,this.nowTime=this.duration*t,1===t&&0!==this.repeat&&this.repeatCounter++)}},{key:"setT",value:function(t){return this.t=t,this}},{key:"isIdle",get:function(){return this.state===hc}},{key:"isDelay",get:function(){return this.state===Kb}},{key:"isCountDown",get:function(){return this.state===Lb}},{key:"isRunning",get:function(){return this.state===Kb||this.state===Lb}},{key:"isDone",get:function(){return this.state===Mc}},{key:"isOddIteration",get:function(){return 1==(1&this.repeatCounter)}},{key:"isEvenIteration",get:function(){return 0==(1&this.repeatCounter)}}]),t}(),hc=0,Kb=1,Lb=2,Mc=-1;var go=function(t){Yn(r,Bc);var e=$n(r);function r(t,o){var n;return Vn(this,r),(n=e.call(this,t,o)).timer=new fo,n}return Wn(r,[{key:"shutdown",value:function(t){this.isShutdown||(Lc(jb(r.prototype),"shutdown",this).call(this,t),this.timer.destroy(),this.timer=void 0)}},{key:"start",value:function(){return this.timer.start(),Lc(jb(r.prototype),"start",this).call(this),this}},{key:"stop",value:function(){return this.timer.stop(),Lc(jb(r.prototype),"stop",this).call(this),this}},{key:"complete",value:function(){return this.timer.stop(),Lc(jb(r.prototype),"complete",this).call(this),this}}]),r}();var ic=Phaser.Utils.Objects.GetValue,_g=Phaser.Utils.Objects.GetAdvancedValue,ho=Phaser.Tweens.Builders.GetEaseFunction,io=function(t){On(r,go);var e=Qn(r);function r(){return Ln(this,r),e.apply(this,arguments)}return Mn(r,[{key:"resetFromJSON",value:function(t){return this.timer.resetFromJSON(ic(t,"timer")),this.setEnable(ic(t,"enable",!0)),this.setTarget(ic(t,"target",this.parent)),this.setDelay(_g(t,"delay",0)),this.setDuration(_g(t,"duration",1e3)),this.setEase(ic(t,"ease","Linear")),this.setRepeat(ic(t,"repeat",0)),this}},{key:"setEnable",value:function(t){return null==t&&(t=!0),this.enable=t,this}},{key:"setTarget",value:function(t){return void 0===t&&(t=this.parent),this.target=t,this}},{key:"setDelay",value:function(t){return this.delay=t,this}},{key:"setDuration",value:function(t){return this.duration=t,this}},{key:"setEase",value:function(t){return void 0===t&&(t="Linear"),this.ease=t,this.easeFn=ho(t),this}},{key:"setRepeat",value:function(t){return this.repeat=t,this}},{key:"start",value:function(){return this.timer.isRunning?this:(Xg(gc(r.prototype),"start",this).call(this),this)}},{key:"restart",value:function(){return this.timer.stop(),this.start.apply(this,arguments),this}},{key:"stop",value:function(t){return void 0===t&&(t=!1),Xg(gc(r.prototype),"stop",this).call(this),t&&(this.timer.setT(1),this.updateGameObject(this.target,this.timer),this.complete()),this}},{key:"update",value:function(t,e){if(!this.isRunning||!this.enable||!this.parent.active)return this;var r=this.target,n=this.timer;return n.update(t,e),n.isDelay||this.updateGameObject(r,n),this.emit("update",r,this),n.isDone&&this.complete(),this}},{key:"updateGameObject",value:function(t,e){}}]),r}();var jo=Phaser.Utils.Objects.GetValue,Mb=Phaser.Utils.Objects.GetAdvancedValue,ah=Phaser.Math.Linear,jc=function(t){En(r,io);var e=Gn(r);function r(t,o){var a;return Bn(this,r),(a=e.call(this,t,o)).resetFromJSON(o),a.boot(),a}return Cn(r,[{key:"resetFromJSON",value:function(t){if(Kd(Jb(r.prototype),"resetFromJSON",this).call(this,t),this.setMode(jo(t,"mode",0)),t&&(t.hasOwnProperty("x")||t.hasOwnProperty("y"))){var e=Mb(t,"x",void 0),o=Mb(t,"y",void 0);this.setTargetPosition(e,o)}else this.setTargetPosition(t);return this}},{key:"setMode",value:function(t){return"string"==typeof t&&(t=ko[t]),this.mode=t,this}},{key:"setTargetPosition",value:function(t,e){if("number"==typeof t||"number"==typeof e)this.startX=this.parent.x,this.startY=this.parent.y,this.endX=t,this.endY=e;else{var r=t;this.startX=Mb(r,"startX",void 0),this.startY=Mb(r,"startY",void 0),this.endX=Mb(r,"endX",void 0),this.endY=Mb(r,"endY",void 0)}return this.hasMoveX=void 0!==this.startX&&void 0!==this.endX,this.hasMoveY=void 0!==this.startY&&void 0!==this.endY,this}},{key:"start",value:function(){if(this.timer.isRunning)return this;var t=this.parent;return this.hasMoveX&&(t.x=this.startX),this.hasMoveY&&(t.y=this.startY),this.timer.setDelay(this.delay).setDuration(this.duration).setRepeat(2===this.mode?-1:0),Kd(Jb(r.prototype),"start",this).call(this),this}},{key:"updateGameObject",value:function(t,e){var r=e.t;e.isOddIteration&&(r=1-r),r=this.easeFn(r),this.hasMoveX&&(t.x=ah(this.startX,this.endX,r)),this.hasMoveY&&(t.y=ah(this.startY,this.endY,r))}},{key:"complete",value:function(){return Kd(Jb(r.prototype),"complete",this).call(this),1===this.mode&&this.parent.destroy(),this}}]),r}(),ko={stop:0,destroy:1,yoyo:2};var Nc=function(e,r){if("number"==typeof e)return e;var t=e[0],a=parseFloat(e.substr(2));switch(t){case"+":return r+a;case"-":return r-a;case"*":return r*a;case"/":return r/a;}};var bh=function(e,r,$,a,o,t,i){t instanceof jc&&(i=t,t=void 0),void 0===t&&(t=!1);var s={};return s.mode=t?1:0,void 0!==$&&(s.startX=e.x,s.endX=Nc($,e.x)),void 0!==a&&(s.startY=e.y,s.endY=Nc(a,e.y)),s.duration=r,s.ease=void 0===o?"Linear":o,void 0===i?i=new jc(e,s):i.resetFromJSON(s),i.restart(),i};var ch=function(e,r,$,a,o,t,i){t instanceof jc&&(i=t,t=void 0),void 0===t&&(t=!1);var s={};return s.mode=t?1:0,void 0!==$&&(s.startX=Nc($,e.x),s.endX=e.x),void 0!==a&&(s.startY=Nc(a,e.y),s.endY=e.y),s.duration=r,s.ease=void 0===o?"Linear":o,void 0===i?i=new jc(e,s):i.resetFromJSON(s),i.restart(),i};var lo=function(e,o,r,$,t,s){return bh(e,o,r,$,t,!0,s)},mo=function(e,o,r,$,t,s){return ch(e,o,r,$,t,!0,s)};var dh=function(e){un(r,Phaser.Plugins.BasePlugin);var t=wn(r);function r(e){return sn(this,r),t.call(this,e)}return tn(r,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"add",value:function(e,t){return new jc(e,t)}}]),r}(),no={moveTo:bh,moveFrom:ch,moveToDestroy:lo,moveFromDestroy:mo};Object.assign(dh.prototype,no);function oo(e){return(oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eh(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function po(e,t,r){return t&&eh(e.prototype,t),r&&eh(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ro(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&so(e,t)}function so(e,t){return(so=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function to(e){var t=wo();return function(){var r,o=fh(e);if(t){var a=fh(this).constructor;r=Reflect.construct(o,arguments,a)}else r=o.apply(this,arguments);return uo(this,r)}}function uo(e,t){if(t&&("object"===oo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return vo(e)}function vo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function fh(e){return(fh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xo(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function gh(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function yo(e,r,t){return r&&gh(e.prototype,r),t&&gh(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var kb=function(){function e(r){xo(this,e),this.scene=r}return yo(e,null,[{key:"register",value:function(r,t){e.prototype[r]=t}}]),e}();function zo(t){return(zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ao(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hh(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function Bo(t,e,r){return e&&hh(t.prototype,e),r&&hh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Co(){return(Co="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var a=Do(t,e);if(a){var n=Object.getOwnPropertyDescriptor(a,e);return n.get?n.get.call(arguments.length<3?t:r):n.value}}).apply(this,arguments)}function Do(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Oc(t)););return t}function Eo(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fo(t,e)}function Fo(t,e){return(Fo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Go(t){var e=Io();return function(){var r,a=Oc(t);if(e){var n=Oc(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return Ho(this,r)}}function Ho(t,e){if(e&&("object"===zo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ih(t)}function ih(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Io(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Oc(t){return(Oc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jo(t){return(Jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ko(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jh(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Lo(t,e,n){return e&&jh(t.prototype,e),n&&jh(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Pc(){return(Pc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var o=Mo(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(this,arguments)}function Mo(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=lb(t)););return t}function No(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Oo(t,e)}function Oo(t,e){return(Oo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Po(t){var e=So();return function(){var n,o=lb(t);if(e){var i=lb(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return Qo(this,n)}}function Qo(t,e){if(e&&("object"===Jo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ro(t)}function Ro(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function So(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function lb(t){return(lb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ld=Phaser.Utils.Objects.GetValue,Qc=function(t){No(n,hg);var e=Po(n);function n(t,o){var i;Ko(this,n);var r=fg(t);return r===t&&(t=void 0),(i=e.call(this,r,o)).gameObject=t,t&&t.setInteractive(Ld(o,"inputConfig",void 0)),i._enable=void 0,i.resetFromJSON(o),i.boot(),i}return Lo(n,[{key:"resetFromJSON",value:function(t){return this.setEnable(Ld(t,"enable",!0)),this.setDetectBounds(),void 0===this.gameObject?this.setDetectBounds(Ld(t,"bounds",void 0)):this.setDetectBounds(),this.tracerState=Md,this.pointer=void 0,this.lastPointer=void 0,this.movedState=!1,this.isTouchingAnyObject=!1,this}},{key:"boot",value:function(){Pc(lb(n.prototype),"boot",this).call(this),this.gameObject?this.gameObject.on("pointerdown",this.onPointerDown,this):this.scene.input.on("pointerdown",this.onPointerDown,this),this.scene.input.on("pointerup",this.onPointerUp,this),this.scene.input.on("gameout",this.dragCancel,this),this.scene.input.on("pointermove",this.onPointerMove,this),this.scene.sys.events.once("shutdown",this.destroy,this)}},{key:"shutdown",value:function(t){this.scene&&(this.gameObject||this.scene.input.off("pointerdown",this.onPointerDown,this),this.scene.input.off("pointerup",this.onPointerUp,this),this.scene.input.off("gameout",this.dragCancel,this),this.scene.input.off("pointermove",this.onPointerMove,this),this.scene.sys.events.off("shutdown",this.destroy,this),this.gameObject=void 0,this.bounds=void 0,this.pointer=void 0,this.lastPointer=void 0,this.movedState=!1,Pc(lb(n.prototype),"shutdown",this).call(this,t))}},{key:"enable",get:function(){return this._enable},set:function(t){if(this._enable!==t)return t||this.dragCancel(),this._enable=t,this}},{key:"setEnable",value:function(t){return void 0===t&&(t=!0),this.enable=t,this}},{key:"setDetectBounds",value:function(t){return this.bounds=t,this}},{key:"toggleEnable",value:function(){return this.setEnable(!this.enable),this}},{key:"onPointerDown",value:function(t,e){this.enable&&void 0===this.pointer&&(!this.bounds||this.bounds.contains(t.x,t.y))&&this.pointer!==t&&(this.pointer=t,this.lastPointer=t,this.movedState=!1,this.tracerState=kh,void 0===this.gameObject&&(this.isTouchingAnyObject=e.length>0),this.onDragStart())}},{key:"onPointerUp",value:function(t){this.enable&&(!this.bounds||this.bounds.contains(t.x,t.y))&&this.pointer===t&&(this.pointer=void 0,this.movedState=!1,this.tracerState=Md,this.onDragEnd())}},{key:"onPointerMove",value:function(t){if(this.enable&&t.isDown){var e=!this.bounds||this.bounds.contains(t.x,t.y),n=this.pointer===t;!n&&e||(n&&!e?this.onPointerUp(t):(this.movedState||(this.movedState=t.x!==t.downX||t.y!==t.downY),this.movedState&&this.onDrag()))}}},{key:"dragCancel",value:function(){return this.tracerState===kh&&this.onDragEnd(),this.pointer=void 0,this.tracerState=Md,this}},{key:"onDragStart",value:function(){this.emit("dragstart",this)}},{key:"onDragEnd",value:function(){this.emit("dragend",this)}},{key:"onDrag",value:function(){this.emit("drag",this)}},{key:"preUpdate",value:function(t,e){}},{key:"postUpdate",value:function(t,e){}},{key:"startTicking",value:function(){Pc(lb(n.prototype),"startTicking",this).call(this),this.scene.sys.events.on("preupdate",this.preUpdate,this),this.scene.sys.events.on("postupdate",this.postUpdate,this)}},{key:"stopTicking",value:function(){Pc(lb(n.prototype),"stopTicking",this).call(this),this.scene&&(this.scene.sys.events.off("preupdate",this.preUpdate,this),this.scene.sys.events.off("postupdate",this.postUpdate,this))}},{key:"setRecongizedStateObject",value:function(t){return this.recongizedState=t,this}},{key:"state",get:function(){return this.recongizedState.state},set:function(t){this.recongizedState.state=t}},{key:"cancel",value:function(){return this.state=To,this}}]),n}(),Md=0,kh=1,To="IDLE";function Uo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lh(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Vo(t,e,s){return e&&lh(t.prototype,e),s&&lh(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}var mb=function(){function t(e){Uo(this,t);var s=ma(e,"states",void 0);s&&this.addStates(s);var i=ma(e,"extend",void 0);if(i)for(var r in i)this.hasOwnProperty(r)&&void 0!==this[r]||(this[r]=i[r]);var a=ma(e,"eventEmitter",void 0),n=ma(e,"EventEmitterClass",void 0);this.setEventEmitter(a,n),this._stateLock=!1,this.resetFromJSON(e)}return Vo(t,[{key:"shutdown",value:function(){this.destroyEventEmitter()}},{key:"destroy",value:function(){this.shutdown()}},{key:"resetFromJSON",value:function(t){this.setEnable(ma(t,"enable",!0)),this.start(ma(t,"start",void 0));var e=ma(t,"init",void 0);return e&&e.call(this),this}},{key:"toJSON",value:function(){return{curState:this.state,prevState:this.prevState,enable:this.enable,start:this._start}}},{key:"setEnable",value:function(t){return void 0===t&&(t=!0),this.enable=t,this}},{key:"toggleEnable",value:function(){return this.setEnable(!this.enable),this}},{key:"state",get:function(){return this._state},set:function(t){if(this.enable&&!this._stateLock&&this._state!==t){if(this._prevState=this._state,this._state=t,this._stateLock=!0,this.emit("statechange",this),null!=this._prevState){var e="exit_"+this._prevState,s=this[e];s&&s.call(this),this.emit(e,this)}if(this._stateLock=!1,null!=this._state){var i="enter_"+this._state,r=this[i];r&&r.call(this),this.emit(i,this)}}}},{key:"prevState",get:function(){return this._prevState}},{key:"start",value:function(t){return this._start=t,this._prevState=void 0,this._state=t,this}},{key:"goto",value:function(t){return null!=t&&(this.state=t),this}},{key:"next",value:function(){var t,e=this["next_"+this.state];return e&&(t="string"==typeof e?e:e.call(this)),this.goto(t),this}},{key:"addState",value:function(t,e){"string"!=typeof t&&(t=(e=t).name);var s=e.next;s&&(this["next_"+t]=s);var i=e.exit;i&&(this["exit_"+t]=i);var r=e.enter;return r&&(this["enter_"+t]=r),this}},{key:"addStates",value:function(t){if(Array.isArray(t))for(var e=0,s=t.length;e<s;e++)this.addState(t[e]);else for(var i in t)this.addState(i,t[i]);return this}},{key:"runMethod",value:function(t,e,s,i,r,a){var n=this[t+"_"+this.state];if(n){var o=arguments.length;switch(o){case 1:return n.call(this);case 2:return n.call(this,e);case 3:return n.call(this,e,s);case 4:return n.call(this,e,s,i);case 5:return n.call(this,e,s,i,r);case 6:return n.call(this,e,s,i,r,a);}for(var u=new Array(o-1),h=1;h<o;h++)u[h-1]=arguments[h];return n.apply(this,u)}}},{key:"update",value:function(t,e){this.runMethod("update",t,e)}},{key:"preupdate",value:function(t,e){this.runMethod("preupdate",t,e)}},{key:"postupdate",value:function(t,e){this.runMethod("postupdate",t,e)}}]),t}();Object.assign(mb.prototype,Ac);var nb=Phaser.Utils.Objects.GetValue,Wo=Phaser.Math.Distance.Between,mh=function(t){Eo(r,Qc);var e=Go(r);function r(t,a){var n;Ao(this,r);var i=ih(n=e.call(this,t,a)),s={states:{IDLE:{enter:function(){i.stop(),i.tapsCount=0,i.x=0,i.y=0,i.worldX=0,i.worldY=0},exit:function(){var t=i.lastPointer;i.x=t.x,i.y=t.y,i.worldX=t.worldX,i.worldY=t.worldY}},BEGIN:{enter:function(){i.start(),i.tapsCount=0,i.emit("tappingstart",i,i.gameObject,i.lastPointer)}},RECOGNIZED:{enter:function(){i.start(),i.emit("tap",i,i.gameObject,i.lastPointer),i.emit("".concat(i.tapsCount,"tap"),i,i.gameObject,i.lastPointer)}}},init:function(){this.state=ob},eventEmitter:!1};return n.setRecongizedStateObject(new mb(s)),n}return Bo(r,[{key:"resetFromJSON",value:function(t){Co(Oc(r.prototype),"resetFromJSON",this).call(this,t),this.setHoldTime(nb(t,"time",250)),this.setTapInterval(nb(t,"tapInterval",200)),this.setDragThreshold(nb(t,"threshold",9)),this.setTapOffset(nb(t,"tapOffset",10));var e=nb(t,"taps",void 0);return void 0!==e?this.setTaps(e):(this.setMaxTaps(nb(t,"maxTaps",void 0)),this.setMinTaps(nb(t,"minTaps",void 0))),this}},{key:"onDragStart",value:function(){switch(this.state){case ob:this.state=Nb;break;case Nb:var t=this.lastPointer;Wo(t.upX,t.upY,t.x,t.y)>this.tapOffset&&(this.state=Ob,this.state=Nb);break;case Ob:this.state=Nb;}}},{key:"onDragEnd",value:function(){this.state===Nb&&(this.tapsCount++,this.emit("tapping",this,this.gameObject,this.lastPointer),void 0!==this.maxTaps&&this.tapsCount===this.maxTaps&&(this.state=Ob))}},{key:"onDrag",value:function(){this.state!==ob&&this.pointer.getDistance()>this.dragThreshold&&(this.state=ob)}},{key:"preUpdate",value:function(t,e){if(this.isRunning&&this.enable&&this.state===Nb){var r=this.lastPointer;if(r.isDown)t-r.downTime>this.holdTime&&(this.state=ob);else t-r.upTime>this.tapInterval&&(void 0===this.minTaps||this.tapsCount>=this.minTaps?this.state=Ob:this.state=ob)}}},{key:"postUpdate",value:function(t,e){this.isRunning&&this.enable&&this.state===Ob&&(this.state=ob)}},{key:"isTapped",get:function(){return this.state===Ob}},{key:"setHoldTime",value:function(t){return this.holdTime=t,this}},{key:"setTapInterval",value:function(t){return this.tapInterval=t,this}},{key:"setDragThreshold",value:function(t){return this.dragThreshold=t,this}},{key:"setTapOffset",value:function(t){return this.tapOffset=t,this}},{key:"setMaxTaps",value:function(t){return this.maxTaps=t,this}},{key:"setMinTaps",value:function(t){return this.minTaps=t,this}},{key:"setTaps",value:function(t,e){return void 0===e&&(e=t),this.setMinTaps(t).setMaxTaps(e),this}}]),r}(),ob="IDLE",Nb="BEGIN",Ob="RECOGNIZED";function Nd(t){return(Nd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var nh=function(t){return null==t||""===t||0===t.length},Xo=function(t,r,o){var e=t;if(nh(r));else{var $;"string"==typeof r&&(r=r.split("."));for(var n=0,p=r.length;n<p;n++){var f;if(null==e[$=r[n]]||"object"!==Nd(e[$]))f=n===p-1?void 0===o?{}:o:{},e[$]=f;e=e[$]}}return e},Pb=function(t,r,o,e){if(void 0===e&&(e="."),"object"===Nd(t)){if(nh(r)){if(null==o)return;"object"===Nd(o)&&(t=o)}else{"string"==typeof r&&(r=r.split(e));var $=r.pop();Xo(t,r)[$]=o}return t}};var Yo=Phaser.GameObjects.GameObject,Rc=function(e){return e instanceof Yo};kb.register("tap",function(e,$){return Rc(e)||($=e,e=this.scene),new mh(e,$)}),Pb(window,"RexPlugins.Gestures.Tap",mh);function Zo(t){return(Zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oh(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _o(t,e,r){return e&&oh(t.prototype,e),r&&oh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ap(){return(ap="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var o=bp(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(arguments.length<3?t:r):n.value}}).apply(this,arguments)}function bp(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Sc(t)););return t}function cp(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dp(t,e)}function dp(t,e){return(dp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ep(t){var e=gp();return function(){var r,o=Sc(t);if(e){var n=Sc(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return fp(this,r)}}function fp(t,e){if(e&&("object"===Zo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ph(t)}function ph(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Sc(t){return(Sc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var qh=Phaser.Utils.Objects.GetValue,rh=function(t){cp(r,Qc);var e=ep(r);function r(t,o){var n;$o(this,r);var i=ph(n=e.call(this,t,o)),a={states:{IDLE:{enter:function(){i.x=0,i.y=0,i.worldX=0,i.worldY=0},exit:function(){var t=i.lastPointer;i.x=t.x,i.y=t.y,i.worldX=t.worldX,i.worldY=t.worldY}},BEGIN:{enter:function(){i.start()},exit:function(){i.stop()}},RECOGNIZED:{enter:function(){i.emit("pressstart",i,i.gameObject,i.lastPointer)},exit:function(){i.emit("pressend",i,i.gameObject,i.lastPointer)}}},init:function(){this.state=Tc},eventEmitter:!1};return n.setRecongizedStateObject(new mb(a)),n}return _o(r,[{key:"resetFromJSON",value:function(t){return ap(Sc(r.prototype),"resetFromJSON",this).call(this,t),this.setDragThreshold(qh(t,"threshold",9)),this.setHoldTime(qh(t,"time",251)),this}},{key:"onDragStart",value:function(){this.state=sh,0===this.holdTime&&(this.state=Od)}},{key:"onDragEnd",value:function(){this.state=Tc}},{key:"onDrag",value:function(){this.state!==Tc&&this.pointer.getDistance()>this.dragThreshold&&(this.state=Tc)}},{key:"preUpdate",value:function(t,e){this.isRunning&&this.enable&&this.state===sh&&t-this.pointer.downTime>=this.holdTime&&(this.state=Od)}},{key:"isPressed",get:function(){return this.state===Od}},{key:"setHoldTime",value:function(t){return this.holdTime=t,this}},{key:"setDragThreshold",value:function(t){return this.dragThreshold=t,this}}]),r}(),Tc="IDLE",sh="BEGIN",Od="RECOGNIZED";kb.register("press",function(e,r){return Rc(e)||(r=e,e=this.scene),new rh(e,r)}),Pb(window,"RexPlugins.Gestures.Press",rh);function hp(t){return(hp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ip(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function th(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function jp(t,e,r){return e&&th(t.prototype,e),r&&th(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function kp(){return(kp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var o=lp(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(arguments.length<3?t:r):n.value}}).apply(this,arguments)}function lp(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Uc(t)););return t}function mp(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&np(t,e)}function np(t,e){return(np=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function op(t){var e=qp();return function(){var r,o=Uc(t);if(e){var n=Uc(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return pp(this,r)}}function pp(t,e){if(e&&("object"===hp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return uh(t)}function uh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Uc(t){return(Uc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var rp=Phaser.Utils.Objects.GetValue,vh=function(t){mp(r,Qc);var e=op(r);function r(t,o){var n;ip(this,r);var a=uh(n=e.call(this,t,o)),i={states:{IDLE:{},BEGIN:{enter:function(){var t=a.pointer;a.startX=t.x,a.startY=t.y,a.startWorldX=t.worldX,a.startWorldY=t.worldY}},RECOGNIZED:{enter:function(){a.emit("panstart",a,a.gameObject,a.lastPointer)},exit:function(){var t=a.lastPointer;a.endX=t.x,a.endY=t.y,a.endWorldX=t.worldX,a.endWorldY=t.worldY,a.emit("panend",a,a.gameObject,a.lastPointer)}}},init:function(){this.state=wh},eventEmitter:!1};return n.setRecongizedStateObject(new mb(i)),n}return jp(r,[{key:"resetFromJSON",value:function(t){return kp(Uc(r.prototype),"resetFromJSON",this).call(this,t),this.setDragThreshold(rp(t,"threshold",10)),this}},{key:"onDragStart",value:function(){this.state=xh,0===this.dragThreshold&&(this.state=Vc)}},{key:"onDragEnd",value:function(){this.state=wh}},{key:"onDrag",value:function(){switch(this.state){case xh:this.pointer.getDistance()>=this.dragThreshold&&(this.state=Vc);break;case Vc:var t=this.pointer.position,e=this.pointer.prevPosition;this.dx=t.x-e.x,this.dy=t.y-e.y;var r=this.pointer;this.x=r.x,this.y=r.y,this.worldX=r.worldX,this.worldY=r.worldY,this.emit("pan",this,this.gameObject,this.lastPointer);}}},{key:"isPanned",get:function(){return this.state===Vc}},{key:"setDragThreshold",value:function(t){return this.dragThreshold=t,this}}]),r}(),wh="IDLE",xh="BEGIN",Vc="RECOGNIZED";kb.register("pan",function(e,$){return Rc(e)||($=e,e=this.scene),new vh(e,$)}),Pb(window,"RexPlugins.Gestures.Pan",vh);function sp(t){return(sp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yh(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function up(t,e,r){return e&&yh(t.prototype,e),r&&yh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vp(){return(vp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var o=wp(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(arguments.length<3?t:r):i.value}}).apply(this,arguments)}function wp(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Wc(t)););return t}function xp(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yp(t,e)}function yp(t,e){return(yp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function zp(t){var e=Bp();return function(){var r,o=Wc(t);if(e){var i=Wc(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return Ap(this,r)}}function Ap(t,e){if(e&&("object"===sp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return zh(t)}function zh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Wc(t){return(Wc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Cp=Phaser.Math.Distance.Between,Dp=Phaser.Math.Angle.Between,Ep={getDt:function(){return this.scene.sys.game.loop.delta},getVelocity:function(){var t=this.pointer.position,e=this.pointer.prevPosition;return Cp(e.x,e.y,t.x,t.y)/(.001*this.getDt())},getVelocityX:function(){var t=this.pointer.position,e=this.pointer.prevPosition;return Math.abs(t.x-e.x)/(.001*this.getDt())},getVelocityY:function(){var t=this.pointer.position,e=this.pointer.prevPosition;return Math.abs(t.y-e.y)/(.001*this.getDt())},getVelocityAngle:function(){var t=this.pointer.position,e=this.pointer.prevPosition;return Dp(e.x,e.y,t.x,t.y)}};var Fp={"up&down":0,"left&right":1,"4dir":2,"8dir":3};var Gp=function(t,e,r){switch(void 0===r?r={}:!0===r&&(r=Hp),r.left=!1,r.right=!1,r.up=!1,r.down=!1,t=(t+360)%360,e){case 0:t<180?r.down=!0:r.up=!0;break;case 1:t>90&&t<=270?r.left=!0:r.right=!0;break;case 2:t>45&&t<=135?r.down=!0:t>135&&t<=225?r.left=!0:t>225&&t<=315?r.up=!0:r.right=!0;break;case 3:t>22.5&&t<=67.5?(r.down=!0,r.right=!0):t>67.5&&t<=112.5?r.down=!0:t>112.5&&t<=157.5?(r.down=!0,r.left=!0):t>157.5&&t<=202.5?r.left=!0:t>202.5&&t<=247.5?(r.left=!0,r.up=!0):t>247.5&&t<=292.5?r.up=!0:t>292.5&&t<=337.5?(r.up=!0,r.right=!0):r.right=!0;}return r},Hp={};var Pd=Phaser.Utils.Objects.GetValue,Ip=Phaser.Math.RadToDeg,Qd=function(t){xp(r,Qc);var e=zp(r);function r(t,o){var i;tp(this,r);var n=zh(i=e.call(this,t,o)),a={states:{IDLE:{enter:function(){n.x=0,n.y=0,n.worldX=0,n.worldY=0},exit:function(){var t=n.lastPointer;n.x=t.x,n.y=t.y,n.worldX=t.worldX,n.worldY=t.worldY}},BEGIN:{enter:function(){n.validDrag=!1}},RECOGNIZED:{enter:function(){n.start(),n.updateDirectionStates(),n.emit("swipe",n,n.gameObject,n.lastPointer)},exit:function(){n.stop(),n.clearDirectionStates()}}},init:function(){this.state=Rd},eventEmitter:!1};return i.setRecongizedStateObject(new mb(a)),i.clearDirectionStates(),i}return up(r,[{key:"resetFromJSON",value:function(t){return vp(Wc(r.prototype),"resetFromJSON",this).call(this,t),this.setDragThreshold(Pd(t,"threshold",10)),this.setVelocityThreshold(Pd(t,"velocityThreshold",1e3)),this.setDirectionMode(Pd(t,"dir","8dir")),this}},{key:"onDragStart",value:function(){this.state=Ah}},{key:"onDragEnd",value:function(){this.state=Rd}},{key:"onDrag",value:function(){this.state===Ah&&(this.validDrag||(this.validDrag=0===this.dragThreshold||this.pointer.getDistance()>=this.dragThreshold),this.validDrag&&this.dragVelocity>this.velocityThreshold&&(this.state=Sd))}},{key:"postUpdate",value:function(t,e){this.isRunning&&this.enable&&this.state===Sd&&(this.state=Rd)}},{key:"isSwiped",get:function(){return this.state===Sd}},{key:"dragVelocity",get:function(){var t;switch(this.dirMode){case 0:t=this.getVelocityY();break;case 1:t=this.getVelocityX();break;default:t=this.getVelocity();}return t}},{key:"setDragThreshold",value:function(t){return this.dragThreshold=t,this}},{key:"setVelocityThreshold",value:function(t){return this.velocityThreshold=t,this}},{key:"setDirectionMode",value:function(t){return"string"==typeof t&&(t=Fp[t]),this.dirMode=t,this}},{key:"updateDirectionStates",value:function(){var t=Ip(this.getVelocityAngle());return Gp(t,this.dirMode,this),this}},{key:"clearDirectionStates",value:function(){return this.left=!1,this.right=!1,this.up=!1,this.down=!1,this}}]),r}();Object.assign(Qd.prototype,Ep);var Rd="IDLE",Ah="BEGIN",Sd="RECOGNIZED";kb.register("swipe",function(e,$){return Rc(e)||($=e,e=this.scene),new Qd(e,$)}),Pb(window,"RexPlugins.Gestures.Swipe",Qd);function Jp(t){return(Jp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bh(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function Lp(t,e,r){return e&&Bh(t.prototype,e),r&&Bh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Mp(){return(Mp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var a=Np(t,e);if(a){var n=Object.getOwnPropertyDescriptor(a,e);return n.get?n.get.call(arguments.length<3?t:r):n.value}}).apply(this,arguments)}function Np(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xc(t)););return t}function Op(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pp(t,e)}function Pp(t,e){return(Pp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Qp(t){var e=Sp();return function(){var r,a=Xc(t);if(e){var n=Xc(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return Rp(this,r)}}function Rp(t,e){if(e&&("object"===Jp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ch(t)}function Ch(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Sp(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Xc(t){return(Xc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dh(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Up(t,e,i){return e&&Dh(t.prototype,e),i&&Dh(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}var Td=Phaser.Utils.Objects.GetValue,Vp=Phaser.Utils.Array.SpliceOne,Wp=Phaser.Math.Distance.Between,Xp=Phaser.Math.Angle.Between,Ud=function(){function t(e,i){Tp(this,t);var n=e.input.manager.pointersTotal-1;n<2&&e.input.addPointer(2-n),this.scene=e,this.setEventEmitter(Td(i,"eventEmitter",void 0)),this._enable=void 0,this.pointers=[],this.movedState={},this.resetFromJSON(i),this.boot()}return Up(t,[{key:"resetFromJSON",value:function(t){return this.setEnable(Td(t,"enable",!0)),this.bounds=Td(t,"bounds",void 0),this.tracerState=Yc,this.pointers.length=0,Gb(this.movedState),this}},{key:"boot",value:function(){this.scene.input.on("pointerdown",this.onPointerDown,this),this.scene.input.on("pointerup",this.onPointerUp,this),this.scene.input.on("gameout",this.dragCancel,this),this.scene.input.on("pointermove",this.onPointerMove,this),this.scene.sys.events.once("shutdown",this.destroy,this)}},{key:"shutdown",value:function(){this.scene&&(this.destroyEventEmitter(),this.pointers.length=0,Gb(this.movedState),this.scene.input.off("pointerdown",this.onPointerDown,this),this.scene.input.off("pointerup",this.onPointerUp,this),this.scene.input.off("gameout",this.dragCancel,this),this.scene.input.off("pointermove",this.onPointerMove,this),this.scene.sys.events.off("shutdown",this.destroy,this),this.scene=void 0)}},{key:"destroy",value:function(){this.shutdown()}},{key:"enable",get:function(){return this._enable},set:function(t){if(this._enable!==t)return t||this.dragCancel(),this._enable=t,this}},{key:"setEnable",value:function(t){return void 0===t&&(t=!0),this.enable=t,this}},{key:"toggleEnable",value:function(){return this.setEnable(!this.enable),this}},{key:"onPointerDown",value:function(t){if(this.enable&&2!==this.pointers.length&&(!this.bounds||this.bounds.contains(t.x,t.y))&&-1===this.pointers.indexOf(t))switch(this.movedState[t.id]=!1,this.pointers.push(t),this.tracerState){case Yc:this.tracerState=lc,this.onDrag1Start();break;case lc:this.tracerState=Oa,this.onDrag2Start();}}},{key:"onPointerUp",value:function(t){if(this.enable&&(!this.bounds||this.bounds.contains(t.x,t.y))){var e=this.pointers.indexOf(t);if(-1!==e)switch(delete this.movedState[t.id],Vp(this.pointers,e),this.tracerState){case lc:this.tracerState=Yc,this.onDrag1End();break;case Oa:this.tracerState=lc,this.onDrag2End(),this.onDrag1Start();}}}},{key:"onPointerMove",value:function(t){if(this.enable&&t.isDown){var e=!this.bounds||this.bounds.contains(t.x,t.y),i=-1!==this.pointers.indexOf(t);if(!i&&e);else if(i&&!e)this.onPointerUp(t);else if(this.movedState[t.id]||(this.movedState[t.id]=t.x!==t.downX||t.y!==t.downY),this.movedState[t.id])switch(this.tracerState){case lc:this.onDrag1();break;case Oa:this.onDrag2();}}}},{key:"dragCancel",value:function(){return this.tracerState===Oa&&this.onDrag2End(),this.pointers.length=0,Gb(this.movedState),this.tracerState=Yc,this}},{key:"onDrag1Start",value:function(){this.emit("drag1start",this)}},{key:"onDrag1End",value:function(){this.emit("drag1end",this)}},{key:"onDrag1",value:function(){this.emit("drag1",this)}},{key:"onDrag2Start",value:function(){this.emit("drag2start",this)}},{key:"onDrag2End",value:function(){this.emit("drag2end",this)}},{key:"onDrag2",value:function(){this.emit("drag2",this)}},{key:"distanceBetween",get:function(){if(this.tracerState!==Oa)return 0;var t=this.pointers[0],e=this.pointers[1];return Wp(t.x,t.y,e.x,e.y)}},{key:"angleBetween",get:function(){if(this.tracerState!==Oa)return 0;var t=this.pointers[0],e=this.pointers[1];return Xp(t.x,t.y,e.x,e.y)}},{key:"drag1Vector",get:function(){var t=this.pointers[0];if(t&&this.movedState[t.id]){var e=t.position,i=t.prevPosition;kc.x=e.x-i.x,kc.y=e.y-i.y}else kc.x=0,kc.y=0;return kc}},{key:"centerX",get:function(){if(this.tracerState!==Oa)return 0;var t=this.pointers[0].position,e=this.pointers[1].position;return(t.x+e.x)/2}},{key:"centerY",get:function(){if(this.tracerState!==Oa)return 0;var t=this.pointers[0].position,e=this.pointers[1].position;return(t.y+e.y)/2}},{key:"prevCenterX",get:function(){if(this.tracerState!==Oa)return 0;var t=this.movedState[this.pointers[0].id]?this.pointers[0].prevPosition:this.pointers[0].position,e=this.movedState[this.pointers[1].id]?this.pointers[1].prevPosition:this.pointers[1].position;return(t.x+e.x)/2}},{key:"prevCenterY",get:function(){if(this.tracerState!==Oa)return 0;var t=this.movedState[this.pointers[0].id]?this.pointers[0].prevPosition:this.pointers[0].position,e=this.movedState[this.pointers[1].id]?this.pointers[1].prevPosition:this.pointers[1].position;return(t.y+e.y)/2}},{key:"movementCenterX",get:function(){return this.centerX-this.prevCenterX}},{key:"movementCenterY",get:function(){return this.centerY-this.prevCenterY}},{key:"setRecongizedStateObject",value:function(t){return this.recongizedState=t,this}},{key:"state",get:function(){return this.recongizedState.state},set:function(t){this.recongizedState.state=t}},{key:"cancel",value:function(){return this.state=Yp,this}}]),t}();Object.assign(Ud.prototype,Ac);var kc={},Yc=0,lc=1,Oa=2,Yp="IDLE";var Zp=Phaser.Utils.Objects.GetValue,Eh=function(t){Op(r,Ud);var e=Qp(r);function r(t,a){var n;Kp(this,r);var o=Ch(n=e.call(this,t,a)),i={states:{IDLE:{enter:function(){o.prevDistance=void 0,o.scaleFactor=1}},BEGIN:{},RECOGNIZED:{enter:function(){o.emit("pinchstart",o)},exit:function(){o.emit("pinchend",o)}}},init:function(){this.state=Fh},eventEmitter:!1};return n.setRecongizedStateObject(new mb(i)),n}return Lp(r,[{key:"resetFromJSON",value:function(t){return Mp(Xc(r.prototype),"resetFromJSON",this).call(this,t),this.setDragThreshold(Zp(t,"threshold",0)),this}},{key:"onDrag2Start",value:function(){this.scaleFactor=1,this.prevDistance=this.distanceBetween,this.state=Gh,0===this.dragThreshold&&(this.state=Zc)}},{key:"onDrag2End",value:function(){this.state=Fh}},{key:"onDrag2",value:function(){switch(this.state){case Gh:if(this.pointers[0].getDistance()>=this.dragThreshold&&this.pointers[1].getDistance()>=this.dragThreshold){var t=this.distanceBetween;this.scaleFactor=t/this.prevDistance,this.prevDistance=t,this.state=Zc}break;case Zc:t=this.distanceBetween;this.scaleFactor=t/this.prevDistance,this.emit("pinch",this),this.prevDistance=t;}}},{key:"isPinched",get:function(){return this.state===Zc}},{key:"setDragThreshold",value:function(t){return this.dragThreshold=t,this}}]),r}(),Fh="IDLE",Gh="BEGIN",Zc="RECOGNIZED";kb.register("pinch",function(e){return new Eh(this.scene,e)}),Pb(window,"RexPlugins.Gestures.Pinch",Eh);function $p(e){return($p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hh(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function aq(e,t,r){return t&&Hh(e.prototype,t),r&&Hh(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bq(){return(bq="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=cq(e,t);if(o){var n=Object.getOwnPropertyDescriptor(o,t);return n.get?n.get.call(arguments.length<3?e:r):n.value}}).apply(this,arguments)}function cq(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$c(e)););return e}function dq(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eq(e,t)}function eq(e,t){return(eq=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function fq(e){var t=hq();return function(){var r,o=$c(e);if(t){var n=$c(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return gq(this,r)}}function gq(e,t){if(t&&("object"===$p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ih(e)}function Ih(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hq(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function $c(e){return($c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var iq=Phaser.Math.RotateAround,Jh=function(t,r,$,o){return iq(t,r,$,o),t.rotation+=o,t};var jq=function($,t,o,r){return void 0===r?r={}:!0===r&&(r=kq),o.getWorldPoint($,t,r),r},kq={};var lq=function(r,t){if(!this.isRotation)return this;void 0===t&&(t=this.pointers[0].camera);var e=this.movementCenterX,o=this.movementCenterY,i=jq(this.centerX,this.centerY,t,!0),$=i.x,n=i.y,s=this.rotation;if(Array.isArray(r))for(var a=r,u=0,R=a.length;u<R;u++)(r=a[u]).x+=e,r.y+=o,Jh(r,$,n,s);else r.x+=e,r.y+=o,Jh(r,$,n,s);return this};var mq=Phaser.Utils.Objects.GetValue,Vd=Phaser.Math.Angle.WrapDegrees,Kh=Phaser.Math.Angle.ShortestBetween,Wd=Phaser.Math.RadToDeg,nq=Phaser.Math.DegToRad,Xd=function(e){dq(r,Ud);var t=fq(r);function r(e,o){var n;_p(this,r);var $=Ih(n=t.call(this,e,o)),a={states:{IDLE:{enter:function(){$.prevAngle=void 0,$.angle=0}},BEGIN:{},RECOGNIZED:{enter:function(){$.emit("rotatestart",$)},exit:function(){$.emit("rotateend",$)}}},init:function(){this.state=Lh},eventEmitter:!1};return n.setRecongizedStateObject(new mb(a)),n}return aq(r,[{key:"resetFromJSON",value:function(e){return bq($c(r.prototype),"resetFromJSON",this).call(this,e),this.setDragThreshold(mq(e,"threshold",0)),this}},{key:"onDrag2Start",value:function(){this.prevAngle=Vd(Wd(this.angleBetween)),this.state=Mh,0===this.dragThreshold&&(this.state=_c)}},{key:"onDrag2End",value:function(){this.state=Lh}},{key:"onDrag2",value:function(){switch(this.state){case Mh:if(this.pointers[0].getDistance()>=this.dragThreshold&&this.pointers[1].getDistance()>=this.dragThreshold){var e=Vd(Wd(this.angleBetween));this.angle=Kh(this.prevAngle,e),this.prevAngle=e,this.state=_c}break;case _c:e=Vd(Wd(this.angleBetween));this.angle=Kh(this.prevAngle,e),this.prevAngle=e,this.emit("rotate",this);}}},{key:"isRotated",get:function(){return this.state===_c}},{key:"rotation",get:function(){return nq(this.angle)}},{key:"setDragThreshold",value:function(e){return this.dragThreshold=e,this}}]),r}(),oq={spinObject:lq};Object.assign(Xd.prototype,oq);var Lh="IDLE",Mh="BEGIN",_c="RECOGNIZED";kb.register("rotate",function(t){return new Xd(this.scene,t)}),Pb(window,"RexPlugins.Gestures.Rotate",Xd);var pq=function(e){ro(r,Phaser.Plugins.ScenePlugin);var t=to(r);function r(e,o){var a;return qo(this,r),(a=t.call(this,e,o)).add=new kb(e),a}return po(r)}();function qq(r){return(qq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function rq(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Nh(r,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}function sq(r,t,e){return t&&Nh(r.prototype,t),e&&Nh(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function tq(r,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&uq(r,t)}function uq(r,t){return(uq=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,t){return r.__proto__=t,r})(r,t)}function vq(r){var t=yq();return function(){var e,o=Oh(r);if(t){var n=Oh(this).constructor;e=Reflect.construct(o,arguments,n)}else e=o.apply(this,arguments);return wq(this,e)}}function wq(r,t){if(t&&("object"===qq(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return xq(r)}function xq(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function yq(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(r){return!1}}function Oh(r){return(Oh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)})(r)}var zq=function(r){tq(e,Phaser.Plugins.BasePlugin);var t=vq(e);function e(r){return rq(this,e),t.call(this,r)}return sq(e,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"add",value:function(r,t){return new $k(r,t)}}]),e}();function Aq(t){return(Aq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bq(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ph(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Cq(t,e,r){return e&&Ph(t.prototype,e),r&&Ph(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Dq(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Eq(t,e)}function Eq(t,e){return(Eq=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Fq(t){var e=Iq();return function(){var r,o=Qh(t);if(e){var n=Qh(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return Gq(this,r)}}function Gq(t,e){if(e&&("object"===Aq(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Hq(t)}function Hq(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Iq(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Qh(t){return(Qh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jq(e){return(Jq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rh(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Lq(e,t,r){return t&&Rh(e.prototype,t),r&&Rh(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mq(){return(Mq="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var a=Nq(e,t);if(a){var s=Object.getOwnPropertyDescriptor(a,t);return s.get?s.get.call(arguments.length<3?e:r):s.value}}).apply(this,arguments)}function Nq(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ad(e)););return e}function Oq(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pq(e,t)}function Pq(e,t){return(Pq=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Qq(e){var t=Tq();return function(){var r,a=ad(e);if(t){var s=ad(this).constructor;r=Reflect.construct(a,arguments,s)}else r=a.apply(this,arguments);return Rq(this,r)}}function Rq(e,t){if(t&&("object"===Jq(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Sq(e)}function Sq(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tq(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function ad(e){return(ad=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Uq=Math.PI/180,Sh=function($){return $*Uq};var Vq=180/Math.PI,Wq=function($){return $*Vq};var Za=Phaser.Utils.Objects.GetValue,Th=Phaser.Math.Wrap,Xq=Phaser.Math.Angle.Wrap,Yq=Phaser.Math.Angle.Between,Zq=function(e){Oq(r,Bc);var t=Qq(r);function r(e,a){var s;return Kq(this,r),(s=t.call(this,e,a)).resetFromJSON(a),s.boot(),s}return Lq(r,[{key:"resetFromJSON",value:function(e){return this.isRunning=Za(e,"isRunning",!1),this.setEnable(Za(e,"enable",!0)),this.timeScale=Za(e,"timeScale",1),this.setSpeed(Za(e,"speed",180)),this.target=Za(e,"target",0),this.dir=Za(e,"dir",0),this}},{key:"toJSON",value:function(){return{isRunning:this.isRunning,timeScale:this.timeScale,speed:this.speed,target:this.target,dir:this.dir,tickingMode:this.tickingMode}}},{key:"setEnable",value:function(e){return null==e&&(e=!0),this.enable=e,this}},{key:"setSpeed",value:function(e){return this.speed=e,this}},{key:"rotateTo",value:function(e,t,a){if("number"!=typeof e){var s=e;e=Za(s,"angle",void 0),t=Za(s,"dir",void 0)}return this.target=Th(e,0,360),void 0===t&&(t=0),this.dir="string"==typeof t?$q[t]:t,void 0!==a&&this.setSpeed(a),Mq(ad(r.prototype),"start",this).call(this),this}},{key:"rotateTowardsPosition",value:function(e,t,r,a){var s=this.parent,n=Yq(s.x,s.y,e,t),o=Wq(n);return this.rotateTo(o,r,a),this}},{key:"update",value:function(e,t){if(!this.isRunning||!this.enable)return this;var r=this.parent;if(!r.active)return this;var a=this.target;if(Xq(Sh(a))===r.rotation)return this.complete(),this;if(0===this.speed||0===t||0===this.timeScale)return this;var s,n,o=(360+r.angle)%360,i=t*this.timeScale/1e3,$=this.speed*i,v=this.dir;switch(v){case 0:var u=Yd(o,a,!0),c=360-u;u<c?(v=1,s=u):(v=2,s=c);break;case 1:s=Yd(o,a,!0);break;case 2:s=Yd(o,a,!1);}return n=$<s?1===v?o+$:o-$:a,r.rotation=Sh(n),this}}]),r}(),Yd=function(e,t,r){var a=r?t-e:e-t;return a=Th(a,0,360)},$q={shortest:0,cw:1,ccw:2};var _q=function(t){Dq(r,Phaser.Plugins.BasePlugin);var e=Fq(r);function r(t){return Bq(this,r),e.call(this,t)}return Cq(r,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"add",value:function(t,e){return new Zq(t,e)}}]),r}();function Uh(e,a){for(var t=0;t<a.length;t++){var r=a[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vh(e,a,t){return a&&Uh(e.prototype,a),t&&Uh(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wh(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}var ar=Vh(function e(){Wh(this,e),this._entitiesToDisposeOfArray=[],this._delayed=[]}),Pa=new ar,Xh=function(){function e(){Wh(this,e)}return Vh(e,null,[{key:"update",value:function(e,a){if(Pa._delayed.length>0)for(var t=Pa._delayed.length-1;t>=0;t--){var r=Pa._delayed[t];r.delay-=a,r.delay<=0&&(Pa._delayed.splice(Pa._delayed.indexOf(r),1),this.queueEntity(r.gameEntity))}if(Pa._entitiesToDisposeOfArray.length>0){var i=Pa._entitiesToDisposeOfArray;Pa._entitiesToDisposeOfArray=[];for(var n=i.length-1;n>=0;n--){i[n].dispose()}}}},{key:"queueEntity",value:function(e){console.assert(e,"MoonEngineEntityDisposeSystem::queueEntity-> param is: ",e),e&&(1!=e.disposed?Pa._entitiesToDisposeOfArray.indexOf(e)<0?(e.disposeQueued=!0,Pa._entitiesToDisposeOfArray.push(e)):console.warn("tried to destroy entity more than once!"):console.warn("tried to dispose entity that is already disposed of."))}}]),e}();function Yh(e,a){for(var t=0;t<a.length;t++){var o=a[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Zh(e,a,t){return a&&Yh(e.prototype,a),t&&Yh(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function $h(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}var Qb,br=Zh(function e(){$h(this,e),this.audioState=1,this.cachedSounds={},this.wasMutedAutomatically=!1,this.wasMutedManually=!1,this.musicStateKey=""}),oa=new br,wa=function(){function e(){$h(this,e)}return Zh(e,null,[{key:"PlayAudio",value:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;console.assert(e,"AudioModel::playAudio-> pAudioName is: ",e),Qb||(Qb={},ta(Qb,ia.GetJsonGameConfigHardCopy().audio)),Qb[e]||(Qb[e]={volume:1});var t=Qb[e];if(oa.cachedSounds[e])oa.cachedSounds[e].play();else{if(!ia.GetPhaserGame().cache.audio.exists(e))return void console.log("RETURNING, FAIL QUIETLY - NO AUDIO :",e);var o=sa.GetScene(Xb).sound.add(e,t);o.play(),oa.cachedSounds[e]=o}oa.cachedSounds[e].volume=null!=a?a:Qb[e].volume}},{key:"GetAudio",value:function(e){return oa.cachedSounds[e]?oa.cachedSounds[e]:null}},{key:"StopAudio",value:function(e){oa.cachedSounds[e]&&ia.GetPhaserGame().cache.audio.exists(e)&&oa.cachedSounds[e].stop()}},{key:"_DoMuteAudio",value:function(){console.log("AudioModel->muteAudio()"),oa.audioState=-1,sa.GetScene(Xb).sound.setMute(!0)}},{key:"_DoUnmuteAudio",value:function(){console.log("AudioModel->unmuteAudio()"),oa.audioState=1,sa.GetScene(Xb).sound.setMute(!1)}},{key:"MuteAudioManuallyByUser",value:function(){oa.wasMutedManually=!0,e.SaveAudioDisabled(),e._DoMuteAudio()}},{key:"UnmuteAudioManuallyByUser",value:function(){oa.wasMutedManually=!1,e.SaveAudioEnabled(),e._DoUnmuteAudio()}},{key:"TryToAutomaticallyMuteIfNotMutedManually",value:function(){oa.wasMutedManually||oa.wasMutedAutomatically||(oa.wasMutedAutomatically=!0,e._DoMuteAudio())}},{key:"TryAutomaticallyUnmuteIfWasMutedAlsoAutomatically",value:function(){oa.wasMutedManually||oa.wasMutedAutomatically&&(oa.wasMutedAutomatically=!1,e._DoUnmuteAudio())}},{key:"IsMuted",value:function(){return-1==oa.audioState}},{key:"GetAudioState",value:function(){return oa.audioState}},{key:"InterpretInitialAudioState",value:function(a){var t="MusicState_"+a;oa.musicStateKey=t;var o=localStorage.getItem(t);Tb.disableSavedAudioState&&(o="enabled"),"disabled"==o?e.MuteAudioManuallyByUser():"enabled"==o||(o="enabled"),localStorage.setItem(t,o)}},{key:"SaveAudioDisabled",value:function(){localStorage.setItem(oa.musicStateKey,"disabled")}},{key:"SaveAudioEnabled",value:function(){localStorage.setItem(oa.musicStateKey,"enabled")}}]),e}();function _h(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ai(t,e,a){return e&&_h(t.prototype,e),a&&_h(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function bi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var cr=ai(function t(){bi(this,t),this.trackedTaps={},this.trackedInputs=[{input:null,obj:null},{input:null,obj:null},{input:null,obj:null},{input:null,obj:null},{input:null,obj:null},{input:null,obj:null},{input:null,obj:null},{input:null,obj:null},{input:null,obj:null},{input:null,obj:null},{input:null,obj:null}],this.scene=null,this.globalPointerDownTime=0,this.swipe=null,this.keys={},this.cursorKeys=null,this.keyEvents={}}),aa=new cr,Rb=function(){function t(){bi(this,t)}return ai(t,null,[{key:"SetGameScene",value:function(t){aa.scene=t,aa.cursorKeys=t.input.keyboard.createCursorKeys(),aa.keys.w=t.input.keyboard.addKey("w"),aa.keys.s=t.input.keyboard.addKey("s"),aa.keys.a=t.input.keyboard.addKey("a"),aa.keys.d=t.input.keyboard.addKey("d"),aa.keys["/"]=t.input.keyboard.addKey("/"),aa.keys.right=t.input.keyboard.addKey("right"),aa.keys.left=t.input.keyboard.addKey("left"),aa.keys.up=t.input.keyboard.addKey("up"),aa.keys.down=t.input.keyboard.addKey("down"),t.input.keyboard.on("keydown",function(t){aa.keyEvents[t.key]&&aa.keyEvents[t.key](t)}),aa.trackedInputs[0].input=t.input.mousePointer,aa.trackedInputs[1].input=t.input.pointer1,aa.trackedInputs[2].input=t.input.pointer2,aa.trackedInputs[3].input=t.input.pointer3,aa.trackedInputs[4].input=t.input.pointer4,aa.trackedInputs[5].input=t.input.pointer5,aa.trackedInputs[6].input=t.input.pointer6,aa.trackedInputs[7].input=t.input.pointer7,aa.trackedInputs[8].input=t.input.pointer8,aa.trackedInputs[9].input=t.input.pointer9,aa.trackedInputs[10].input=t.input.pointer10}},{key:"AddSwipe",value:function(t){return aa.swipe&&aa.swipe.destroy(),aa.swipe=aa.scene.rexGestures.add.swipe({threshold:35,velocityThreshold:10,workaroundEnabled:1,workaroundMaxTime:1e3}),aa.swipe.on("swipe",t),aa.swipe}},{key:"DestroySwipe",value:function(){aa.swipe&&aa.swipe.destroy()}},{key:"AddTrackedButton",value:function(t,e){aa.trackedInputs[e].obj?console.warn("ALREADY TRACKING BUTTON AT ID: ",e):aa.trackedInputs[e].obj=t}},{key:"HasTrackedButton",value:function(){for(var t=0;t<aa.trackedInputs.length;t++)if(null!=aa.trackedInputs[t].obj)return!0;return!1}},{key:"NullifyTrackedButton",value:function(t,e){aa.trackedInputs[e].obj==t&&(aa.trackedInputs[e].obj=null)}},{key:"ResetTap",value:function(t){var e=!1;aa.scene.input.activePointer.isDown&&(e=!0),aa.trackedTaps[t]={tapped:!1,waitingOnUntap:e}}},{key:"GetTapState",value:function(t){return!Ba.GetGameRemix().isRotationScreenDisplayed()&&aa.trackedTaps[t].tapped}},{key:"SetPointerCount",value:function(t){aa.scene.input.addPointer(t),aa.trackedInputs[0].input=aa.scene.input.mousePointer,aa.trackedInputs[1].input=aa.scene.input.pointer1,aa.trackedInputs[2].input=aa.scene.input.pointer2,aa.trackedInputs[3].input=aa.scene.input.pointer3,aa.trackedInputs[4].input=aa.scene.input.pointer4,aa.trackedInputs[5].input=aa.scene.input.pointer5,aa.trackedInputs[6].input=aa.scene.input.pointer6,aa.trackedInputs[7].input=aa.scene.input.pointer7,aa.trackedInputs[8].input=aa.scene.input.pointer8,aa.trackedInputs[9].input=aa.scene.input.pointer9,aa.trackedInputs[10].input=aa.scene.input.pointer10}},{key:"GetPointerCount",value:function(){console.log(aa.scene.input)}},{key:"Update",value:function(t,e){var a=aa.scene.input.activePointer.isDown;for(var n in aa.trackedTaps){var $=aa.trackedTaps[n];$.waitingOnUntap?a||($.waitingOnUntap=!1):$.tapped=a}for(var r=0;r<aa.trackedInputs.length;r++){var u=aa.trackedInputs[r].input;u&&!u.isDown&&aa.trackedInputs[r].obj&&dd.ResetTracking(aa.trackedInputs[r].obj)}a?aa.globalPointerDownTime+=e:aa.globalPointerDownTime=0}},{key:"IsGlobalPointerDownMoreThanAFrame",value:function(){return aa.globalPointerDownTime>50}},{key:"IsInputActive",value:function(){return!Ba.GetGameRemix().isRotationScreenDisplayed()||null}},{key:"GetPointer",value:function(){return aa.scene.input.activePointer}},{key:"GetPointerIfNotPressingButton",value:function(){return 0==t.HasTrackedButton()?aa.scene.input.activePointer:null}},{key:"GetPointerIfNotPressingButtonAndDown",value:function(){return 0==t.HasTrackedButton()&&aa.scene.input.activePointer.isDown?aa.scene.input.activePointer:null}},{key:"IsPointerDown",value:function(){return aa.scene.input.activePointer.isDown}},{key:"IsKeyFromListDown",value:function(t){for(var e=0;e<t.length;e++){if(aa.keys[t[e]].isDown)return!0}return!1}},{key:"AddKeyDown",value:function(t,e){if(Array.isArray(t))for(var a=0;a<t.length;a++){var n=t[a];aa.keyEvents[n]=e}else aa.keyEvents[t]=e}},{key:"DebugInteractive",value:function(t){aa.scene.input.enableDebug(t.displayed)}}]),t}();function ci(e,a){for(var t=0;t<a.length;t++){var o=a[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function di(e,a,t){return a&&ci(e.prototype,a),t&&ci(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ei(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}var dr=di(function e(){ei(this,e),this.ownedSpines={},this.ownedAudio={},this.ownedPng={},this.ownedJpg={},this.ownedBitmapFont={},this.ownedVideo={},this.ownedText={},this.ownedJSONs={}}),za=new dr,Ha=function(){function e(){ei(this,e)}return di(e,[{key:"unpackBundle",value:function(e,a){for(var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=0;o<a.length;o++){var r=a[o];if(e.load.setPath(t+r.path),"image"==r.type&&this.addTextureDict(r.assets,e),"spine"==r.type)for(var i in r.assets){var n=r.assets[i];za.ownedSpines[n]?console.warn("overrided asset: ",n):(za.ownedSpines[n]=!0,e.load.spine(n,n+".json",n+".atlas"))}if("audio"==r.type&&this.addAudioDict(r.assets,e),"font"==r.type&&this.addBitmapFontDict(r.assets,e),"image_jpg"==r.type&&this.addTextureJpgDict(r.assets,e),"text"==r.type&&this.addTextDict(r.assets,e),"multiatlas"==r.type)for(var s in r.assets){var v=r.assets[s];e.load.multiatlas("megaset",v+".json")}if("json"==r.type)for(var d in r.assets){var $=r.assets[d];za.ownedJSONs[$]?console.warn("overrided asset: ",$):(za.ownedJSONs[$]=!0,e.load.json($,$+".json"))}}}},{key:"addAudio",value:function(e,a){if(za.ownedAudio[e])console.warn("overrided asset: ",e);else{za.ownedAudio[e]=!0;var t=e;a.load.audio(e,[t+".mp3",t+".ogg"])}}},{key:"addPNG",value:function(e,a){za.ownedPng[e]?console.warn("overrided asset: ",e):(za.ownedPng[e]=!0,a.load.image(e,e+".png"))}},{key:"addJPG",value:function(e,a){za.ownedJpg[e]?console.warn("overrided asset: ",e):(za.ownedJpg[e]=!0,a.load.image(e,e+".jpg"))}},{key:"addBitmapFont",value:function(e,a){za.ownedBitmapFont[e]?console.warn("overrided asset: ",e):(za.ownedBitmapFont[e]=!0,a.load.bitmapFont(e,e+".png",e+".xml"))}},{key:"addText",value:function(e,a){za.ownedText[e]?console.warn("overrided asset: ",e):(za.ownedVideo[e]=!0,a.load.text(e,e+".txt"))}},{key:"addVideo",value:function(e,a){za.ownedVideo[e]?console.warn("overrided asset: ",e):(za.ownedVideo[e]=!0,a.load.video(e,e+".mp4","loadeddata",!1,!0))}},{key:"addAudioDict",value:function(e,a){for(var t in e)this.addAudio(e[t],a)}},{key:"addTextureDict",value:function(e,a){for(var t in e){var o=e[t];this.addPNG(o,a)}}},{key:"addTextureJpgDict",value:function(e,a){for(var t in e)this.addJPG(e[t],a)}},{key:"addBitmapFontDict",value:function(e,a){for(var t in e)this.addBitmapFont(e[t],a)}},{key:"addTextDict",value:function(e,a){for(var t in e)this.addText(e[t],a)}}],[{key:"GetFileFromCache",value:function(e,a){return ia.GetPhaserGame().cache[e].get(a)}},{key:"GetAssetBundle",value:function(e){var a=[];for(var t in e){var o={type:t,path:e[t].path,assets:[]};for(var r in null!=e[t].jpgDict&&(o.jpgDict=e[t].jpgDict),e[t].assetDict)o.assets.push(e[t].assetDict[r]);a.push(o)}return a}}]),e}();function er(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function fi(e,a){for(var r=0;r<a.length;r++){var s=a[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function fr(e,a,r){return a&&fi(e.prototype,a),r&&fi(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var gi=function(){function e(){er(this,e)}return fr(e,null,[{key:"InjectIntoActor",value:function(e,a,r,s){e.vals.progress={},e.vals.progress.maxValue=a,e.vals.progress.curValue=a,e.vals.progress.axisHorizontal=r,e.vals.progress.axisVertical=s}},{key:"SetMaxValue",value:function(a,r,s){a.vals.progress.maxValue=r,s&&e.SetCurValueToMax(a)}},{key:"SetCurValueToMax",value:function(e){e.vals.progress.curValue=e.vals.progress.maxValue}},{key:"IsScaledtoZero",value:function(e){return e.vals.progress.curValue<=0}},{key:"GetCurValue",value:function(e){return e.vals.progress.curValue}},{key:"AddToCurValueAndUpdateVisual",value:function(a,r){a.vals.progress.curValue+=r,a.vals.progress.curValue>a.vals.progress.maxValue&&(a.vals.progress.curValue=a.vals.progress.maxValue),e._UpdateVisual(a)}},{key:"_UpdateVisual",value:function(e){var a=e.vals.progress.curValue/e.vals.progress.maxValue;e.vals.progress.axisHorizontal&&ba.SetScaleX(e,a),e.vals.progress.axisVertical&&ba.SetScaleY(e,a)}},{key:"SubstractFromCurValueAndUpdateVisual",value:function(a,r){a.vals.progress.curValue-=r,a.vals.progress.curValue<=0&&(a.vals.progress.curValue=0),e._UpdateVisual(a)}},{key:"Bake",value:function(e){}},{key:"PostBake",value:function(e){}},{key:"Name",get:function(){return"ProgressComponent"}},{key:"Cleanup",value:function(e){}}]),e}();function gr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hi(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function hr(e,t,a){return t&&hi(e.prototype,t),a&&hi(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}var ii="tileTransform",ir="TileComponent";var ji=function(){function e(){gr(this,e)}return hr(e,null,[{key:"InjectIntoActor",value:function(e,t,a){e.vals.tile={},e.vals.tile.tx=t,e.vals.tile.ty=a,e.vals.tile.tOffX=0,e.vals.tile.tOffY=0,e.vals.tile.layer=0}},{key:"SetLayer",value:function(e,t){e.vals.tile.layer=t}},{key:"GetLayer",value:function(e){return e.vals.tile.layer}},{key:"SetOffset",value:function(e,t,a){e.vals.tile.tOffX=t,e.vals.tile.tOffY=a}},{key:"GetOffsetX",value:function(e){return e.vals.tile.tOffX}},{key:"GetOffsetY",value:function(e){return e.vals.tile.tOffY}},{key:"GetX",value:function(e){return e.vals.tile.tx}},{key:"GetY",value:function(e){return e.vals.tile.ty}},{key:"SetXY",value:function(e,t,a){e.vals.tile.tx=t,e.vals.tile.ty=a}},{key:"Bake",value:function(e){}},{key:"PostBake",value:function(e){}},{key:"Cleanup",value:function(e){}},{key:"Name",get:function(){return ir}},{key:"SetEnabled",value:function(e,t){e.vals[ii].enabled=t}},{key:"IsEnabled",value:function(e){return e.vals[ii].enabled}}]),e}();function jr(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function ki(e,n){for(var a=0;a<n.length;a++){var o=n[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function kr(e,n,a){return n&&ki(e.prototype,n),a&&ki(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}var li=function(){function e(){jr(this,e)}return kr(e,null,[{key:"InjectIntoActor",value:function(e,n,a,o){e.vals.zone={},e.vals.zone.layer=n,e.vals.zone.sublayer=0,e.vals.zone.width=a,e.vals.zone.height=o,e.vals.visualBase=e.vals.zone}},{key:"Bake",value:function(e){var n=ba.InBakeGetSceneFromLayerCfg(e).make.zone({x:0,y:0,width:e.vals.zone.width,height:e.vals.zone.height,add:!1},!1);ba.InBakeAddDisplayedAndSetSelfRef(e,n)}},{key:"PostBake",value:function(e){}},{key:"Name",get:function(){return"ZoneComponent"}},{key:"Cleanup",value:function(e){}}]),e}();function lr(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function mi(e,a){for(var r=0;r<a.length;r++){var s=a[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function mr(e,a,r){return a&&mi(e.prototype,a),r&&mi(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var bd=function(){function e(){lr(this,e),this.sceneName=null,this.scene=null,this._cameraPosX=null,this._cameraPosY=null,this._sublayersDict=null}return mr(e,[{key:"onResize",value:function(){for(var e in this._sublayersDict){var a=this._sublayersDict[e],r=a.displayedLite,s=a.anchorAxisX,t=a.anchorAxisY;console.assert(r),console.assert(s,"DisplaySystem->_updateLayerPosition:: anchorAxisX isn't set"),console.assert(t,"DisplaySystem->_updateLayerPosition:: anchorAxisY isn't set"),ka.MutateSublayerByScaleManager(r,s,t)}}},{key:"_createSublayer",value:function(e,a,r){var s=r,t=a+"_"+s,i=this.scene.make.container({},!1);this.scene.add.existing(i),i.setDepth(e.workaroundDepth+s*fl),this._sublayersDict[t]={baseName:e.name,nameWithQualifierAndDepth:t,displayedLite:i,anchorAxisX:e.anchorAxisX,anchorAxisY:e.anchorAxisY},this.onResize()}},{key:"getOrCreateContainerLiteLayer",value:function(e,a){console.assert(e,"SceneDisplayObject->getLayer:: Layer is undefined"),console.assert(e.layerName,"SceneDisplayObject->getLayer:: Layer name is not set"),console.assert(e.anchorAxisX,"SceneDisplayObject->getLayer:: Layer anchorAxisX is not set or is illegaly equal to zero"),console.assert(e.anchorAxisY,"SceneDisplayObject->getLayer:: Layer anchorAxisY is not set or is illegaly equal to zero"),void 0===a&&(a=0);var r=e.layerName+"_"+e.anchorAxisX+e.anchorAxisY,s=r+"_"+a;this._sublayersDict[s]||this._createSublayer(e,r,a);var t=this._sublayersDict[s].displayedLite;return console.assert(t,"DisplaySystem->getLayer:: returned layer is null. Layer data or name: ",e),t}},{key:"setCameraPosX",value:function(e){this._cameraPosX=e,this.scene.cameras.main.scrollX=this._cameraPosX}}],[{key:"GetNewObject",value:function(a){var r=new e;return r.sceneName=a,r.scene=sa.GetScene(a),r._cameraPosX=0,r._cameraPosY=0,r._sublayersDict={},r}}]),e}();function nr(e){return(nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ni(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function or(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pr(e,t)}function pr(e,t){return(pr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function qr(e){var t=tr();return function(){var r,o=oi(e);if(t){var n=oi(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return rr(this,r)}}function rr(e,t){if(t&&("object"===nr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return sr(e)}function sr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function oi(e){return(oi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pi(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function qi(e,t,r){return t&&pi(e.prototype,t),r&&pi(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ri(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ur(e){return(ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vr(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function si(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function wr(e,r,t){return r&&si(e.prototype,r),t&&si(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function xr(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&yr(e,r)}function yr(e,r){return(yr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e})(e,r)}function zr(e){var r=Cr();return function(){var t,a=ti(e);if(r){var o=ti(this).constructor;t=Reflect.construct(a,arguments,o)}else t=a.apply(this,arguments);return Ar(this,t)}}function Ar(e,r){if(r&&("object"===ur(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return Br(e)}function Br(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function ti(e){return(ti=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cd=0,ui=0,Sb=6e3,vi=null,Dr=0,Er=!1,wi=!1,Fr=setInterval(function(){1==ui&&((cd+=25)>=Sb&&(cd=Sb),vi&&vi(Dr))},25),Gr=function(e){xr(t,Phaser.Scene);var r=zr(t);function t(){return vr(this,t),r.apply(this,arguments)}return wr(t,[{key:"preload",value:function(){wi=Tb.disableFakeMusicPreload,this.fontX=0,this.m_layer_basic=this.make.container({},!0),this.m_layer_preloader22=this.make.container({},!1),this.m_layer_basic.add(this.m_layer_preloader22);this.imgLogo=this.make.image({x:0,y:-75,key:"PreloaderLogo",add:!0},!1),this.m_layer_preloader22.add(this.imgLogo),this.fontText=this.make.bitmapText({x:this.fontX,y:125,font:"preloaderfont",text:"0",size:!1,add:!0,align:1},!1),this.m_layer_preloader22.add(this.fontText),this.load.on("progress",this._updatePreload,this),this.load.on("complete",this._completePreload,this),this.load.on("filecomplete",this._onFileComplete,this),this.load.on("loaderror",this._onFileError,this);var e=[],r=Ha.GetFileFromCache("json","prefabs");if(r)for(var t in r){var a=r[t];a.image&&a.image.texture&&e.push(a.image.texture),a.sprite&&a.sprite.texture&&e.push(a.sprite.texture)}new Ha().unpackBundle(this,ia.GetJsonAssets().list,ia.GetAssetsPath()),this._resize(),this.startUpdatingPreloader=!0,this.ref_Resizef=this._onEventResize.bind(this),window.addEventListener("resize",this.ref_Resizef)}},{key:"_updatePreload",value:function(e){if(this.startUpdatingPreloader){var r=Math.ceil(100*e);Dr=r,r>=75&&0==ui&&(ui=1,vi=this._updatePercentage.bind(this))}this._updatePercentage(r)}},{key:"_updatePercentage",value:function(e){wi||(e=Math.ceil((e+Math.ceil(cd/Sb*100))/200*100)),this.fontText.text=e+"%",this.fontText.x=this.fontX+-this.fontText.width/2,this._resize()}},{key:"_completePreload",value:function(){}},{key:"_onFileComplete",value:function(e,r){console.assert(e),console.assert(r)}},{key:"_onFileError",value:function(e){console.log("gamepreloader-> error loading file config: ",e)}},{key:"create",value:function(){this.load.removeAllListeners(),window.removeEventListener("resize",this.ref_Resizef)}},{key:"exitPreloader",value:function(){Er=!0,clearInterval(Fr),vi=null,this.imgLogo.destroy(),this.fontText.destroy(),this.m_layer_basic.destroy(),this.m_layer_preloader22.destroy(),this.game.scene.stop("PreloaderScene"),ia.HandlePreloadersDone()}},{key:"update",value:function(e,r){Er||(this._updatePercentage(100),cd<Sb&&cd>=(Sb-=5*r)&&(cd=Sb),!0!==window.wait_on_o3h?(cd>=Sb&&this.exitPreloader(),wi&&(console.warn("===FAKE MUSIC LOAD DISABLED==="),this.exitPreloader())):void 0===globalThis.o3h&&0!=globalThis.o3h_real_mode||this.exitPreloader())}},{key:"_onEventResize",value:function(){this._resize()}},{key:"_resize",value:function(){this.m_layer_preloader22.x=ka.GetResponsiveWidth()/2,this.m_layer_preloader22.y=ka.GetResponsiveHeight()/2}}]),t}();var Hr=qi(function e(){ri(this,e),this.rawData=null,this.dynamicJson=[]}),mc=new Hr,xi=function(e){or(r,Phaser.Scene);var t=qr(r);function r(){return ri(this,r),t.apply(this,arguments)}return qi(r,[{key:"preload",value:function(){this.load.on("loaderror",function(e){console.log("initialpreloader-> error loading file config: ",e)},this),new Ha().unpackBundle(this,Ha.GetAssetBundle(mc.rawData),ia.GetAssetsPath())}},{key:"create",value:function(){this.load.removeAllListeners();var e=Ha.GetFileFromCache("json","boot");this.load.reset(),this.load.on("loaderror",function(e){console.log("initialpreloader-> error loading file config: ",e)},this),this.load.once("complete",function(){for(var e in this.load.removeAllListeners(),mc.dynamicJson){var t=mc.dynamicJson[e];ia.AddJson(t.enginetype,t.filename)}this.game.scene.add("PreloaderScene",Gr,!0),this.game.scene.stop("InitialPreloaderScene")},this);var t=new Ha;for(var r in e.files){var o=e.files[r],n=ni({},o.filetype,{path:o.path,assetDict:ni({},o.filename,o.filename)});"json"==o.filetype&&mc.dynamicJson.push({enginetype:o.enginetype,filename:o.filename}),t.unpackBundle(this,Ha.GetAssetBundle(n),ia.GetAssetsPath())}this.load.start()}},{key:"update",value:function(){}}],[{key:"SetAssetsDictToLoad",value:function(e){mc.rawData=e}}]),r}();var Tb={disableFakeMusicPreload:!1,disableSavedAudioState:!1,editorEnabled:!1,disableAutoPause:!1,cordovaListenersEnabled:!1};var ca={phaserConfigData:null,assetsFolderName:null,initialEditorScenesConfig:null,phaserGame:null,editorHooks:null,jsonPrefabs:{},jsonGameConfig:{},jsonNodes:{},jsonAssets:{},listBufferDelayedFuncs:[],listDelayedFuncs:[]},Ir=function(e,o){if(Rb.Update(e,o),ka.UpdateCameraPos(vb),Ba.GetGameRemix().isPaused()||Ba.GetGameRemix().isRotationScreenDisplayed()||da.CallStatesUpdate(o),ca.listDelayedFuncs.length>0)for(var t=ca.listDelayedFuncs.length-1;t>=0;t--)ca.listDelayedFuncs[t].delay-=o,ca.listDelayedFuncs[t].delay<=0&&(ca.listDelayedFuncs[t].f(),ca.listDelayedFuncs.splice(t,1));if(ca.listBufferDelayedFuncs.length>0){for(var n=0;n<ca.listBufferDelayedFuncs.length;n++)ca.listDelayedFuncs.push(ca.listBufferDelayedFuncs[n]);ca.listBufferDelayedFuncs=[]}Ba.GetGameRemix().updateRotateScreen(),da.ExitQueuedStates(Jc(o)),Xh.update(e,o),da.EnterQueuedStates()},ia=function(){function e(){lj(this,e)}return mj(e,null,[{key:"Run",value:function(o){zl(),Ba.SetGameRemix(new o);var t=!1;ca.phaserConfigData.type=Phaser.AUTO,Ja().android&&va.firefox&&(ca.phaserConfigData.type=Phaser.CANVAS),!Ja().desktop&&Ja().iOS&&(t=!0),Ja().desktop&&Ja().macOS&&(t=!0),t&&(ca.phaserConfigData.type=Phaser.CANVAS,ca.phaserConfigData.fps={forceSetTimeOut:!0,target:60},ca.phaserConfigData.roundPixels=!1),ka.MergeDisplayValuesIntoPhaserConfig(ca.phaserConfigData),console.log("L0: Phaser Config:",ca.phaserConfigData),ca.phaserGame=new Phaser.Game(ca.phaserConfigData),xi.SetAssetsDictToLoad(Jr),e.GetPhaserGame().scene.add("ResizeHandlerScene",{create:function(){ka.CallResize(),window.addEventListener("resize",function(){ka.CallResize()})},update:function(){ka.OnUpdate()}},!0),e.GetPhaserGame().scene.add("InitialPreloaderScene",xi,!0)}},{key:"GetPhaserGame",value:function(){return ca.phaserGame}},{key:"AddJson",value:function(e,o){"prefabs"===e&&ta(ca.jsonPrefabs,Ha.GetFileFromCache("json",o)),"assets"===e&&ta(ca.jsonAssets,Ha.GetFileFromCache("json",o)),"gameconfig"===e&&ta(ca.jsonGameConfig,Ha.GetFileFromCache("json",o)),"nodes"===e&&ta(ca.jsonNodes,Ha.GetFileFromCache("json",o))}},{key:"GetJsonAssets",value:function(){return JSON.parse(JSON.stringify(ca.jsonAssets))}},{key:"GetJsonGameConfigHardCopy",value:function(){return JSON.parse(JSON.stringify(ca.jsonGameConfig))}},{key:"GetJsonNodes",value:function(){return JSON.parse(JSON.stringify(ca.jsonNodes))}},{key:"GetJsonPrefabs",value:function(){return JSON.parse(JSON.stringify(ca.jsonPrefabs))}},{key:"GetJsonPrefabCopyAtKey",value:function(e){return console.assert(ca.jsonPrefabs[e]," No Actor key: ",e),JSON.parse(JSON.stringify(ca.jsonPrefabs[e]))}},{key:"InjectEditorHooks",value:function(e){ca.editorHooks=e}},{key:"QueueFunction",value:function(e,o){ca.listBufferDelayedFuncs.push({f:e,delay:o})}},{key:"SafelyDispose",value:function(e){e&&Xh.queueEntity(e)}},{key:"CallHook",value:function(e,o){Tb.editorEnabled&&(ca.editorHooks&&ca.editorHooks[e]?ca.editorHooks[e](o):console.warn("NO EDITOR HOOK: ",e,o))}},{key:"RegisterEditorScenes",value:function(e){ca.initialEditorScenesConfig=e}},{key:"SetPhaserConfig",value:function(e){ca.phaserConfigData={parent:"game-container",plugins:Kr,audio:{}},ta(ca.phaserConfigData,e)}},{key:"SetAssetsFolderName",value:function(e){ca.assetsFolderName=e}},{key:"GetAssetsPath",value:function(){return"assets/"+ca.assetsFolderName+"/"}},{key:"HandlePreloadersDone",value:function(){var o=e.GetPhaserGame();o.scene.add(Xb,{create:function(){if(Rb.SetGameScene(this),sa.RegisterScene(this,Xb,-1),e.GetPhaserGame().events.addListener(Phaser.Core.Events.BLUR,function(){Ba.GetGameRemix().onBrowserBlur()}),e.GetPhaserGame().events.addListener(Phaser.Core.Events.FOCUS,function(){Ba.GetGameRemix().onBrowserFocus()}),Tb.cordovaListenersEnabled&&(window.document.addEventListener("pause",function(){wa.TryToAutomaticallyMuteIfNotMutedManually(),Ba.GetGameRemix().onBrowserBlur()},!1),window.document.addEventListener("resume",function(){wa.TryAutomaticallyUnmuteIfWasMutedAlsoAutomatically(),Ba.GetGameRemix().onBrowserFocus()},!1)),sa.RegisterScene(o.scene.add(vb,{update:function(e,o){}},!0),vb,1),ka.RegisterSceneDisplayObject(bd.GetNewObject(vb)),sa.RegisterScene(o.scene.add(qc,Phaser.Scene,!0),qc,1),ka.RegisterSceneDisplayObject(bd.GetNewObject(qc)),sa.RegisterScene(o.scene.add(rc,Phaser.Scene,!0),rc,-1),ka.RegisterSceneDisplayObject(bd.GetNewObject(rc)),sa.RegisterScene(o.scene.add(sc,Phaser.Scene,!0),sc,-1),ka.RegisterSceneDisplayObject(bd.GetNewObject(sc)),ka.InitializeSceneLayers(),la.RegisterComponentClass(Xa.Name,Xa),la.RegisterComponentClass(Da.Name,Da),la.RegisterComponentClass(Ab.Name,Ab),la.RegisterComponentClass(Ed.Name,Ed),la.RegisterComponentClass(ib.Name,ib),la.RegisterComponentClass(fb.Name,fb),la.RegisterComponentClass(Gc.Name,Gc),la.RegisterComponentClass(Zf.Name,Zf),la.RegisterComponentClass(ua.Name,ua),la.RegisterComponentClass(Eb.Name,Eb),la.RegisterComponentClass(ig.Name,ig),la.RegisterComponentClass(Fb.Name,Fb),la.RegisterComponentClass(li.Name,li),la.RegisterComponentClass(gi.Name,gi),la.RegisterComponentClass(ba.Name,ba),la.RegisterComponentClass(ji.Name,ji),la.RegisterComponentClass(wc.Name,wc),la.RegisterComponentClass(dd.Name,dd),wa.InterpretInitialAudioState(ca.phaserConfigData.gameTitle),Lf.RegisterNodeTree(e.GetJsonNodes()),ka.CallResize(),Ba.RunOnce(),ca.initialEditorScenesConfig)for(var t=0;t<ca.initialEditorScenesConfig.length;t++)e.GetPhaserGame().scene.add(ca.initialEditorScenesConfig[t].key,ca.initialEditorScenesConfig[t].scene,!0)},update:function(e,o){Ir(e,o)}},!0)}}]),e}();var Jr={image:{path:"preloader/textures/",assetDict:{PreloaderLogo:"PreloaderLogo",EmptyPNG:"EmptyPNG"}},font:{path:"preloader/fonts/",assetDict:{preloaderfont:"preloaderfont"}},json:{path:"json",assetDict:{boot:"boot"}}},Kr={scene:[{key:"spine",plugin:SpinePlugin,start:!0,sceneKey:"spine",mapping:"spine"},{key:"rexGestures",plugin:pq,start:!0,sceneKey:"rexGestures",mapping:"rexGestures"}],global:[{key:"rexCsvScenario",plugin:qn,start:!0,sceneKey:"rexCsvScenario",mapping:"rexCsvScenario"},{key:"rexEaseMove",plugin:dh,start:!0,sceneKey:"rexEaseMove",mapping:"rexEaseMove"},{key:"rexMoveTo",plugin:zq,start:!0,sceneKey:"rexMoveTo",mapping:"rexMoveTo"},{key:"rexBullet",plugin:Jl,start:!0,sceneKey:"rexBullet",mapping:"rexBullet"},{key:"rexRotateTo",plugin:_q,start:!0}]};var Lr=2160,Mr=3840,Nr=135,Or=240,Zd=540,$d=960,Pr=xf(function e(){yf(this,e),this.once=!1,this.sizer=null,this.parent=null,this.responsiveWidth=0,this.responsiveHeight=0}),Ea=new Pr,yi=function(){function e(){yf(this,e)}return xf(e,[{key:"mutateDisplayData",value:function(e){Zd=e.designWidth,$d=e.designHeight,e.phaserConfig.scale.mode=Phaser.Scale.FIT,e.phaserConfig.scale.autoCenter=Phaser.Scale.CENTER_BOTH,e.phaserConfig.scale.width=e.designWidth,e.phaserConfig.scale.height=e.designHeight,Zd=e.designWidth,$d=e.designHeight,e.phaserConfig.scale.min={width:Nr,height:Or},e.phaserConfig.scale.max={width:Lr,height:Mr}}},{key:"onResize",value:function(){Ea.once||(Ea.once=!0,Ea.parent=new Phaser.Structs.Size(ia.GetPhaserGame().scale.gameSize.width,ia.GetPhaserGame().scale.gameSize.height),Ea.sizer=new Phaser.Structs.Size(Zd,$d,Phaser.Structs.Size.FIT,parent));var e=ka.GET_WIDTH()/ka.GET_HEIGHT();Ea.responsiveWidth=Zd*($d/Zd)*e,Ea.responsiveHeight=$d,ia.GetPhaserGame().scale.setGameSize(Ea.responsiveWidth,Ea.responsiveHeight)}},{key:"getResponsiveWidth",value:function(){return Ea.responsiveWidth}},{key:"getResponsiveHeight",value:function(){return Ea.responsiveHeight}},{key:"mutateSublayerByScaleManager",value:function(e,a,$){3==a&&(e.x=Ea.responsiveWidth),2==a&&(e.x=Ea.responsiveWidth/2),1==a&&(e.x=0),3==$&&(e.y=Ea.responsiveHeight),2==$&&(e.y=Ea.responsiveHeight/2),1==$&&(e.y=0)}}]),e}();var Qr=pd(function e(){qd(this,e),this.manager=new yi,this.phaserConfig={scale:{}},this.designWidth=void 0,this.designHeight=void 0,this.lastWidth=0,this.lastHeight=0}),Aa=new Qr,Rr=pd(function e(){qd(this,e),this.objectsInArray=[],this.objectsInDictByName={},this._sceneNamesByLayersNamesDict={}}),$a=new Rr,ka=function(){function e(){qd(this,e)}return pd(e,null,[{key:"InitializeSceneLayers",value:function(){var e=[{layerName:[pg],sceneKey:[vb]},{layerName:[Na],sceneKey:[qc]},{layerName:[qg],sceneKey:[rc]},{layerName:[rg],sceneKey:[sc]}];for(var a in e){var t=e[a];$a._sceneNamesByLayersNamesDict[t.layerName]=t.sceneKey}}},{key:"OnUpdate",value:function(){this.GET_WIDTH()!=Aa.lastWidth||this.GET_HEIGHT()!=Aa.lastHeight?(Aa.lastWidth=this.GET_WIDTH(),Aa.lastHeight=this.GET_HEIGHT(),e.CallResize()):Ja().iOS}},{key:"SetBaseDisplayValues",value:function(a,t){if(Ja().desktop)Aa.designWidth=a,Aa.designHeight=t;else{var n=t/a,r=(e.GET_HEIGHT()>e.GET_WIDTH()?e.GET_HEIGHT()/e.GET_WIDTH():e.GET_WIDTH()/e.GET_HEIGHT())/n;r=ud(r,1,2),Aa.designWidth=a*r,Aa.designHeight=t*r}}},{key:"SetDisplayScaleManager",value:function(e){Aa.manager=e,Aa.manager.mutateDisplayData(Aa)}},{key:"MergeDisplayValuesIntoPhaserConfig",value:function(e){ta(e,Aa.phaserConfig)}},{key:"CallResize",value:function(){Aa.manager.onResize();for(var e=0;e<$a.objectsInArray.length;e++){$a.objectsInArray[e].onResize()}}},{key:"GetResponsiveWidth",value:function(){return Aa.manager.getResponsiveWidth()}},{key:"GetResponsiveHeight",value:function(){return Aa.manager.getResponsiveHeight()}},{key:"MutateSublayerByScaleManager",value:function(e,a,t){Aa.manager.mutateSublayerByScaleManager(e,a,t)}},{key:"RegisterSceneDisplayObject",value:function(e){$a.objectsInArray.push(e),$a.objectsInDictByName[e.sceneName]=e}},{key:"GetLayerContainerLite",value:function(a,t){var n=e.GetSceneNameByLayerName(a.layerName);return $a.objectsInDictByName[n].getOrCreateContainerLiteLayer(a,t)}},{key:"UpdateCameraPos",value:function(a){e.GetSceneDisplayObject(a).setCameraPosX(-e.GetResponsiveWidth()/2)}},{key:"GetSceneDisplayObject",value:function(e){return $a.objectsInDictByName[e]}},{key:"GetSceneNameByLayerName",value:function(e){return $a._sceneNamesByLayersNamesDict[e]}},{key:"GetValueScaledByReverseScreenScale",value:function(e){return e}},{key:"ADJUST_WINDOW_SIZE",value:function(){var e=window.innerWidth,a=window.innerHeight;document.documentElement&&"clientWidth"in document.documentElement&&(e=document.documentElement.clientWidth,a=document.documentElement.clientHeight);var t={bottom:0,top:0};Ja().iOS&&(document.documentElement&&"getBoundingClientRect"in document.documentElement?t=document.documentElement.getBoundingClientRect():"getBoundingClientRect"in document.body&&(t=document.body.getBoundingClientRect()),t&&(e=t.right-t.left,a=t.bottom-t.top));var n={w:e,h:a};return n.h=window.innerHeight,n}},{key:"GET_HEIGHT",value:function(){return this.ADJUST_WINDOW_SIZE().h}},{key:"GET_WIDTH",value:function(){return this.ADJUST_WINDOW_SIZE().w}}]),e}();var zi=null,Ba=function(){function e(t){dj(this,e)}return ej(e,[{key:"_onRunOnce",value:function(){}},{key:"_tryPauseGameplay",value:function(){}},{key:"_tryUnpauseGameplay",value:function(){}},{key:"_exitPauseState",value:function(){}},{key:"_interpretRotation",value:function(e){}},{key:"tryCallPause",value:function(){this.hasBeenPaused||this._tryPauseGameplay()}},{key:"tryCallUnpause",value:function(){this._tryUnpauseGameplay()}},{key:"pauseGame",value:function(){if(!this.hasBeenPaused){this.hasBeenPaused=!0;var e=sa.GetSceneList();for(var t in e){var a=e[t];1==a.canBePaused&&a.sceneRef.sys.pause()}}}},{key:"unpauseGame",value:function(){if(this.hasBeenPaused){this.hasBeenPaused=!1;var e=sa.GetSceneList();for(var t in e){var a=e[t];1==a.canBePaused&&a.sceneRef.sys.resume()}this._exitPauseState()}}},{key:"isPaused",value:function(){return this.hasBeenPaused}},{key:"onBrowserFocus",value:function(){}},{key:"onBrowserBlur",value:function(){Tb.disableAutoPause||this.tryCallPause()}},{key:"isRotationScreenDisplayed",value:function(){return!1}},{key:"showRotation",value:function(){wa.TryToAutomaticallyMuteIfNotMutedManually(),this.pauseFromRotation=!1,this.isPaused||(this.pauseFromRotation=!0,this.pauseGame())}},{key:"hideRotation",value:function(){wa.TryAutomaticallyUnmuteIfWasMutedAlsoAutomatically(),this.pauseFromRotation&&(this.unpauseGame(),this.pauseFromRotation=!1)}},{key:"updateRotateScreen",value:function(){ka.GetResponsiveWidth()>ka.GetResponsiveHeight()?("landscape"!=this.rotation&&this._interpretRotation("landscape"),this.rotation="landscape"):ka.GetResponsiveHeight()>ka.GetResponsiveWidth()&&("portrait"!=this.rotation&&this._interpretRotation("portrait"),this.rotation="portrait")}}],[{key:"RunOnce",value:function(){zi._onRunOnce()}},{key:"SetGameRemix",value:function(e){zi=e}},{key:"GetGameRemix",value:function(){return zi}}]),e}();var ea="button";var _d={name:"DoPlayBtnTap"},af=function(e,t){da.IsStateActive(e.sessionTemp.nanostateOwner)&&ga.TriggerCommandList(e,t)},nc=function(e,t){da.IsStateActive(e.sessionTemp.nanostateOwner)&&ga.TriggerCommandsAtKey(e,t)},dd=function(){function e(){Zi(this,e)}return $i(e,null,[{key:"InjectIntoJsonAsEmpty",value:function(t){t[ea]={};var o=e.GetEmptyValues();return ta(t[ea],o),t[ea]}},{key:"GetEmptyValues",value:function(){return{logicUp:null,logicDown:null,logicOver:null,logicOut:null,visInteractions:"basic",audio:!1}}},{key:"InjectIntoActor",value:function(t){var o=e.GetEmptyValues();return t.vals[ea]=o,t}},{key:"ResetTracking",value:function(e){e.sessionTemp[ea].pressed&&ab.RunInteractionAtAccessor(e.vals[ea].visInteractions,"out",e),e.sessionTemp[ea].lastPointerID>=0&&Rb.NullifyTrackedButton(e,e.sessionTemp[ea].lastPointerID),e.sessionTemp[ea].pressed=!1,e.sessionTemp[ea].lastPointerID=-1}},{key:"PreBake",value:function(e){e.sessionTemp[ea]={pressed:!1,lastPointerID:-1}}},{key:"Bake",value:function(e){}},{key:"PostBake",value:function(t){t.displayed.setInteractive(),t.displayed.on("pointerup",function(o,i,$,d){Ba.GetGameRemix().isRotationScreenDisplayed()||t.sessionTemp[ea].pressed&&(ab.RunInteractionAtAccessor(t.vals[ea].visInteractions,"up",t),e.ResetTracking(t),t.vals[ea].logicUp?(nc(t,t.vals[ea].logicUp),af(t,[_d])):t.vals[ea].toggle&&(null==t.vals[ea].toggle.state&&(t.vals[ea].toggle.state="on"),"on"==t.vals[ea].toggle.state?(t.vals[ea].toggle.state="off",af(t,[_d]),nc(t,t.vals[ea].toggle.toOffLogic),nc(t,t.vals[ea].toggle.toOffVisual)):(t.vals[ea].toggle.state="on",af(t,[_d]),nc(t,t.vals[ea].toggle.toOnLogic),nc(t,t.vals[ea].toggle.toOnVisual))))}),t.displayed.on("pointerdown",function(e,o,i,$){Ba.GetGameRemix().isRotationScreenDisplayed()||(ab.RunInteractionAtAccessor(t.vals[ea].visInteractions,"down",t),t.sessionTemp[ea].pressed=!0,t.sessionTemp[ea].lastPointerID=e.id,Rb.AddTrackedButton(t,e.id))}),t.displayed.on("pointerover",function(e,o,i,$){Ba.GetGameRemix().isRotationScreenDisplayed()||t.sessionTemp[ea].pressed||ab.RunInteractionAtAccessor(t.vals[ea].visInteractions,"over",t)}),t.displayed.on("pointerout",function(e,o,i,$){Ba.GetGameRemix().isRotationScreenDisplayed()||t.sessionTemp[ea].pressed||ab.RunInteractionAtAccessor(t.vals[ea].visInteractions,"out",t)})}},{key:"SetToggleStateWithoutTriggering",value:function(e,t){var o=t;-1===t&&(o=0),0==o?(e.vals[ea].toggle.state="off",ga.TriggerCommandsAtKey(e,e.vals[ea].toggle.toOffVisual)):(e.vals[ea].toggle.state="on",ga.TriggerCommandsAtKey(e,e.vals[ea].toggle.toOnVisual))}},{key:"Cleanup",value:function(t){e.ResetTracking(t),t.displayed.removeInteractive()}},{key:"Name",get:function(){return ea}},{key:"Has",value:function(e){return!!e.vals[ea]}}]),e}();function Sr(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Ai(e,r){for(var a=0;a<r.length;a++){var t=r[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function Tr(e,r,a){return r&&Ai(e.prototype,r),a&&Ai(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ur(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bi(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vr(e,t,a){return t&&Bi(e.prototype,t),a&&Bi(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}var pb=function(){function e(){Ur(this,e)}return Vr(e,null,[{key:"GetRotatedCoordinate",value:function(e,t,a){return Phaser.Math.Rotate({x:e,y:t},Phaser.Math.DegToRad(a))}},{key:"AddRotatedByAnglePositionsToObject",value:function(t,a,r,n){var o=e.GetRotatedCoordinate(a,r,n);t.x+=o.x,t.y+=o.y}},{key:"GetAngleBetweenInDegrees",value:function(e,t,a,r){return Phaser.Math.RadToDeg(Phaser.Math.Angle.Between(e,t,a,r))}},{key:"GetPositionDeltaFromActors",value:function(e,t){return{x:t.displayed.x-e.displayed.x,y:t.displayed.y-e.displayed.y}}},{key:"Roll100",value:function(){return Phaser.Math.Between(1,100)}},{key:"GetTrueOrFalse",value:function(){return!!Phaser.Math.Between(0,1)}}]),e}();var ra="system_shoot_projectile",Wr=function(e,r){if(ba.IsActorOnScreen(e)){var a=e.vals[ra];if(a.enabled){var t=!1;if(a.intervalCur+=1e3*r,void 0!==a.intervalIndex){var i=a.intervalMax[a.intervalIndex];a.intervalCur>=i&&(a.intervalCur=0,a.intervalIndex+=1,a.intervalIndex>=a.intervalMax.length&&(a.intervalIndex=0),t=!0)}else a.intervalCur>=a.intervalMax&&(a.intervalCur=0,t=!0);if(t){var $=[],o=a.bulletCount,l=o%2,n=o,s=e.displayed.x,v=e.displayed.y,h=e.displayed.angle,c=e.vals[ra].offsetX,A=e.vals[ra].offsetY,p=e.vals[ra].noScaleOffsetX,u=e.vals[ra].noScaleOffsetY;null!=p&&null!=u||(p=0,u=0);for(var M=Math.floor(n/2),S=0;S<M;S++){var _={},G=S+1;null!=e.vals[ra].reduceIteratorBy&&(G-=e.vals[ra].reduceIteratorBy)<0&&(G=0),_.angle=h-G*e.vals[ra].angleMultiplier,_.x=s,_.y=v,pb.AddRotatedByAnglePositionsToObject(_,c,-A*(S+1)+A*(1/e.vals[ra].offsetSpreadScale)*S,h-S*e.vals[ra].angleMultiplier),pb.AddRotatedByAnglePositionsToObject(_,p,u,h);var d={};d.angle=h+G*e.vals[ra].angleMultiplier,d.x=s,d.y=v,pb.AddRotatedByAnglePositionsToObject(d,c,A*(S+1)-A*(1/e.vals[ra].offsetSpreadScale)*S,h+S*e.vals[ra].angleMultiplier),pb.AddRotatedByAnglePositionsToObject(d,p,u,h),$.push(_),$.push(d)}var H=0;if(H=1==l&&1==o?A:0,1==l){var f={};f.angle=h,f.x=s,f.y=v,pb.AddRotatedByAnglePositionsToObject(f,c,H,f.angle),pb.AddRotatedByAnglePositionsToObject(f,p,u,h),$.push(f)}for(var C=0;C<$.length;C++){console.assert(e.sessionTemp.nanostateOwner);var E=e.sessionTemp.nanostateOwner;"background"==E&&console.warn("SHOULDNT BE PUT INTO BACKGROUND!");var y=ga.GetBakedFromDef(e.vals[ra].bulletPrefab,E);ba.SetPosition(y,$[C].x,$[C].y),ba.SetAngle(y,$[C].angle)}}}}},ed=function(){function e(){Sr(this,e)}return Tr(e,null,[{key:"SystemName",get:function(){return ra}},{key:"SetEnabled",value:function(e,r){e.vals[ra].enabled=r}},{key:"Update",value:function(e){for(var r=pa.GetBagItemsList("_"+ra),a=0;a<r.length;a++)Wr(r[a],e)}},{key:"AddActor",value:function(e){var r=e.vals[ra];void 0===r.intervalCur&&(r.intervalCur=0),null==r.enabled&&(r.enabled=!0),Hg(r.intervalMax)&&(r.intervalIndex=0),Da.InjectIntoActor(e,["_"+ra])}},{key:"CleanupActor",value:function(e){}}]),e}();function Xr(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Ci(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yr(e,r,t){return r&&Ci(e.prototype,r),t&&Ci(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var fd="system_offscreen_die",Zr=function(e,r,t){var n=r.vals[fd];void 0===n.timeOffScreen&&(n.timeOffScreen=0,n.wasOnScreen=!1),n.timeOffScreen+=e,n.timeOffScreen>=t&&(n.wasOnScreen=!0);var a=ba.IsActorOnScreen(r);0==a&&n.wasOnScreen?ga.TriggerDisposeSafely(r):1!=a||n.wasOnScreen||(n.wasOnScreen=!0)},Di=function(){function e(){Xr(this,e)}return Yr(e,null,[{key:"SystemName",get:function(){return fd}},{key:"Update",value:function(e,r){for(var t=pa.GetBagItemsList("_"+fd),n=0;n<t.length;n++)Zr(e,t[n],r)}},{key:"AddActor",value:function(e){Da.InjectIntoActor(e,["_"+fd])}},{key:"CleanupActor",value:function(e){}}]),e}();function $r(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Ei(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _r(e,r,t){return r&&Ei(e.prototype,r),t&&Ei(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var qb="system_pin",as=function(e,r){for(var t=qb,o=(e.vals[t],e.sessionTemp[t].childrens),a=0;a<o.length;a++){var n=pb.GetRotatedCoordinate(o[a].offsetX,o[a].offsetY,e.displayed.angle);ba.SetPosition(o[a].actor,e.displayed.x+n.x,e.displayed.y+n.y)}if(e.disposeQueued)for(var s=0;s<o.length;s++)ga.TriggerDisposeSafely(o[s].actor)},bf=function(){function e(){$r(this,e)}return _r(e,null,[{key:"SystemName",get:function(){return qb}},{key:"Update",value:function(e){for(var r=pa.GetBagItemsList("_"+qb),t=0;t<r.length;t++)as(r[t],e)}},{key:"AddActor",value:function(e){Da.InjectIntoActor(e,["_"+qb]);var r=qb,t=e.vals[r];e.sessionTemp[r]={},e.sessionTemp[r].childrens=[];for(var o=0;o<t.list.length;o++){var a=t.list[o];console.assert(e.sessionTemp.nanostateOwner);var n=ga.GetBakedFromDef(a.prefab,e.sessionTemp.nanostateOwner);void 0===a.x&&(a.x=0),void 0===a.y&&(a.y=0),ba.SetX(n,e.displayed.x),ba.SetY(n,e.displayed.y),e.sessionTemp[r].childrens.push({actor:n,offsetX:a.x,offsetY:a.y})}}},{key:"GetChildrenList",value:function(e){return e.sessionTemp[qb].childrens}},{key:"CleanupActor",value:function(e){for(var r=qb,t=e.sessionTemp[r].childrens,o=0;o<t.length;o++)ga.TriggerDisposeSafely(t[o].actor)}}]),e}();function bs(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function Fi(e,n){for(var a=0;a<n.length;a++){var s=n[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function cs(e,n,a){return n&&Fi(e.prototype,n),a&&Fi(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}var cf=function(e){void 0===e._x&&(e._x=0),void 0===e._y&&(e._y=0),void 0===e._d&&(e._d=100)},gd=function(e,n,a,s,t,o){if(n.sessionTweenInstances.position&&o){var i=n.sessionTweenInstances.position;if(26!=i.state){i.stop();for(var l=0;l<i.data.length;l++){var r=i.data[l];r.target[r.key]=r.end}}n.sessionTweenInstances.position=null}if(n.sessionTweenInstances.position&&!o){var u=n.sessionTweenInstances.position;26!=u.state&&u.stop(),n.sessionTweenInstances.position=null}s&&Ca.MergeConfigs(a,s),t&&t.func(e,n);var d=e.tweens.add(a);return n.sessionTweenInstances.position=d,d},Ca=function(){function e(){bs(this,e)}return cs(e,null,[{key:"TweenPositionByDeltaFrom",value:function(n,a){var s=JSON.parse(JSON.stringify(a)),t=n.displayed.scene;return cf(s),e._FixConfig(s),gd(t,n,{targets:n.displayed,x:n.displayed.x,y:n.displayed.y,ease:"Cubic.InOut",duration:s._d},s,{func:function(e,n){n.displayed.x=n.displayed.x+this.delta_x,n.displayed.y=n.displayed.y+this.delta_y},delta_x:s._x,delta_y:s._y},!0)}},{key:"TweenPositionByDeltaTo",value:function(n,a){var s=JSON.parse(JSON.stringify(a)),t=n.displayed.scene;return cf(s),e._FixConfig(s),gd(t,n,{targets:n.displayed,x:n.displayed.x+s._x,y:n.displayed.y+s._y,ease:"Cubic.InOut",duration:s._d},s,null,!0)}},{key:"TweenPositionTo",value:function(e,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=e.displayed.scene;return null==n._x&&(n._x=0,console.warn("Fallback: ",n._x=0)),null==n._y&&(n._y=0,console.warn("Fallback: ",n._y=0)),null==n._d&&(n._d=1e3),gd(s,e,{targets:e.displayed,x:n._x,y:n._y,ease:"Cubic.InOut",duration:n._d,delay:1e3},n,null,a)}},{key:"TweenPositionYoyo",value:function(n,a){var s=JSON.parse(JSON.stringify(a));ta(s,{_x:0,_y:20,_d:100,ease:"Quadratic.In"});var t=n.displayed.scene;return cf(s),e._FixConfig(s),gd(t,n,{targets:n.displayed,x:n.displayed.x+s._x,y:n.displayed.y+s._y,ease:"Quadratic.In",duration:s._d,repeat:-1,yoyo:!0},s,null,!0)}},{key:"_DoScaleTween",value:function(n,a,s,t){a.sessionTweenInstances.scale&&t.ifTweens&&("fast"==t.ifTweens?console.log("implement: fast at tweenScaleTo"):"stop"==t.ifTweens&&(a.sessionTweenInstances.scale.stop(),a.sessionTweenInstances.scale=null)),t&&e.MergeConfigs(s,t);var o=n.tweens.add(s);return a.sessionTweenInstances.scale=o,o}},{key:"_DoAlphaTween",value:function(n,a,s,t){t&&e.MergeConfigs(s,t);var o=n.tweens.add(s);return a.sessionTweenInstances.alpha=o,o}},{key:"_FixConfig",value:function(e){null!=e.d&&(e._d=e.d,delete e.d),null!=e.x&&(e._x=e.x,delete e.x),null!=e.y&&(e._y=e.y,delete e.y),null!=e.alpha&&(e._alpha=e.alpha,delete e.alpha),null!=e.onComplete&&(e._onComplete=e.onComplete),null!=e.onCompleteCommand&&(e._onComplete=e.onCompleteCommand)}},{key:"TweenAlphaTo",value:function(n,a){var s=JSON.parse(JSON.stringify(a)),t=n.displayed.scene;e._FixConfig(s);var o={targets:n.displayed,alpha:s._alpha,ease:"Cubic.InOut",duration:s._d};return e._DoAlphaTween(t,n,o,s)}},{key:"TweenAlphaFrom",value:function(n,a){var s=JSON.parse(JSON.stringify(a)),t=n.displayed.scene;e._FixConfig(s);var o=n.displayed.alpha;n.displayed.alpha=s._alpha,s._alpha=o;var i={targets:n.displayed,alpha:s._alpha,ease:"Cubic.InOut",duration:s._d};return e._DoAlphaTween(t,n,i,s)}},{key:"TweenScaleTo",value:function(n,a){var s=n.displayed.scene,t={targets:n.displayed,scale:a._s,ease:"Cubic.InOut",duration:a._d};return e._DoScaleTween(s,n,t,a)}},{key:"TweenPingScale",value:function(n,a,s,t){ba.SetScale(n,s);var o=n.displayed.scene,i={targets:n.displayed,scale:t,duration:a._d,yoyo:!0};return e._DoScaleTween(o,n,i,a)}},{key:"IsTweeningPosition",value:function(e){var n=e.sessionTweenInstances.position;if(!n)return!1;return 26!=n.state}},{key:"GetPositionTweenProgress",value:function(e){return e.sessionTweenInstances.position?e.sessionTweenInstances.position.progress:1}},{key:"StopPositionTween",value:function(e){var n=e.sessionTweenInstances.position;n&&n.stop()}},{key:"IsTweeningScale",value:function(e){var n=e.sessionTweenInstances.scale;if(!n)return!1;return 26!=n.state}},{key:"MergeConfigs",value:function(e,n){for(var a in null!=n&&null!=n||(n={}),null!=n.scaleX&&delete e.scale,null!=n.scaleY&&delete e.scale,n)e[a]=n[a];return n._onComplete&&(e.onComplete=function(){this.targets[0].refSelfActor&&ga.OnTweenComplete(this.targets[0].refSelfActor,n._onComplete)}),e}}]),e}();var ds=function(){ja.AddCommandHandlerRequiringActor("ScalePingBounceFromZero",function(e,a){var r=e.displayed.scale;ba.SetScale(e,0);var n={_d:Phaser.Math.Between(250,350),_s:r,delay:Phaser.Math.Between(0,100),ease:"Bounce"};Ca.TweenScaleTo(e,n)})};function Gi(e,a){for(var r=0;r<a.length;r++){var t=a[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function Hi(e,a,r){return a&&Gi(e.prototype,a),r&&Gi(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ii(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}var es=Hi(function e(){Ii(this,e),this.data={},this.masterSeparator="===SEG==="}),oc=new es,Ji=function(){function e(){Ii(this,e)}return Hi(e,null,[{key:"GetSeparatedText",value:function(a){var r=a.replace(/[\r]+/g,"");return e.ReturnNewArrWithoutEmptyElems(r.split("\n"))}},{key:"ReturnNewArrWithoutEmptyElems",value:function(e){for(var a=[],r=0;r<e.length;r++){var t=e[r];t.length>0&&a.push(t)}return a}},{key:"ParseAndCache",value:function(a,r){if(!oc.data[a]){for(var t=[],$=e.ReturnNewArrWithoutEmptyElems(r.split(oc.masterSeparator)),n=0;n<$.length;n++){var i=e.GetSeparatedText($[n]);t.push(i)}oc.data[a]=t}}},{key:"ParseAndCacheFromSceneCache",value:function(a,r){oc.data[a]||e.ParseAndCache(a,Ha.GetFileFromCache("text",r))}},{key:"GetCached",value:function(e){return oc.data[e]}}]),e}();function fs(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Ki(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function gs(e,r,n){return r&&Ki(e.prototype,r),n&&Ki(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var hd="GRID_OUT_OF_BOUNDS";var df=function(){function e(){fs(this,e)}return gs(e,null,[{key:"AddRow",value:function(e,r){e.push(r)}},{key:"GetAt",value:function(r,n,t,o){return console.assert(r,"Param Grid is: ",r),n<0?(o||console.warn(hd),null):n>=e.GetWidth(r)?(o||console.warn(hd),null):t<0?(o||console.warn(hd),null):t>=e.GetHeigth(r)?(o||console.warn(hd),null):r[t][n]}},{key:"SetAt",value:function(e,r,n,t,o){e[n][r]=t}},{key:"IsOutOfBounds",value:function(e,r,n){return console.assert(void 0!==e&&void 0!==r&&null!=n,"one of params is undefined!"),r<0}},{key:"GetHeigth",value:function(e){return e.length}},{key:"GetWidth",value:function(e){return e[0].length}},{key:"ResizeAsNew",value:function(e,r,n){for(var t=[],o=0;o<n;o++){for(var a=[],l=0;l<r;l++)a.push(0);t.push(a)}return t}},{key:"ForEachObjectInGridCallFunc",value:function(e,r){for(var n=0;n<e.length;n++)for(var t=e[n],o=0;o<t.length;o++){r(t[o])}}},{key:"ForEachCoordinateInGridCallFunc",value:function(e,r){for(var n=0;n<e.length;n++)for(var t=e[n],o=0;o<t.length;o++){r(t[o],o,n)}}},{key:"ConvertFromSingleArray",value:function(r,n,t){var o=e.ResizeAsNew([],n,t);return e.ForEachCoordinateInGridCallFunc(o,function(t,a,l){var v=n*l+a;e.SetAt(o,a,l,r[v])}.bind(this)),o}},{key:"ConvertToSingleArray",value:function(r){var n=[];return e.ForEachCoordinateInGridCallFunc(r,function(e,r,t){n.push(e)}),n}},{key:"ConvertFromDataSet",value:function(r,n){for(var t=0;t<n.length;t++)for(var o=n[t],a=0;a<o.length;a++){var $gqyU$$interop$default=ld(Ec);var l=$gqyU$$interop$default.d.charAt(o,a);e.SetAt(r,a,t,l)}}}]),e}();var Sa=function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!=e&&(r.displayed.x=e),r.displayed.x};var _a=function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!=e&&(r.displayed.y=e),r.displayed.y};var Ub=function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!=e&&r.displayed.setScale(e),r.displayed.scale};var xa=function(a){return a.vals.data};function hs(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function Li(e,n){for(var r=0;r<n.length;r++){var o=n[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function is(e,n,r){return n&&Li(e.prototype,n),r&&Li(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var pc=function(){function e(){hs(this,e)}return is(e,null,[{key:"ChangeAnimation",value:function(e,n){if(console.assert(e,"Actor param is:",e),fb.Has(e))fb.SetAnimation(e,n);else if(Gc.Has(e)||Ed.Has(e)){var r=n,o=null;ia.GetPhaserGame().textures.exists(r)||(r="megaset",o=n),e.displayed.setTexture(r,o)}else console.warn("NOT IMPLEMENTED")}}]),e}();function js(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function Mi(e,o){for(var r=0;r<o.length;r++){var t=o[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function ks(e,o,r){return o&&Mi(e.prototype,o),r&&Mi(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var Vb="system_input_movement",ls=function(e,o){var r=o.vals[Vb],t={x:0,y:0};if(r.flagProcessTowardPointer){var n=Rb.GetPointerIfNotPressingButton();if(n){var a=!1;if(n.isDown&&(a=!0),r.flagProcessPointerConstantly&&(a=!0),a){var $=o.displayed.scene.cameras.main.scrollX,s=o.displayed.scene.cameras.main.scrollY,v=n.x+r.offsetX+$,i=n.y+r.offsetY+s;t.x=v,t.y=i}}}0!=t.x||0!=t.y?(r.boundsAxisX&&(t.x=ud(t.x,r.boundsAxisX.min,r.boundsAxisX.max)),r.boundsAxisY&&(t.y=ud(t.y,r.boundsAxisY.min,r.boundsAxisY.max)),r.flagInstantMove?(Sa(o,t.x),_a(o,t.y)):Eb.MoveTo(o,t.x,t.y)):r.flagStopMovementWithoutAnyInput&&Eb.MoveTo(o,o.displayed.x,o.displayed.y)},Ni=function(){function e(){js(this,e)}return ks(e,null,[{key:"SystemName",get:function(){return Vb}},{key:"Update",value:function(o){La.HasSystemKey(Vb)||console.warn("SYSTEM NOT REGISTED: ",e.SystemName);for(var r=pa.GetBagItemsList("_"+Vb),t=0;t<r.length;t++)ls(o,r[t])}},{key:"AddActor",value:function(e){Eb.Has(e)||console.warn("prefab: ",e.prefabName," missing RexMoveToPluginComponent"),Da.InjectIntoActor(e,["_"+Vb]);var o=e.vals[Vb];null==o.offsetX&&(o.offsetX=0),null==o.offsetY&&(o.offsetY=0)}},{key:"CleanupActor",value:function(e){}}]),e}();var ms=function(){ab.AddInteraction("basic",{over:function(n){Ca.TweenScaleTo(n,{_s:1.1,_d:100,ifTweens:"stop"})},out:function(n){Ca.TweenScaleTo(n,{_s:1,_d:100,ifTweens:"stop"})},down:function(n){Ca.TweenScaleTo(n,{_s:.9,_d:100,ifTweens:"stop"})},up:function(n){Ca.TweenScaleTo(n,{_s:1,_d:100,ifTweens:"stop"})}}),ab.AddInteraction("none",{over:function(n){Ca.TweenScaleTo(n,{_s:1,_d:10,ifTweens:"stop"})},out:function(n){Ca.TweenScaleTo(n,{_s:1,_d:10,ifTweens:"stop"})},down:function(n){Ca.TweenScaleTo(n,{_s:1,_d:10,ifTweens:"stop"})},up:function(n){Ca.TweenScaleTo(n,{_s:1,_d:10,ifTweens:"stop"})}})};var ns=function(){ja.AddCommandHandlerRequiringActor("DoSetPosition",function(o,n){null==n.x&&(n.x=0),null==n.y&&(n.y=0),ba.SetPosition(o,n.x,n.y)}),ja.AddCommandHandlerRequiringActor("DoVisualMoveHalfSize",function(o,n){null==n.dirX&&(n.dirX=0),null==n.dirY&&(n.dirY=0);var e=n.dirX,i=n.dirY;1==e&&(e=.5),-1==e&&(e=-.5),1==i&&(i=.5),-1==i&&(i=-.5),ba.MoveBySizeMultiplied(o,e,i)}),ja.AddCommandHandlerRequiringActor("DoVisualMoveBySizeMultiplied",function(o,n){null==n.dirX&&(n.dirX=0),null==n.dirY&&(n.dirY=0),ba.MoveBySizeMultiplied(o,n.dirX,n.dirY)}),ja.AddCommandHandlerRequiringActor("DoVisualResize",function(o,n){ba.Resize(o,n.width,n.height)}),ja.AddCommandHandlerRequiringActor("DoTweenPositionByDeltaFrom",function(o,n){Ca.TweenPositionByDeltaFrom(o,n)}),ja.AddCommandHandlerRequiringActor("DoTweenPositionByDeltaTo",function(o,n){Ca.TweenPositionByDeltaTo(o,n)}),ja.AddCommandHandlerRequiringActor("DoTweenPositionTo",function(o,n){Ca.TweenPositionTo(o,n)}),ja.AddCommandHandlerRequiringActor("DoTweenPositionYoYo",function(o,n){Ca.TweenPositionYoyo(o,n)}),ja.AddCommandHandlerRequiringActor("DoTweenAlphaTo",function(o,n){Ca.TweenAlphaTo(o,n)}),ja.AddCommandHandlerRequiringActor("DoTweenAlphaFrom",function(o,n){Ca.TweenAlphaFrom(o,n)}),ja.AddCommandHandlerRequiringActor("DoDispose",function(o,n){ia.SafelyDispose(o)}),ja.AddCommandHandlerRequiringActor("DoPlayAnimation",function(o,n){pc.ChangeAnimation(o,n.anim)}),ja.AddCommandHandlerRequiringActor("DoRandomTextureSwap",function(o,n){pc.ChangeAnimation(o,Phaser.Utils.Array.GetRandom(n.list))}),ja.AddCommandHandlerRequiringActor("DoSynchronizeBodyWithVisual",function(o,n){ua.GetBody(o).setSize(ba.GetDisplayWidth(o),ba.GetDisplayHeight(o)),ua.GetBody(o).x=o.displayed.x-ba.GetDisplayWidth(o)/2,ua.GetBody(o).y=o.displayed.y-ba.GetDisplayHeight(o)/2}),ja.AddCommandHandlerRequiringActor("DoDelayedTrigger",function(o,n){var e=ga.GetGUID(o),i=n.delayedCommand;ia.QueueFunction(function(){var o=pa.GetActorByGUID(e);o&&ga.TriggerCommandsAtKey(o,i)},n.delay)})};var os="SPACEOUT_2022_07_23",ps="SPACEOUT_2022",Qa=null,Ia={lastGameplayScore:0,hasSeenTutorial:!1,saveData:{score:0}},Oi=nd(function e(){od(this,e),this.score=0}),Pi=nd(function e(){od(this,e),this.levelStarted=!1,this.levelEnded=!1,this.timeSinceBall=0,this.lives=3,this.level=1,this.activeLevelTime=0,this.playerCannonTime=0}),Qi="background",id="gameplay_passive",Wb="gameplay_active",jd="gameover",kd="cover",ef="pause",ff="fade",Ri="audio_controller",gf="rotate_your_device",Ka="level",rb="BALLS",hf="PADDLE",qs=function(e){Ui(a,Ba);var t=Wi(a);function a(e){var r;return od(this,a),r=t.call(this),Qa=Ta(r),r.gameplayVals=new Oi,r.levelVals=new Pi,ia.SetPhaserConfig({title:"SpaceOut",backgroundColor:"0x701B3D",physics:{default:"arcade",arcade:{debug:!1}}}),ia.SetAssetsFolderName("spaceout"),console.log("GAME VERSION:: "+ps),ka.SetBaseDisplayValues(640,1050),ka.SetDisplayScaleManager(new yi),ms(),ns(),ds(),ja.AddCommandHandlerRequiringActor("DoPlayBtnTap",function(e,t){wa.PlayAudio("tap")}),ja.AddCommandHandler("DoMute",function(e){wa.MuteAudioManuallyByUser()}),ja.AddCommandHandler("DoUnmute",function(e){wa.UnmuteAudioManuallyByUser()}),ja.AddCommandHandler("DoPause",function(e){Qa.tryCallPause()}),ja.AddCommandHandler("DoUnpause",function(e){Qa.tryCallUnpause()}),ja.AddCommandHandler("DoStartGameplay",function(e){da.ExitState(kd),da.EnterState(Wb)}),ja.AddCommandHandler("DoGotoCover",function(e){da.EnterState(ff),da.ExitState(id),da.ExitState(Wb),da.ExitState(Ka),da.ExitState(jd),ia.QueueFunction(function(){da.EnterState(kd),da.EnterState(id),da.EnterState(Ka),ia.QueueFunction(function(){da.ExitState(ff)},10)},550)}),ja.AddCommandHandler("DoPlayNewLevel",function(e){da.ExitState(Wb),da.ExitState(Ka),ia.QueueFunction(function(){da.EnterState(Ka),da.EnterState(Wb),ia.QueueFunction(function(){},10)},550)}),da.RegisterState(Qi,[],{onPreUpdate:function(e){Jc(e)}.bind(Ta(r)),onUpdate:function(){}.bind(Ta(r)),onPostUpdate:function(e){var t=Jc(e);bf.Update(t),Di.Update(t,10)}.bind(Ta(r))}),da.RegisterState(ef,["node_pause"]),da.RegisterState(ff,["node_fade"]),da.RegisterState(gf,["node_rotate_your_device"],{maxExitTime:0}),da.RegisterState(Ri,["node_audio_controller"],{onEnter:function(){dd.SetToggleStateWithoutTriggering(Wa("audio_controller_btn_audio"),wa.GetAudioState())}.bind(Ta(r))}),da.RegisterState(kd,["node_cover"],{onEnter:function(){ib.SetTextWithZeroPad(Wa("cover_score_text"),Ia.saveData.score,6)}.bind(Ta(r)),onUpdate:function(e){}.bind(Ta(r))}),da.RegisterState(id,["node_gameplay_passive"],{onEnter:r._stateEnter_gameplayPassive.bind(Qa),onUpdate:r._stateUpdate_gameplayPassive.bind(Qa)}),da.RegisterState(Wb,["node_gameplay_active"],{onUpdate:r._stateUpdate_gameplayActive.bind(Qa),onEnter:r._stateEnter_gameplayActive.bind(Qa),onExit:function(){}.bind(Qa),onQuit:function(){}.bind(Qa)}),da.RegisterState(jd,["node_gameover"],{onEnter:function(){ga.TriggerDisposeSafely(Wa("gameplay_btn_pause")),Ia.lastGameplayScore=this.gameplayVals.score,console.log(Ia.lastGameplayScore,Ia.saveData),Ia.lastGameplayScore>Ia.saveData.score&&(ga.GetBakedFromDef("gameover_icon_highscore",jd),Ia.saveData.score=Ia.lastGameplayScore)}.bind(Qa)}),da.RegisterState(Ka,[],{onEnter:function(){this.add_to_score(0),this.levelVals.timeSinceBall=0,Ji.ParseAndCacheFromSceneCache("Levels","Levels");var e=Ji.GetCached("Levels"),t=Phaser.Math.Between(0,e.length-1),a=e[t];console.log("LevelID: ",t," LevelDifficulty: ",this.levelVals.level);var r=df.ResizeAsNew([],9,15);df.ConvertFromDataSet(r,a),df.ForEachCoordinateInGridCallFunc(r,function(e,t,a){if("#"!=e){this.levelVals.level<=1&&(4==e&&(e=2),5==e&&(e=1)),2==this.levelVals.level&&5==e&&(e=1),e<=0&&(e=1);var r=ga.GetBakedFromDef("brick",Ka);ba.MoveByXY(r,66*t+32-296,34*a+32+70),xa(r).lives=parseInt(e),pc.ChangeAnimation(r,xa(r)["texture_at_life_"+xa(r).lives]),ga.TriggerCommandList(r,[{name:"DoSynchronizeBodyWithVisual"},{name:"ScalePingBounceFromZero"}])}}.bind(this));var $=ga.GetBakedFromDef("paddle",Ka);ua.GetBody($).setImmovable(!0),ba.SetPosition($,0,900),this.setPlayerTurretsState(!1),this.levelVals.levelEnded=!1,this.levelVals.levelStarted=!1}.bind(Qa)}),La.RegisterSystem(Ni),La.RegisterSystem(bf),La.RegisterSystem(ed),La.RegisterSystem(Di),Ia.saveData=Hf.RefreshSaveDataReferenceFromStorage(os,Ia.saveData),r}return nd(a,[{key:"_onRunOnce",value:function(){md(tb(a.prototype),"_onRunOnce",this).call(this),Db(rb,!1),Db(hf,!1),Db("UPGRADES",!1),Db("WALL",!0),Db("BRICKS",!0),Db("BULLET",!0),yc(rb,"WALL",this.collide_ball_vs_wall.bind(this)),yc(rb,"BRICKS",this.collide_ball_vs_brick.bind(this)),yc("BULLET","BRICKS",this.collide_bullet_vs_brick.bind(this)),yc(rb,hf,this.collide_ball_vs_paddle.bind(this)),Xj(hf,"UPGRADES",this.overlap_paddle_vs_upgrades.bind(this)),da.EnterState(Qi),da.EnterState(Ri),da.EnterState(kd),da.EnterState(id),da.EnterState(Ka),wa.PlayAudio("music")}},{key:"_tryPauseGameplay",value:function(){md(tb(a.prototype),"_tryPauseGameplay",this).call(this),this.levelVals.levelStarted&&!this.levelVals.levelEnded&&(da.EnterState(ef),this.pauseGame())}},{key:"_tryUnpauseGameplay",value:function(){md(tb(a.prototype),"_tryUnpauseGameplay",this).call(this),this.unpauseGame()}},{key:"_exitPauseState",value:function(){da.ExitState(ef)}},{key:"_interpretRotation",value:function(e){"landscape"!=e||ia.GetPhaserGame().device.os.desktop?ia.GetPhaserGame().device.os.desktop||(da.ExitState(gf),this.hideRotation()):(da.EnterState(gf),this.showRotation())}},{key:"_stateEnter_gameplayPassive",value:function(){this.gameplayVals=new Oi,this.levelVals=new Pi}},{key:"_stateUpdate_gameplayPassive",value:function(){}},{key:"_stateEnter_gameplayActive",value:function(){this.spawn_player_ball(),ib.SetTextWithZeroPad(Wa("gameplay_score_text"),this.gameplayVals.score,6);var e=pa.GetActorByAlias("player");if(e&&1==this.levelVals.level&&!Ia.hasSeenTutorial){var t=ga.GetBakedFromDef("gameplay_tutorial_hand",Wb);Sa(t,Sa(e)),_a(t,_a(e))}}},{key:"_stateUpdate_gameplayActive",value:function(e){var t=Jc(e),a=pa.GetBagItemsList(rb),r=(pa.GetBagItemsList("BRICKS"),Rb.GetPointerIfNotPressingButton());if(Ia.hasSeenTutorial||r&&r.isDown&&(this.levelVals.levelStarted=!0,ga.TriggerDisposeSafelyByAlias("gameplay_tutorial_hand")),r&&r.isDown)for(var $ in a){var o=a[$];0==xa(o).active&&(xa(o).active=!0,ua.GetBody(o).setVelocity(75,-500))}if(this.levelVals.levelStarted&&!this.levelVals.levelEnded){this.levelVals.activeLevelTime+=t;var i=pa.GetActorByAlias("player");for(var l in i&&!this.levelVals.levelEnded&&Ni.Update(t),a){var n=a[l];xa(n).active&&(ba.IsActorOnScreen(n)||ga.TriggerDisposeSafely(n))}ed.Update(t),this.levelVals.playerCannonTime>0&&(this.levelVals.playerCannonTime-=t),this.levelVals.playerCannonTime<=0&&this.setPlayerTurretsState(!1),Cb("BRICKS").countActive()<=0&&this.level_won(),a.length<=0&&this.kill_player_game_over()}}},{key:"add_to_score",value:function(e){this.gameplayVals.score+=e,ib.SetTextWithZeroPad(Wa("gameplay_score_text"),this.gameplayVals.score,6)}},{key:"level_won",value:function(){this.levelVals.levelEnded||(this.levelVals.levelEnded=!0,this.levelVals.level+=1,ja.RunCommand("DoPlayNewLevel"),wa.PlayAudio(Phaser.Utils.Array.GetRandom(["New_Bricks"]),.15))}},{key:"kill_player_game_over",value:function(){1!=this.levelVals.levelEnded&&(this.levelVals.levelEnded=!0,wa.PlayAudio(Phaser.Utils.Array.GetRandom(["Time_Out"]),.3),da.EnterState(jd))}},{key:"spawn_player_ball",value:function(){var e=ga.GetBakedFromDef("ball",Ka),t=pa.GetActorByAlias("player");return Sa(e,Sa(t)),_a(e,850),ua.GetBody(e).setBounce(1,1),e}},{key:"downscale_ball",value:function(e){this.levelVals.level<=1?Ub(e)>.9&&Ub(e,Ub(e)-.05):Ub(e)>.7&&Ub(e,Ub(e)-.05)}},{key:"setPlayerTurretsState",value:function(e){var t=pa.GetActorByAlias("player"),a=bf.GetChildrenList(t);for(var r in a){var $=a[r].actor;e?(ba.SetVisible($,!0),ed.SetEnabled($,!0)):(ba.SetVisible($,!1),ed.SetEnabled($,!1))}}},{key:"collide_ball_vs_paddle",value:function(e,t){var a=ba.GetActorFromDisplayObject(e),r=0;e.x<t.x?(r=t.x-e.x,ua.GetBody(a).setVelocityX(-8*r)):e.x>t.x?(r=e.x-t.x,ua.GetBody(a).setVelocityX(8*r)):ua.GetBody(a).setVelocityX(2+8*Math.random());var $=1/a.displayed.scale*-200;this.levelVals.level<=1&&($+=50),ua.GetBody(a).setVelocityY(-500+$);ba.GetActorFromDisplayObject(t),pa.GetBagItemsList(rb);wa.PlayAudio(Phaser.Utils.Array.GetRandom(["Ball_Hit_Wall_1","Ball_Hit_Wall_2"]))}},{key:"collide_ball_vs_wall",value:function(e,t){this.downscale_ball(ba.GetActorFromDisplayObject(e)),wa.PlayAudio(Phaser.Utils.Array.GetRandom(["Ball_Hit_Wall_1","Ball_Hit_Wall_2"]))}},{key:"brickParticle",value:function(e){console.log();var t="";t=5==xa(e).lives?Phaser.Utils.Array.GetRandom(["Particle_Yellow_1","Particle_Yellow_2","Particle_Yellow_3"]):4==xa(e).lives?Phaser.Utils.Array.GetRandom(["Particle_Orange_1","Particle_Orange_2","Particle_Orange_3"]):3==xa(e).lives?Phaser.Utils.Array.GetRandom(["Particle_Yellow_1","Particle_Yellow_2","Particle_Yellow_3"]):2==xa(e).lives?Phaser.Utils.Array.GetRandom(["Particle_Green_1","Particle_Green_2","Particle_Green_3"]):Phaser.Utils.Array.GetRandom(["Particle_Blue_1","Particle_Blue_2","Particle_Blue_3"]);var a=ga.GetUnbakedFromDef("prefab_particle",Ka);a.vals.particle_emitter.texture=t,a.bake(),Fb.GetEmitter(a).setSpeed(300),Fb.GetEmitter(a).setPosition(Sa(e)+Phaser.Math.Between(-5,5),_a(e)+Phaser.Math.Between(-5,5)),Fb.GetEmitter(a).setEmitZone({source:new Phaser.Geom.Circle(0,0,20),type:"edge",quantity:60}),Fb.GetEmitter(a).explode(60)}},{key:"collide_ball_vs_brick",value:function(e,t){this.downscale_ball(ba.GetActorFromDisplayObject(e));var a=ba.GetActorFromDisplayObject(t);this.add_to_score(xa(a).lives),this.brickParticle(a),(xa(a).lives-=1)<=0&&(ua.DisableBody(a),ba.SetVisible(a,!1)),pc.ChangeAnimation(a,a.vals.data["texture_at_life_"+a.vals.data.lives]);var r=pa.GetBagItemsList("UPGRADES_BALLS"),$=pa.GetBagItemsList(rb),o=!1,i=!1,l=null;if(1==$.length&&r.length<=0&&this.levelVals.activeLevelTime<=10&&(o=!0),1==$.length&&this.levelVals.activeLevelTime>=10&&(o=Phaser.Math.Between(0,100)<20),2==$.length&&this.levelVals.activeLevelTime>=10&&(o=Phaser.Math.Between(0,100)<10),Phaser.Math.Between(0,100)<15&&(i=!0),i?l="upgrade_cannons":o&&(l="upgrade_extra_balls"),i||o){var n=ga.GetBakedFromDef(l,Ka);Sa(n,Sa(a)),_a(n,_a(a)),Eb.MoveTo(n,Sa(n),_a(n)+2e3,180)}wa.PlayAudio(Phaser.Utils.Array.GetRandom(["Hit_Brick_4b","Hit_Brick_4a","Hit_Brick_3b","Hit_Brick_3a","Hit_Brick_2b","Hit_Brick_2a","Hit_Brick_1b","Hit_Brick_1a"]),.25)}},{key:"collide_bullet_vs_brick",value:function(e,t){var a=ba.GetActorFromDisplayObject(e),r=ba.GetActorFromDisplayObject(t);this.add_to_score(xa(r).lives),this.brickParticle(r),(xa(r).lives-=1)<=0&&(ua.DisableBody(r),ba.SetVisible(r,!1)),pc.ChangeAnimation(r,r.vals.data["texture_at_life_"+r.vals.data.lives]),ga.TriggerDisposeSafely(a),wa.PlayAudio(Phaser.Utils.Array.GetRandom(["Hit_Brick_4b","Hit_Brick_4a","Hit_Brick_3b","Hit_Brick_3a","Hit_Brick_2b","Hit_Brick_2a","Hit_Brick_1b","Hit_Brick_1a"]),.25)}},{key:"overlap_paddle_vs_upgrades",value:function(e,t){if(!this.levelVals.levelEnded){ba.GetActorFromDisplayObject(e);var a=ba.GetActorFromDisplayObject(t);if(ga.TriggerDisposeSafely(a),"cannons"==xa(a).type)this.levelVals.playerCannonTime=6,this.setPlayerTurretsState(!0);else if("balls"==xa(a).type){var r=this.spawn_player_ball();xa(r).active=!0,ua.GetBody(r).setVelocity(Phaser.Math.Between(-75,75),-500)}wa.PlayAudio(Phaser.Utils.Array.GetRandom(["CollectShell"]))}}},{key:"debugFps",value:function(e){ib.SetTextWithZeroPad(Wa("cover_score_text"),Phaser.Math.CeilTo(1e3/e),6),ib.SetTextWithZeroPad(Wa("gameplay_score_text"),Phaser.Math.CeilTo(1e3/e),6)}}]),a}();window.addEventListener("load",function(){Tb.disableFakeMusicPreload=!1,ia.Run(qs)});return{"epB2":{}};});
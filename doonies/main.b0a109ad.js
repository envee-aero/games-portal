parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"mOOU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CST=void 0,exports.CST={SCENES:{LOAD:"LOAD",MENU:"MENU",PHYSICS:"PHYSICS"},IMAGE:{LOGO:"logo.png",OPTIONS:"options_button.png",PLAY:"play_button.png",TAP:"Tap_0002.png",AIMHERE:"AimHereArrow.png",TITLE:"title_bg.jpg",DOONIES_TITLE:"Doonies_Title.png",BLACK_CRAYON:"Obstacle_BlackCrayon.png",BLACK_CRAYON_SHADOW:"ObstacleShadow_BlackCrayon.png",DLUGOPIS:"Obstacle_Dlugopis.png",DLUGOPIS_SHADOW:"ObstacleShadow_Dlugopis.png",SHARPENER:"Obstacle_Sharpener.png",SHARPENER_SHADOW:"ObstacleShadow_Sharpener.png",OBSTACLE_PENCIL:"Obstacle_Pencil.png",OBSTACLE_SHADOW_PENCIL:"ObstacleShadow_Pencil.png",OBSTACLE_PINEZKA:"Pinezka.png",OBSTACLE_JABZO:"Jabzo.png",OBSTACLE_KAPSEL:"Kapsel.png",OBSTACLE_ERASER:"Eraser",MONKEY:"Monkey.png",BUNNY:"Krolik.png",MAD_SCIENTIST:"MadScientist.png",CLOUD:"Chmurka.png",CARROTS:"Marchewki.png",VULTURES:"Sepy.png",SNAIL:"Slimak.png",KING_KONG:"KingKong.png",ROCKET:"Rakieta.png",PLANE2:"Samolot2.png",GHOST:"Upior.png",BALL_SHADOW:"BallShadow.png",PAPER_BG:"PaperBG.png",RULER:"OgraniczenieBoku.png",STAR:"Star.png"},AUDIO:{MARBLE_HIT1:"marble_hit1.ogg",MARBLE_HIT2:"marble_hit2.ogg",MARBLE_HIT3:"marble_hit3.ogg",PUCK:"puck.ogg",TURUM:"turum.ogg",SMASH:"glasssmash.ogg",SWOOSH:"swoosh.ogg",ROLL:"marbleroll.ogg",SAW:"saw_single.ogg",MUSIC:"dooniesmusic.ogg"},AUDIOIOS:{MARBLE_HIT1:"marble_hit1.m4a",MARBLE_HIT2:"marble_hit2.m4a",MARBLE_HIT3:"marble_hit3.m4a",PUCK:"puck.m4a",TURUM:"turum.m4a",SMASH:"glasssmash.m4a",SWOOSH:"swoosh.m4a",ROLL:"marbleroll.m4a",SAW:"saw_single.m4a",MUSIC:"dooniesmusic.m4a"}};
},{}],"jvKT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Ball=void 0;var e=function(){return function(e,s,t,l,i,a,r){void 0===a&&(a=""),void 0===r&&(r=""),this.dir=0,this.angle=0,this.prevAngle=0,this.fallSpeed=0,this.lastX=0,this.lastY=0,this.ballShadow=e.make.sprite({x:s-e.m_layer_cover22.x,y:t-e.m_layer_cover22.y+20,key:l,frame:r}),this.ballPhys=e.matter.add.sprite(s,t,l,i),this.ballPhys.setVisible(!1),this.ballSensor=e.matter.add.sprite(s,t,l,i),this.ballSensor.setVisible(!1),this.ballAnim=e.make.sprite({x:s-e.m_layer_cover22.x,y:t-e.m_layer_cover22.y,key:l,frame:i}),this.lastX=this.ballPhys.x,this.lastY=this.ballPhys.y,""!=a&&this.ballAnim.play(a)}}();exports.Ball=e;
},{}],"YVm7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ButtonManager=void 0;var e=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=new e,e.instance.tweenArr=[]),e.instance},e.prototype.clearTweens=function(){for(var e in console.log("clearTweens"),this.tweenArr)e instanceof Phaser.Tweens.Tween&&e.remove();this.tweenArr.length=0},e.prototype.setupTween=function(e,t,n,o,r){e.x=e.x-n,e.y=e.y-o;var a=t.add.tween({targets:e,x:e.x+n,y:e.y+o,duration:r,ease:"Cubic",onComplete:this.onDefComplete});this.tweenArr.push(a)},e.prototype.setupAlphaTween=function(e,t,n,o,r){var a;return void 0===r&&(r=0),a=void 0!==this.onStartCallback?t.add.tween({targets:e,alpha:n,duration:o,ease:"Cubic",delay:r,onStart:this.onStartCallback,onComplete:this.onDefComplete}):t.add.tween({targets:e,alpha:n,duration:o,ease:"Cubic",delay:r,onComplete:this.onDefComplete}),this.tweenArr.push(a),a},e.prototype.onDefComplete=function(t){e.getInstance().tweenArr.splice(e.getInstance().tweenArr.indexOf(t),1),t.remove()},e.prototype.setupButton=function(e,t){e.setInteractive(),e.on("pointerover",e.onPointerOver=function(e,t,n,o){},e),e.on("pointerout",e.onPointerOut=function(){this.anims.previousFrame()},e),e.on("pointerdown",function(){e.anims.nextFrame()},e)},e}();exports.ButtonManager=e;
},{}],"qMkz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MovingObject=void 0;var t=require("./LevelFactory"),s=require("./ButtonManager"),e=function(){function e(e,i,o,h,a,n,r,y){void 0===r&&(r=""),void 0===y&&(y=""),this.dir=0,this.angle=0,this.speed=0,this.angularVelocity=0,this.circleMove=!1,this.cMoveX=0,this.cMoveY=0,this.destX=0,this.destY=0,this.destAng=0,this.radiant=-1,this.startX=0,this.startY=0,this.fixedX=!1,this.fixedY=!1,this.lastX=0,this.lastY=0,console.log("mo x:"+String(i)+" y: "+String(o)),this.objShadow=e.make.sprite({x:i-e.m_layer_cover22.x,y:o+20-e.m_layer_cover22.y,key:h,frame:y}),n.frictionAir=900,this.startX=i,this.startY=o,this.lastX=i,this.lastY=o,e.m_layer_cover22.add(this.objShadow),this.objSkin=e.make.sprite({x:i-e.m_layer_cover22.x,y:o-e.m_layer_cover22.y,key:"balls",frame:a}),e.m_layer_cover22.add(this.objSkin),"circle"==n.shape&&"Jabzo"!=a?(this.objPhys=e.matter.add.sprite(i,o,h,a),this.objPhys.setBody({type:n.shape,radius:n.radius},{}),this.objPhys.setData("isEnemy",!0),this.objPhys.setCollisionCategory(t.LevelFactory.getInstance().cat1),this.objPhys.setCollidesWith(t.LevelFactory.getInstance().cat3)):this.objPhys=e.matter.add.sprite(i,o,h,a,n),this.objPhys.setData("skin",this.objSkin),this.objPhys.setFrictionAir(5e-4),this.objPhys.setDensity(1e6),this.objPhys.setCollisionCategory(t.LevelFactory.getInstance().cat2),this.objPhys.setVisible(!1),""!=r&&this.objPhys.play(r),this.objShadow.x>0?(s.ButtonManager.getInstance().setupTween(this.objShadow,e,this.objShadow.x-500,this.objShadow.y,600),s.ButtonManager.getInstance().setupTween(this.objSkin,e,this.objSkin.x-500,this.objSkin.y,600)):(s.ButtonManager.getInstance().setupTween(this.objShadow,e,this.objShadow.x+500,this.objShadow.y,600),s.ButtonManager.getInstance().setupTween(this.objSkin,e,this.objSkin.x+500,this.objSkin.y,600))}return e.prototype.scale=function(t,s){this.objPhys.setScale(t,s),this.objShadow.setScale(t,s),this.objSkin.setScale(t,s)},e.prototype.setAngle=function(t){this.objPhys.setAngle(t),this.objShadow.setAngle(t),this.objSkin.setAngle(t),this.angle=t},e.prototype.destroy=function(){this.objPhys.destroy(),this.objShadow.destroy(),this.objSkin.destroy()},e}();exports.MovingObject=e;
},{"./LevelFactory":"0Zwn","./ButtonManager":"YVm7"}],"4mTs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SoundPlayer=void 0;var e=function(){function e(){this.isMusicPlaying=!1,this.musicStarted=!1,this.wasMusicPlaying=!1,this.markersMap={},this.wasMuted=!1,this.sounds={},this.soundConfigs={},this.debugMode=!1,this.focusListenersAdded=!1}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.setSoundEnabled=function(e){this.isMusicPlaying=e,window.localStorage.setItem("dnsSoundEnabled",this.isMusicPlaying?"true":"false")},e.prototype.loadSoundEnabled=function(){this.isMusicPlaying="false"!=window.localStorage.getItem("dnsSoundEnabled")},e.prototype.onFocusMute=function(){this.wasMusicPlaying=this.isMusicPlaying,this.currentScene.game.sound.stopAll()},e.prototype.onFocusResumeUnmute=function(){this.isMusicPlaying=this.wasMusicPlaying,this.wasMusicPlaying&&(this.playSound("dooniesmusic",{volume:.5}),void 0!==this.currentScene.playerBall&&Math.abs(this.currentScene.playerBall.ballPhys.body.velocity.x)+Math.abs(this.currentScene.playerBall.ballPhys.body.velocity.y)>0&&this.playSound("marbleroll",{volume:.5})),this.wasMusicPlaying=!1},e.prototype.setRate=function(e,s){this.sounds[e]&&this.sounds[e].setDetune(3e3*s-3e3)},e.prototype.setVolume=function(e,s){this.sounds[e]&&this.sounds[e].setVolume(s)},e.prototype.stopSound=function(e){console.log("stop sound: "+e),this.sounds[e]&&this.sounds[e].pause()},e.prototype.playSound=function(e,s){if(void 0===s&&(s=null),console.log("play sound: "+e),this.isMusicPlaying){this.debugMode&&(window.input.defaultValue=window.input.defaultValue+" playsound ");try{this.currentScene.isIE11&&!this.currentScene.isIOS&&"music"==e&&(void 0!==s?this.currentScene.sound.playAudioSprite("sfx",e,s):this.currentScene.sound.playAudioSprite("sfx",e)),!this.currentScene.isIE11&&this.musicStarted&&("music"==e?this.currentScene.sound.play(e,this.soundConfigs[e]):this.currentScene.isIOS||this.sounds[e].play())}catch(t){this.debugMode&&(window.input.defaultValue=window.input.defaultValue+" ps error "+t.message)}}},e.prototype.addSound=function(e,s,t){void 0===s&&(s=1),void 0===t&&(t=!1);var i=this.currentScene;this.sounds[e]=i.game.sound.add(e,{volume:s,loop:t}),this.soundConfigs[e]={volume:s,loop:t}},e.prototype.create=function(){this.debugMode&&(window.input.defaultValue=window.input.defaultValue+" soundsPlayer create1 "),this.currentScene.isIE11||(this.currentScene.debugMode&&(window.input.defaultValue=window.input.defaultValue+" isIE11 false "),window.isIOS&&this.currentScene.debugMode&&(window.input.defaultValue=window.input.defaultValue+" isIOS true "),this.addSound("marble_hit1"),this.addSound("marble_hit2",.7),this.addSound("marble_hit3"),this.addSound("puck"),this.addSound("glasssmash"),this.addSound("swoosh"),this.addSound("saw_single"),this.addSound("marbleroll",.4,!0),this.addSound("dooniesmusic",.4,!0),this.decodedCallback=function(){this.decodedAll=!0,console.log("decodedCallback")}),this.debugMode&&console.log("sounds player create"),this.musicStarted=!1,this.isMusicPlaying=!1,this.loadSoundEnabled(),this.debugMode&&(window.input.defaultValue=window.input.defaultValue+" soundsPlayer create2 ")},e.prototype.decodedCallback=function(e){console.log("decodedCallback"),this.decodedAll=!0,this.debugMode&&console.log("decodedCallback")},e}();function s(e){console.log("wdecodedCallback")}exports.SoundPlayer=e;
},{}],"0qTL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Utils=void 0;var e=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.shuffleArray=function(e){for(var a=e.length-1;a>0;a--){var r=Math.floor(Math.random()*(a+1)),t=e[a];e[a]=e[r],e[r]=t}},e.getLocalX=function(e,a){return("number"==typeof e?e:e.x/a.m_layer_basic.scale)-a.m_layer_basic.x-a.m_layer_cover22.x},e.getGlobalX=function(e,a){return("number"==typeof e?e*a.m_layer_basic.scale:e.x*a.m_layer_basic.scale)+a.m_layer_basic.x+a.m_layer_cover22.x*a.m_layer_basic.scale},e.getGlobalY=function(e,a){return("number"==typeof e?e*a.m_layer_basic.scale:e.y*a.m_layer_basic.scale)+a.m_layer_basic.y+a.m_layer_cover22.y*a.m_layer_basic.scale},e}();exports.Utils=e;
},{}],"0Zwn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LevelFactory=void 0;var t=require("../model/Ball"),e=require("./MovingObject"),a=require("./ButtonManager"),s=require("./SoundPlayer"),i=require("../utils/Utils"),r=require("./ResizeManager"),n=function(){function n(){this.debugObstacles=[],this.movingObstacles=[],this.staticObstacles=[],this.cat1=-1,this.cat2=-1,this.cat3=-1,this.hardModeLevel=15,this.gsx=1,this.gsy=.9375,this.deltaY=0}return n.getInstance=function(){return void 0===n.instance&&(n.instance=new n),n.instance},n.prototype.onHTPTweenComplete=function(t){console.log("onHTPTweenComplete");var e=n.getInstance().scene;e.howToPlay.setPosition(e.targetHoleSkin.x,e.targetHoleSkin.y),n.getInstance().scene.tweenHTP.remove(),e.tweenHTP=e.add.tween({targets:e.howToPlay,x:e.playerBall.ballAnim.x,y:e.playerBall.ballAnim.y,duration:1e3,ease:"Cubic",onComplete:this.onHTPTweenComplete})},n.prototype.createPhysicsScene=function(t){console.log("createPhysicsScene"),s.SoundPlayer.getInstance().currentScene=t,s.SoundPlayer.getInstance().musicStarted=!0,this.scene=t,t.mouseStartX=0,t.shotPointers=[],r.ResizeManager.FITMODE||r.ResizeManager.RESIZEMODE?t.matter.world.setBounds(-1300,-1200,3600,6e3).disableGravity():t.matter.world.setBounds(-300,-200,2400,4e3).disableGravity(),n.getInstance().cleanLevel(),t.m_layer_basic=t.make.container({},!0),r.ResizeManager.FITMODE&&(t.m_layer_basic.x=300),t.m_layer_cover22=t.make.container({},!1),t.m_layer_cover00=t.make.container({},!1),t.m_layer_cover33=t.make.container({},!1),t.m_layer_cover22Top=t.make.container({},!1),t.m_layer_basic.add(t.m_layer_cover00),t.m_layer_basic.add(t.m_layer_cover22),t.m_layer_basic.add(t.m_layer_cover33),t.m_layer_basic.add(t.m_layer_cover22Top),-1==this.cat1&&(this.cat1=t.matter.world.nextCategory(),this.cat2=t.matter.world.nextCategory(),this.cat3=t.matter.world.nextCategory()),r.ResizeManager.FITMODE?(t.bg1=t.make.image({x:0,y:512,key:"PaperBG.png"},!1),t.bg2=t.make.image({x:850,y:512,key:"PaperBG.png"},!1),t.bg3=t.make.image({x:-850,y:512,key:"PaperBG.png"},!1)):(console.log("set bg pos"),t.bg1=t.make.image({x:0,y:0,key:"PaperBG.png"},!1),t.bg2=t.make.image({x:850,y:0,key:"PaperBG.png"},!1),t.bg3=t.make.image({x:-850,y:0,key:"PaperBG.png"},!1)),t.bg1.active=!0,t.bg2.active=!0,t.bg3.active=!0,t.m_layer_cover22.add(t.bg1),t.m_layer_cover22Top.add(t.bg2),t.m_layer_cover22Top.add(t.bg3),window.game=t.game,t.game.curSceneRef=t;window.game.canvas.getBoundingClientRect();(r.ResizeManager.NONEMODE||r.ResizeManager.RESIZEMODE)&&(t.scale.on("resize",function(t){window.game.canvas.getBoundingClientRect()},t),r.ResizeManager.getInstance().resize(t.game.canvas.width,t.game.canvas.height,t)),console.log("bg1 y: "+t.bg1.y),console.log("scene.m_layer_cover22Top y: "+t.m_layer_cover22Top.y),console.log("scene.m_layer_basic y: "+t.m_layer_basic.y)},n.prototype.createUI=function(t){t.scoreText=t.make.bitmapText({x:-280,y:-460,font:"obelixpro",text:"0",size:63,align:0,add:!1},!1),console.log(t.scoreText),t.m_layer_cover22Top.add(t.scoreText),t.pauseBtn=t.make.sprite({x:150,y:-440,key:"balls",frame:"Btn_Pause"}).play("pauseBtnAnim"),t.m_layer_cover22Top.add(t.pauseBtn),t.pauseBtn.anims.pause(),s.SoundPlayer.getInstance().isMusicPlaying||t.pauseBtn.anims.nextFrame(),t.pauseBtnShape=t.pauseBtn.getBounds(),t.buttonShapes.push(t.pauseBtnShape),t.pauseBtn.setInteractive(),t.pauseBtn.on("pointerup",function(){console.log("pause button clicked"),t.gotoPause()}),t.musicBtn=t.make.sprite({x:250,y:-440,key:"balls",frame:"MusicOff"}).play("soundBtnAnim"),t.m_layer_cover22Top.add(t.musicBtn),t.musicBtn.anims.pause(),s.SoundPlayer.getInstance().isMusicPlaying||t.musicBtn.anims.nextFrame(),t.soundSwitchBtnShape=t.musicBtn.getBounds(),t.buttonShapes.push(t.soundSwitchBtnShape),t.musicBtn.setInteractive(),t.musicBtn.on("pointerup",function(){t.soundSwitchBtnShape=t.musicBtn.getBounds();var e=s.SoundPlayer.getInstance();e.setSoundEnabled(!e.isMusicPlaying),e.isMusicPlaying?(e.playSound("dooniesmusic",{volume:.5}),console.log("unmute veloc: "+t.playerBall.ballPhys.body.velocity.x),Math.abs(t.playerBall.ballPhys.body.velocity.x)+Math.abs(t.playerBall.ballPhys.body.velocity.y)>0&&e.playSound("marbleroll",{volume:.5})):t.sound.stopAll(),e.playSound("puck",{volume:.5}),e.isMusicPlaying?t.musicBtn.anims.previousFrame():t.musicBtn.anims.nextFrame()})},n.prototype.createBackground=function(t,e){var s=0,r=0,n=["Monkey","MadScientist","Krolik","Marchewki","Sepy","Slimak","KingKong","Rakieta","Samolot2","Upior","Samolot1"];i.Utils.shuffleArray(n);for(var l=0;l<6;l++){var o=.5+.25*Math.random(),h=this.startPX+100+400*Math.random(),c=n.pop();"Krolik"!=c&&"KingKong"!=c&&"MadScientist"!=c||(o=.4+.15*Math.random()),0!=r&&(h=this.startPX+r,r=-1,o=.5);var m=e.make.sprite({x:h-e.m_layer_cover22.x,y:100-e.m_layer_cover22.y+s,key:"balls",frame:c});o*=.9,m.setScale(o,o),m.alpha=0,m.setAngle(30*Math.random()-15),e.m_layer_cover22.add(m),-1==r?(r=0,s=m.y+m.height/2+0+e.m_layer_cover22.y):m.width<400?(h<this.startPX+300?(m.x=this.startPX+100+50*Math.random()-e.m_layer_cover22.x,r=400):(m.x=this.startPX+350+100*Math.random()-e.m_layer_cover22.x,r=100),l--):(r=0,s=m.y+m.height/2-20+e.m_layer_cover22.y),a.ButtonManager.getInstance().setupAlphaTween(m,e,.6,900)}},n.prototype.createLine=function(t,e,s,i){var n=-300;r.ResizeManager.FITMODE&&e==i&&(t-=600,n=-1e3);for(var l=Phaser.Math.Distance.Between(t,e,s,i),o=(s-t)/l,h=(i-e)/l,c=0,m=0;m<25;m++)if(t-this.scene.m_layer_cover22.x+m*o*80>n&&t-this.scene.m_layer_cover22.x+m*o*80<700&&e-this.scene.m_layer_cover22.y+m*h*80<1100&&e-this.scene.m_layer_cover22.y+m*h*80>-600){var d=this.scene.make.sprite({x:t-this.scene.m_layer_cover22.x+m*o*80,y:e-this.scene.m_layer_cover22.y+m*h*80,key:"balls",frame:"ElementLiniPoKtorejCosJezdzi"});this.scene.m_layer_cover22.add(d),d.alpha=0,d.setAngle(180*Phaser.Math.Angle.Between(t,e,s,i)/Math.PI),a.ButtonManager.getInstance().setupAlphaTween(d,this.scene,1,500,20*c),c+=1}},n.prototype.createCircle=function(t,e,s){for(var i=0;i<15;i++){var r=this.scene.make.sprite({x:t-this.scene.m_layer_cover22.x+Math.cos(2*Math.PI*i/15)*s,y:e-this.scene.m_layer_cover22.y+Math.sin(2*Math.PI*i/15)*s,key:"balls",frame:"ElementLiniPoKtorejCosJezdzi"});r.setAngle(360*i/15+90),this.scene.m_layer_cover22.add(r),r.alpha=0,a.ButtonManager.getInstance().setupAlphaTween(r,this.scene,1,500,20*i)}},n.prototype.createSharpener=function(t,e,a,s,i,r){return void 0===r&&(r=!0),this.createShadowSprite("Obstacle_Sharpener","ObstacleShadow_Sharpener",{shape:this.shapes.Obstacle_Sharpener},t,e,a,s,i,!0)},n.prototype.createBlackCrayon=function(t,e,a,s,i,r){return void 0===r&&(r=!0),this.createShadowSprite("Obstacle_BlackCrayon","ObstacleShadow_BlackCrayon",{shape:this.shapes.Obstacle_BlackCrayon},t,e,a,s,i,!0)},n.prototype.createPen=function(t,e,a,s,i,r){return void 0===r&&(r=!0),this.createShadowSprite("Obstacle_Dlugopis","ObstacleShadow_Dlugopis",{shape:this.shapes.Obstacle_Pen},t,e,a,s,i,!0)},n.prototype.createPencil=function(t,e,a,s,i,r){return void 0===r&&(r=!0),this.createShadowSprite("Obstacle_Pencil","ObstacleShadow_Pencil",{shape:this.shapes.Obstacle_Pencil},t,e,a,s,i,!0)},n.prototype.createCap=function(t,e,a,s,i,r){return void 0===r&&(r=!0),this.createShadowSprite("Kapsel","Kapsel_Cien",{shape:"circle",radius:50},t,e,a,s,i,!0)},n.prototype.createPin=function(t,e,a,s,i,r){return void 0===r&&(r=!0),this.createShadowSprite("Pinezka","",void 0,t,e,a,s,i,!0)},n.prototype.createRotatingEraser=function(t,a,s){void 0===s&&(s=NaN);var i=(.04+.08*Math.random())*(.5+Math.min(.5,this.scene.levelNum/15));Math.random()<.5&&(i=-i),NaN!=s&&(i=s),this.movingObstacle=new e.MovingObject(this.scene,t,a,"balls","Eraser",{shape:this.shapes.Obstacle_Eraser},"","EraserShadow"),this.movingObstacle.speed=0,this.movingObstacle.startY=this.movingObstacle.objPhys.y,this.movingObstacle.startX=this.movingObstacle.objPhys.x,this.movingObstacle.objPhys.setStatic(!1),this.movingObstacle.scale(.9,.9),this.movingObstacle.setAngle(90),this.movingObstacle.angularVelocity=i;var r=this.scene.matter.add.sprite(t,a,"balls","Eraser");r.setCircle(1),r.setFrictionAir(5e-4),r.setDensity(1e6),r.setCollidesWith(0),r.setVisible(!1),r.setStatic(!0),this.scene.matter.add.joint(r.body,this.movingObstacle.objPhys.body,0,.999),this.movingObstacle.objPhys.setAngularVelocity(this.movingObstacle.angularVelocity),this.movingObstacles.push(this.movingObstacle),this.createShadowSprite("Pinezka","",void 0,t-10,a-10,-43.390087,.8,.8,!0).setCollidesWith(0)},n.prototype.createShadowSprite=function(t,e,s,i,r,n,l,o,h){if(void 0===h&&(h=!0),""!=e){var c=this.scene.make.sprite({x:i-this.scene.m_layer_cover22.x,y:r-this.scene.m_layer_cover22.y+20,key:"balls",frame:e});c.setScale(l,o),"Jabzo"==t&&c.setScale(1.7*l,1.7*o),c.setAngle(n),this.scene.m_layer_cover22.add(c);for(var m=0;m<7;m++)this.scene.children.moveDown(c);c.x>0?a.ButtonManager.getInstance().setupTween(c,this.scene,c.x-500,c.y,600):a.ButtonManager.getInstance().setupTween(c,this.scene,c.x+500,c.y,600)}var d;s&&"circle"==s.shape?((d=this.scene.matter.add.sprite(i,r,"balls",t)).setBody({type:s.shape,radius:s.radius},{}),d.setData("isEnemy",!0),d.setCollisionCategory(this.cat1)):d=this.scene.matter.add.sprite(i,r,"balls",t,s),d.setScale(l,o),d.setAngle(n),d.setStatic(h),d.setVisible(!1);var y=this.scene.make.sprite({x:i-this.scene.m_layer_cover22.x,y:r-this.scene.m_layer_cover22.y,key:"balls",frame:t});return s&&"circle"==s.shape&&d.setData("isEnemy",!0),y.setScale(l,o),y.setAngle(n),d.setData("skin",y),this.scene.m_layer_cover22.add(y),y.x>0?a.ButtonManager.getInstance().setupTween(y,this.scene,y.x-500,y.y,600):a.ButtonManager.getInstance().setupTween(y,this.scene,y.x+500,y.y,600),d},n.prototype.initCircleMove=function(t,e,a){t.circleMove=!0,t.cMoveX=e,t.cMoveY=a},n.prototype.initMovingObstacle=function(t,e,a,s,i,r,n,l){void 0===s&&(s=NaN),void 0===i&&(i=NaN),void 0===r&&(r=NaN),void 0===n&&(n=NaN),void 0===l&&(l=NaN),NaN!=s&&(t.speed=s),t.fixedY=e,NaN!=i&&(t.startY=i),t.objPhys.setStatic(a),NaN!=r&&t.setAngle(r),NaN!=n&&NaN!=l&&t.objPhys.setVelocity(n,l),this.movingObstacles.push(t)},n.prototype.createShapes=function(){this.shapes={Obstacle_Pencil:{type:"fromPhysicsEditor",label:"op",isStatic:!1,density:.1,restitution:.1,friction:.1,frictionAir:.01,frictionStatic:.5,collisionFilter:{group:0,category:this.cat1,mask:255},fixtures:[{label:"op-fixture",isSensor:!1,vertices:[[{x:30,y:0},{x:60,y:104},{x:60,y:828},{x:32,y:836},{x:12,y:836},{x:2,y:828},{x:0,y:104}]]}]},Obstacle_BlackCrayon:{type:"fromPhysicsEditor",label:"obc",isStatic:!1,density:.1,restitution:.1,friction:.1,frictionAir:.01,frictionStatic:.5,collisionFilter:{group:0,category:this.cat1,mask:255},fixtures:[{label:"obc-fixture",isSensor:!1,vertices:[[{x:25,y:40},{x:42,y:131},{x:42,y:345},{x:0,y:345},{x:0,y:130},{x:20,y:40}]]}]},Obstacle_Sharpener:{type:"fromPhysicsEditor",label:"os",isStatic:!1,density:.1,restitution:.1,friction:.1,frictionAir:.01,frictionStatic:.5,collisionFilter:{group:0,category:this.cat1,mask:255},fixtures:[{label:"os-fixture",isSensor:!1,vertices:[[{x:0,y:0},{x:106,y:0},{x:106,y:40},{x:95,y:83},{x:106,y:130},{x:106,y:173},{x:0,y:173},{x:0,y:130},{x:11,y:83}]]}]},Obstacle_Pen:{type:"fromPhysicsEditor",label:"pen",isStatic:!1,density:.1,restitution:.1,friction:.1,frictionAir:.01,frictionStatic:.5,collisionFilter:{group:0,category:this.cat1,mask:255},fixtures:[{label:"pen-fixture",isSensor:!1,vertices:[[{x:45,y:0},{x:96,y:143},{x:96,y:210},{x:76,y:310},{x:84,y:351},{x:70,y:360},{x:69,y:543},{x:42,y:900},{x:28,y:900},{x:0,y:543},{x:0,y:240},{x:21,y:0}]]}]},Obstacle_Eraser:{type:"fromPhysicsEditor",label:"eraser",isStatic:!1,density:.1,restitution:.1,friction:.1,frictionAir:.01,frictionStatic:.5,collisionFilter:{group:0,category:this.cat1,mask:255},fixtures:[{label:"eraser-fixture",isSensor:!1,vertices:[[{x:10,y:9},{x:138,y:3},{x:267,y:9},{x:272,y:43},{x:267,y:76},{x:137,y:82},{x:10,y:75},{x:6,y:43}]]}]},Kapsel:{shape:"circle",radius:50}}},n.prototype.createLevel=function(s,i){var r=this.gsy;this.deltaY=(2*i.m_layer_cover22.y-960)/2,this.deltaY=Math.max(0,this.deltaY);var n=this.deltaY;console.log("deltay: "+n),this.movingObstacles.length=0,this.scene=i,this.createBackground(s,i),this.createUI(i);var l=0,o=0,h=0,c=0;if(this.createShapes(),1==s&&(l=this.startPX+170+210*Math.random(),o=650*r+120*Math.random()*r+n*r,h=this.startPX+180+190*Math.random(),c=180*r+120*Math.random()*r+n*r,this.createPencil(this.startPX+118.95575,881.64886*r+n*r,-43.390087,.7,.36679804,!0),this.createPencil(this.startPX+141.6022,127.39376*r+n*r,44.14919,.7,.41076127,!0),this.createPencil(this.startPX+495.70593,139.04239*r+n*r,144.4281,.7,.34991884,!0),this.createPencil(this.startPX+473.59125,886.0783*r+n*r,-141.51344,.7,.3953076,!0)),2==s&&(l=this.startPX+150+250*Math.random(),o=600*r+150*Math.random()*r+n*r,h=this.startPX+150+250*Math.random(),c=200*r+200*Math.random()*r+n*r,this.createPencil(this.startPX+118.95575,881.64886*r+n*r,-43.390087,.65685165,.36679804,!0),this.createPencil(this.startPX+495.70593,139.04239*r+n*r,144.4281,.7,.34991884,!0)),3==s){var m,d;m=360*Math.random(),d=70+10*Math.random(),l=this.startPX+300,o=770*r+n*r,h=this.startPX+300+d*Math.cos(m/180*Math.PI),c=260*r+d*Math.sin(m/180*Math.PI)+n*r,this.createPencil(this.startPX+141.6022,127.39376*r+n*r,44.14919,.7,.41076127,!0),this.createPencil(this.startPX+473.59125,886.0783*r+n*r,-141.51344,.7,.3953076,!0);var y=Math.floor(3.9999*Math.random()),g=60+60*Math.random();Math.random()<.5&&(g=240+60*Math.random()),0==y&&this.createSharpener(this.startPX+300.59125,500.0783*r+n*r,g,1,1,!0),1==y&&this.createBlackCrayon(this.startPX+300.59125,500.0783*r+n*r,g,1,1,!0),2==y&&this.createPen(this.startPX+300.59125,500.0783*r+n*r,g,.3,.3,!0),3==y&&this.createPencil(this.startPX+300.59125,500.0783*r+n*r,g,.4,.4,!0)}if(4==s){Math.random()<.5?(l=this.startPX+80+60*Math.random(),o=520*r+250*Math.random()*r+n*r,h=this.startPX+420+130*Math.random(),c=220*r+550*Math.random()*r+n*r):(l=this.startPX+420+130*Math.random(),o=520*r+250*Math.random()*r+n*r,h=this.startPX+80+60*Math.random(),c=220*r+550*Math.random()*r+n*r);var M=this.startPX+300.59125,v=(o+c)/2-80+160*Math.random()*r;y=Math.floor(2.9999*Math.random()),g=30*Math.random()-15;0==y&&this.createBlackCrayon(M,v,g,1,1,!0),1==y&&this.createPen(M,v,g,.3,.3,!0),2==y&&this.createPencil(M,v,g,.4,.4,!0),this.scene.levelNum>this.hardModeLevel&&(o>500&&v>500&&this.createObstaclesInCircle((l+M)/2,200*r+n*r,1,100),o<500&&v<500&&this.createObstaclesInCircle((l+M)/2,850*r+n*r,1,100))}if(5==s){l=this.startPX+400+80*Math.random(),o=660+110*Math.random()+n*r,h=this.startPX+400+80*Math.random(),c=160+150*Math.random()+n*r,this.createPencil(this.startPX+40,c-30,45,.7,.41076127,!0),this.createPencil(this.startPX+40,o+30,-45,.9411074,.3953076,!0);v=550,this.createBlackCrayon(this.startPX+450.59125,v+n*r,-90,1.8,1.8,!0);this.scene.levelNum>this.hardModeLevel&&this.createObstaclesInCircle(h,c,1,120)}if(6==s){var b=(.04+.08*Math.random())*(.5+Math.min(.5,this.scene.levelNum/15));Math.random()<.5&&(b=-b),Math.random()<.5?(l=this.startPX+200+350*Math.random(),o=780*r+50*Math.random()*r+n*r,h=this.startPX+80+220*Math.random(),c=160*r+20*Math.random()*r+n*r,this.createBlackCrayon(this.startPX+40,c+(150+100*Math.random())*r,90,1,1,!0),this.scene.levelNum>this.hardModeLevel&&this.createRotatingEraser(this.startPX+550,c+(150+100*Math.random())*r,b),this.createBlackCrayon(this.startPX+550,o+(-150-100*Math.random())*r,-90,1.5,1.5,!0)):(l=this.startPX+80+220*Math.random(),o=780*r+50*Math.random()*r+n*r,h=this.startPX+200+350*Math.random(),c=160*r+20*Math.random()*r+n*r,this.createBlackCrayon(this.startPX+550,c+(150+100*Math.random())*r,-90,1,1,!0),this.scene.levelNum>this.hardModeLevel&&this.createRotatingEraser(this.startPX+40,c+(150+100*Math.random())*r,b),this.createBlackCrayon(this.startPX+40,o+(-150-100*Math.random())*r,90,1.5,1.5,!0))}if(7==s){l=this.startPX+100+450*Math.random(),h=this.startPX+100+450*Math.random();b=4+Math.floor(Math.random()*(.999+Math.min(12,this.scene.levelNum/2)));var p=1+Math.floor(Math.random()*(.999+Math.min(2,this.scene.levelNum/4)));this.scene.levelNum>this.hardModeLevel&&(p=4),Math.random()<.5&&(b=-b),c=(200+50*Math.random())*r+n*r,o=(700+80*Math.random())*r+n*r,this.createLine(0,500*r+n*r,100,500*r+n*r);for(var u=0;u<p;u++)this.movingObstacle=this.createMovingOfType(this.startPX-100+300*u,500.0783*r+n*r),this.initMovingObstacle(this.movingObstacle,!0,!1,b,this.movingObstacle.objPhys.y,90,1,0)}if(8==s){l=this.startPX+100+450*Math.random(),h=this.startPX+100+450*Math.random(),o=(P=(300+70*Math.random())*r+n*r)+(350+70*Math.random())*r,c=P+(-100-50*Math.random())*r;b=2+Math.floor(Math.random()*(.999+Math.min(2,this.scene.levelNum/10))),p=1+Math.floor(Math.random()*(.999+Math.min(2,this.scene.levelNum/4)));this.scene.levelNum>this.hardModeLevel&&(p=3),Math.random()<.5&&(b=-b),this.createLine(0,P,100,P),this.createLine(0,P+200,100,P+200);for(u=0;u<p;u++)this.movingObstacle=this.createMovingOfType(this.startPX+100+300*u,P),this.initMovingObstacle(this.movingObstacle,!0,!1,b,this.movingObstacle.objPhys.y,90,b,0),this.movingObstacle=this.createMovingOfType(this.startPX-100+300*u,P+200*r),this.initMovingObstacle(this.movingObstacle,!0,!1,-b,this.movingObstacle.objPhys.y,90,1,0)}if(9==s){l=this.startPX+100+450*Math.random(),h=this.startPX+270+110*Math.random(),c=(100+150*Math.random())*r+n*r,o=(650+50*Math.random())*r+n*r;var P=(350+200*Math.random())*r;b=.1+.15*Math.random()*(.999+Math.min(1,this.scene.levelNum/10)),p=1+Math.floor(Math.random()*(.999+Math.min(2,this.scene.levelNum/4)));this.scene.levelNum>this.hardModeLevel&&(p=3),Math.random()<.5&&(b=-b),this.createCircle(h,c,200);for(u=0;u<p;u++){var O=h-200*Math.sin(Phaser.Math.DEG_TO_RAD*(180+120*u)),f=c+200*Math.cos(Phaser.Math.DEG_TO_RAD*(180+120*u));this.movingObstacle=this.createMovingOfType(O,f),this.initMovingObstacle(this.movingObstacle,!1,!1,b,f,90+120*u,1,0),this.initCircleMove(this.movingObstacle,h,c)}}if(10==s){Math.random()<.5?(l=this.startPX+100,h=this.startPX+500):(l=this.startPX+500,h=this.startPX+100);var S=this.startPX+200+100*Math.random(),_=400;c=(250+250*Math.random())*r+n*r,o=(400+100*Math.random())*r+n*r;b=2+5*Math.random()*(.999+Math.min(1,this.scene.levelNum/10)),p=1+Math.floor(Math.random()*(.999+Math.min(2,this.scene.levelNum/4)));this.scene.levelNum>this.hardModeLevel&&(p=3),Math.random()<.5&&(b=-b),this.createLine(S,n*r-100,S,100+n*r),this.createLine(S+100,n*r-100,S+100,100+n*r);for(u=0;u<p;u++)this.movingObstacle=this.createMovingOfType(S,(_*u-100)*r),this.initMovingObstacle(this.movingObstacle,!1,!1,b,NaN,0,0,b),this.movingObstacle.fixedX=!0,this.movingObstacle.startX=this.movingObstacle.objPhys.x,this.movingObstacle=this.createMovingOfType(S+100,(_*u-100)*r+n*r),this.initMovingObstacle(this.movingObstacle,!1,!1,-b,NaN,0,0,1),this.movingObstacle.fixedX=!0,this.movingObstacle.startX=this.movingObstacle.objPhys.x}if(11==s){Math.random()<.5?(l=this.startPX+100,h=this.startPX+500):(l=this.startPX+500,h=this.startPX+100);S=this.startPX+250+150*Math.random(),_=300;c=(250+250*Math.random())*r+n*r,o=(400+100*Math.random())*r+n*r;b=4+4*Math.random()*(.999+Math.min(1,this.scene.levelNum/10)),p=2+Math.floor(Math.random()*(.999+Math.min(2,this.scene.levelNum/4)));this.scene.levelNum>this.hardModeLevel&&(p=4),Math.random()<.5&&(b=-b),this.createLine(S,-100,S,100);for(u=0;u<p;u++)this.movingObstacle=this.createMovingOfType(S,(_*u-100)*r+n*r),this.initMovingObstacle(this.movingObstacle,!1,!1,b,NaN,0,0,b),this.movingObstacle.fixedX=!0,this.movingObstacle.startX=this.movingObstacle.objPhys.x}if(12==s){l=this.startPX+250+200*Math.random(),h=this.startPX+270+110*Math.random(),o=(600+150*Math.random())*r+n*r,c=(200+100*Math.random())*r+n*r;P=(350+200*Math.random())*r+n*r,b=(.15+.1*Math.random())*(.5+Math.min(1,this.scene.levelNum/10)),p=1+Math.floor(Math.random()*(.999+Math.min(2,this.scene.levelNum/4)));this.scene.levelNum>this.hardModeLevel&&(p=3),Math.random()<.5&&(b=-b),this.createCircle(l,o,200);for(u=0;u<p;u++){O=l-200*Math.sin(Phaser.Math.DEG_TO_RAD*(180+120*u)),f=o+200*Math.cos(Phaser.Math.DEG_TO_RAD*(180+120*u));this.movingObstacle=this.createMovingOfType(O,f),this.initMovingObstacle(this.movingObstacle,!1,!0,b,NaN,90+120*u,1,0),this.initCircleMove(this.movingObstacle,l,o)}}if(13==s){P=(650+50*Math.random())*r+n*r;var B=50*Math.random();c=50*r+P,o=50*r+P,Math.random()<.5?(l=this.startPX+150,h=this.startPX+450):(h=this.startPX+150,l=this.startPX+450);b=(5+12*Math.random())*(.5+Math.min(1,this.scene.levelNum/10));Math.random()<.5&&(b=-b),this.createSharpener(this.startPX+300,50*r+P,90,.8,.8,!0),this.createSharpener(this.startPX+300,150*r+P,90,.8,.8,!0),this.createSharpener(this.startPX+150,150*r+P,90,.8,.8,!0),this.createSharpener(this.startPX+450,150*r+P,90,.8,.8,!0),this.createLine(0,-400*r+P+B,100,-400*r+P+B),this.movingObstacle=new e.MovingObject(i,l,-400*r+P+B,"balls","Obstacle_Pencil",{shape:this.shapes.Obstacle_Pencil},"","ObstacleShadow_Pencil"),this.movingObstacle.speed=b,this.movingObstacle.scale(.2,.2),this.movingObstacle.setAngle(90),this.movingObstacle.fixedY=!0,this.movingObstacle.objPhys.setVelocity(1,0),this.movingObstacles.push(this.movingObstacle),this.scene.levelNum>this.hardModeLevel&&this.createObstaclesInLine(h,-200*r+P+B,2,1)}if(14==s){l=this.startPX+150+300*Math.random(),h=this.startPX+170+210*Math.random(),o=(750+150*Math.random())*r+n*r,c=(200+50*Math.random())*r+n*r;b=(.15+.1*Math.random())*(.5+Math.min(1,this.scene.levelNum/10));this.scene.levelNum>this.hardModeLevel&&(b=.4);var x=b,X=2;Math.random()<.5&&(x=-x),Math.random()<.5&&(x*=.5),Math.random()<.5&&(X=3),Math.random()<.5&&(b=-b),this.createCircle(l,o,200),this.createCircle(h,c,200);for(u=0;u<X;u++){if(u<2||b<0){O=l-200*Math.sin(Phaser.Math.DEG_TO_RAD*(180+60*(5-X)*u)),f=o+200*Math.cos(Phaser.Math.DEG_TO_RAD*(180+60*(5-X)*u));this.movingObstacle=this.createMovingOfType(O,f),this.initMovingObstacle(this.movingObstacle,!1,!0,b,NaN,90+60*(5-X)*u,1,0),this.initCircleMove(this.movingObstacle,l,o)}if(u<2||b>0){O=h-200*Math.sin(Phaser.Math.DEG_TO_RAD*(180+60*(5-X)*u)),f=c+200*Math.cos(Phaser.Math.DEG_TO_RAD*(180+60*(5-X)*u));this.movingObstacle=this.createMovingOfType(O,f),this.initMovingObstacle(this.movingObstacle,!1,!0,x,NaN,90+60*(5-X)*u,1,0),this.initCircleMove(this.movingObstacle,h,c)}}}if(15==s){l=this.startPX+250+200*Math.random(),h=this.startPX+270+110*Math.random(),o=700+50*Math.random()+n*r,c=80+30*Math.random()+n*r;var k=(l+h)/2-100+200*Math.random(),w=(o+c)/2;X=2,b=(.15+.1*Math.random())*(.5+Math.min(1,this.scene.levelNum/10));Math.random()<.5&&(X=3),this.scene.levelNum>this.hardModeLevel&&(X=4,b=.5);x=b;Math.random()<.5&&(x=-x),Math.random()<.5&&(x*=.5),Math.random()<.5&&(b=-b),this.createCircle(k,w,200);for(u=0;u<X;u++)if(u>0||2==X){O=k-200*Math.sin(Phaser.Math.DEG_TO_RAD*(180+60*(5-X)*u)),f=w+200*Math.cos(Phaser.Math.DEG_TO_RAD*(180+60*(5-X)*u));this.movingObstacle=this.createMovingOfType(O,f),this.initMovingObstacle(this.movingObstacle,!1,!0,b,NaN,90+60*(5-X)*u,1,0),this.initCircleMove(this.movingObstacle,k,w)}}if(16==s){l=this.startPX+100+450*Math.random(),h=this.startPX+100+450*Math.random();var N=1;o=(P=(350+100*Math.random())*r+n*r)+(370+30*Math.random())*r,c=P-250*r;b=(3+4*Math.random())*(.5+Math.min(1,this.scene.levelNum/10));this.scene.levelNum>this.hardModeLevel&&(b=13),Math.random()<.5&&(b=-b),this.createLine(100,P-100*r,210,P-100*r),this.createLine(100,P+250*r,210,P+250*r);for(u=0;u<3;u++)Math.random()<.9&&(0==N||u<2)?(this.movingObstacle=this.createMovingOfType(this.startPX-100+300*u,P-100*r),this.initMovingObstacle(this.movingObstacle,!0,!1,b,this.movingObstacle.objPhys.y,90,b,0)):N--,Math.random()<.9&&(0==N||u<2)?(this.movingObstacle=this.createMovingOfType(this.startPX-100+300*u,P+250*r),this.initMovingObstacle(this.movingObstacle,!0,!1,-b,this.movingObstacle.objPhys.y,90,b,0)):N--}if(17==s){l=this.startPX+150+250*Math.random(),h=this.startPX+160+230*Math.random(),c=(100+100*Math.random())*r+n*r,o=(700+100*Math.random())*r+n*r;var A=120+50*Math.random(),C=(400+100*Math.random())*r+n*r;b=(.04+.08*Math.random())*(.5+Math.min(.5,this.scene.levelNum/15));Math.random()<.5&&(b=-b);for(u=0;u<2;u++)A+=300*u,this.createRotatingEraser(this.startPX+A,C,b);i.levelNum>this.hardModeLevel&&(this.createCap(h+180,c,40*Math.random()-20,1,1,!0),this.createCap(h-180,c,40*Math.random()-20,1,1,!0))}if(18==s){var T=Math.floor(1.999*Math.random()),D=1,I=Math.floor(1.999*Math.random());A=0,C=0;0==T?(l=this.startPX+50+60*Math.random(),h=this.startPX+450+60*Math.random()):(l=this.startPX+450+60*Math.random(),h=this.startPX+50+60*Math.random()),0==D?(o=(150+80*Math.random())*r+n*r,C=(c=(100+100*Math.random())*r+n*r)+400*r):(o=(800-80*Math.random())*r+n*r,C=(c=(850-100*Math.random())*r+n*r)-400*r),A=Math.max(l,h)-this.startPX,this.createBlackCrayon((h+l)/2,o+(0==D?(50*Math.random()-50)*r:0),0==D?180:0,1.5,1.5,!0),1==I&&(A=(h+l)/2-this.startPX,C=0==D?750*r+n*r:200*r+n*r),this.movingObstacle=new e.MovingObject(i,this.startPX+A,C,"balls","Eraser",{shape:this.shapes.Obstacle_Eraser},"","EraserShadow"),this.movingObstacle.speed=0,this.movingObstacle.startY=this.movingObstacle.objPhys.y,this.movingObstacle.startX=this.movingObstacle.objPhys.x,this.movingObstacle.scale(.9,.9),this.movingObstacle.objPhys.setStatic(!1),this.movingObstacle.angularVelocity=(2*Math.floor(1.999*Math.random())-1)*(.02*Math.random()+.02),0==I&&(this.movingObstacle.angularVelocity=0==T?0==D?Math.abs(this.movingObstacle.angularVelocity):-Math.abs(this.movingObstacle.angularVelocity):0==D?-Math.abs(this.movingObstacle.angularVelocity):Math.abs(this.movingObstacle.angularVelocity));var E=i.matter.add.sprite(this.startPX+A,C,"balls","Eraser");E.setCircle(1),E.setFrictionAir(5e-4),E.setDensity(1e6),E.setCollidesWith(0),E.setVisible(!1),E.setStatic(!0),i.matter.add.joint(E.body,this.movingObstacle.objPhys.body,0,.999),this.movingObstacle.objPhys.setAngularVelocity(this.movingObstacle.angularVelocity),this.movingObstacles.push(this.movingObstacle),this.createPin(this.startPX+A-10,C-10,-43.390087,.8,.8,!0).setCollidesWith(0)}if(19==s){T=Math.floor(1.999*Math.random()),D=1,I=Math.floor(1.999*Math.random());var j=0,L=0,H=(C=0,0);l=this.startPX+200+200*Math.random(),h=this.startPX+200+200*Math.random(),0==D?(o=(200+50*Math.random())*r+n*r,C=(c=(850+50*Math.random())*r+n*r)-250*r,H=o+(150+50*Math.random())*r):(C=(o=(750+50*Math.random())*r+n*r)-250*r,H=(c=(100+20*Math.random())*r+n*r)+(150+50*Math.random())*r);b=(2*Math.floor(1.999*Math.random())-1)*(.02*Math.random()+.02);b=Math.abs(b),j=200+200*Math.random(),this.createRotatingEraser(this.startPX+j,C,b),this.movingObstacle.setAngle(0),b=2+5*Math.random()*(.999+Math.min(1,this.scene.levelNum/10));p=1+Math.floor(Math.random()*(.999+Math.min(2,this.scene.levelNum/4)));Math.random()<.5&&(b=-b),this.createLine(this.startPX-400,H,this.startPX-100,H);for(u=0;u<p;u++)this.movingObstacle=this.createMovingOfType(this.startPX-100+300*u,H),this.initMovingObstacle(this.movingObstacle,!0,!1,b,this.movingObstacle.objPhys.y,90,1,0)}if(20==s){l=this.startPX+200+200*Math.random(),o=(700+50*Math.random())*r+n*r,h=this.startPX+200+200*Math.random();v=(o+(c=(160+100*Math.random())*r+n*r))/2-80+160*Math.random();this.createCap(this.startPX+300.59125,v,40*Math.random()-20,1,1,!0),this.createCap(h-120-50*Math.random(),c,40*Math.random()-20,1,1,!0),this.createCap(h+120+50*Math.random(),c,40*Math.random()-20,1,1,!0),this.scene.levelNum>this.hardModeLevel&&this.createObstaclesInCircle(l,o,1,120)}if(21==s){P=(400+100*Math.random())*r+n*r;l=(S=this.startPX+220+50*Math.random())+120+80*Math.random(),h=S-120-60*Math.random(),o=P+(350+20*Math.random())*r,c=P+(-200-100*Math.random())*r,Math.random()<.5&&(l=S-120-60*Math.random(),h=S+120+80*Math.random());b=2+Math.floor(Math.random()*(.999+Math.min(2,this.scene.levelNum/10))),p=1+Math.floor(Math.random()*(.999+Math.min(2,this.scene.levelNum/4)));Math.random()<.5&&(b=-b),this.createLine(0,P,100,P),this.createLine(S,10,S,100);for(u=0;u<p;u++)this.movingObstacle=new e.MovingObject(i,this.startPX+100+300*u,P,"balls","Kapsel",this.shapes.Kapsel,"","Kapsel_Cien"),this.initMovingObstacle(this.movingObstacle,!0,!1,b,this.movingObstacle.objPhys.y,90,b,0),this.movingObstacle=new e.MovingObject(i,S,300*u-100+n*r,"balls","Kapsel",this.shapes.Kapsel,"","Kapsel_Cien"),this.movingObstacle.speed=b,this.movingObstacle.fixedX=!0,this.movingObstacle.startX=this.movingObstacle.objPhys.y,this.movingObstacle.objPhys.setStatic(!1),this.movingObstacle.startX=this.movingObstacle.objPhys.x,this.movingObstacle.objPhys.setVelocity(0,b),this.movingObstacles.push(this.movingObstacle)}if(22==s){l=this.startPX+150+250*Math.random(),h=this.startPX+160+230*Math.random(),c=(100+100*Math.random())*r+n*r,o=(750+100*Math.random())*r+n*r;A=h-200+80*Math.random()-this.startPX,C=(450+150*Math.random())*r+n*r,L=h+200-80*Math.random()-this.startPX,H=C+(300*Math.random()-150)*r,b=(.04+.07*Math.random())*(.5+Math.min(.4,this.scene.levelNum/15));if(i.levelNum>this.hardModeLevel&&(b=.099),Math.random()<.5&&(b=-b),this.createCap(this.startPX+L,H,0,1,1,!0),this.createRotatingEraser(this.startPX+A,C,b),i.levelNum>this.hardModeLevel){var R=Phaser.Math.Distance.Between(l,o,this.startPX+A,C);R+=Phaser.Math.Distance.Between(l,o,this.startPX+L,H);var V=Phaser.Math.Distance.Between(h,c,this.startPX+A,C);R>(V+=Phaser.Math.Distance.Between(h,c,this.startPX+L,H))?this.createObstaclesInCircle(l,o,1,120,1.5*-b):this.createObstaclesInCircle(h,c,1,120,1.5*-b)}}if(23==s){T=0,A=0,j=0,L=0,C=270*r+n*r;o=(600+150*Math.random())*r+n*r,c=C,Math.random()<.5?(A=150+50*Math.random(),l=this.startPX+A,j=(h=this.startPX+500)-150*Math.random(),L=h-150*Math.random()):(T=1,A=350+50*Math.random(),l=this.startPX+A,j=(h=this.startPX+100)+150*Math.random(),L=h+150*Math.random()),this.createCap(j,c-130*r,0,1,1,!0),this.createCap(L,c+130*r,0,1,1,!0),this.createPencil(this.startPX+A,C,0==T?45:135,.4,.4,!0)}if(24==s){A=0,j=0,L=0,C=170*r+n*r;o=(750+100*Math.random())*r+n*r,c=C,Math.random()<.5?(A=150+50*Math.random(),l=this.startPX+A,j=(h=this.startPX+500)-150*Math.random(),L=h-150*Math.random()):(A=350+50*Math.random(),l=this.startPX+A,j=(h=this.startPX+100)+150*Math.random(),L=h+150*Math.random()),j=(h+l)/2-150+300*Math.random();var z=.5+.3*Math.random()*(.5+Math.min(.5,this.scene.levelNum/15));i.levelNum>this.hardModeLevel&&(z=Math.min(z,.65),o=820);var Y=j,G=(c+o)/2-130+20*Math.random();this.createShadowSprite("Jabzo","Kapsel_Cien",{shape:"circle",radius:100},Y,G,0,z,z,!0).setData("isEnemy",!1);var K=j+150*Math.random(),F=(c+o)/2+(100+20*Math.random())*r;if(this.createShadowSprite("Jabzo","Kapsel_Cien",{shape:"circle",radius:100},K,F,0,z,z,!0).setData("isEnemy",!1),i.levelNum>this.hardModeLevel){var W=Phaser.Math.Distance.Between(Y,G,l,o),J=Phaser.Math.Distance.Between(K,F,h,c);W>200?this.createObstaclesInCircle(l,o,1,110,.3):J>200&&this.createObstaclesInCircle(h,c,1,110,.3)}}i.targetHole=i.matter.add.sprite(h,c,"balls","Cel").setOrigin(1),i.targetHole.setScale(1),i.targetHole.setVisible(!1),i.targetHoleSkin=i.make.sprite({x:h-this.scene.m_layer_cover22.x,y:c-this.scene.m_layer_cover22.y,key:"balls",frame:"Cel"}),this.scene.m_layer_cover22.add(i.targetHoleSkin),i.targetHole.setBody({type:"circle",radius:43,label:"hole"},{}),i.targetHole.setDataEnabled(),i.targetHole.setData("isHole",!0),i.targetHole.setSensor(!0),i.playerBall=new t.Ball(i,l,o,"balls","Blue0061","blue","BallShadow"),i.playerBall.ballSensor.setScale(.75),i.playerBall.ballSensor.setVisible(!1),i.playerBall.ballAnim.setScale(.75),i.playerBall.ballShadow.setScale(.9),i.m_layer_cover22.add(i.playerBall.ballShadow),i.m_layer_cover22.add(i.playerBall.ballAnim),this.renderSelectedBall(i),i.playerBall.ballSensor.setBody({type:"circle",radius:43,label:"anim"},{}),i.playerBall.ballSensor.setSensor(!0),i.playerBall.ballPhys.setScale(.75),i.playerBall.ballPhys.setBody({type:"circle",radius:43},{}),i.playerBall.ballPhys.setBounce(.8),i.playerBall.ballPhys.setDataEnabled(),i.playerBall.ballPhys.data.set("lastFramePosX",0),i.playerBall.ballPhys.data.set("lastFramePosY",0),i.playerBall.ballPhys.setCollisionCategory(this.cat3),i.playerBall.ballPhys.setCollidesWith([this.cat1,this.cat2]),console.log(i),this.createHTP(),console.log("start tweens"),console.log("scene cc: "+i.children.length),o>500?(console.log("bay: "+i.playerBall.ballAnim.y),a.ButtonManager.getInstance().setupTween(i.playerBall.ballAnim,i,i.playerBall.ballAnim.x,i.playerBall.ballAnim.y-800,900),console.log(a.ButtonManager.getInstance().tweenArr[a.ButtonManager.getInstance().tweenArr.length-1]),a.ButtonManager.getInstance().setupTween(i.playerBall.ballShadow,i,i.playerBall.ballShadow.x,i.playerBall.ballShadow.y-800,900),a.ButtonManager.getInstance().setupTween(i.targetHoleSkin,i,i.targetHoleSkin.x,i.targetHoleSkin.y+800,900)):(console.log("bay: "+i.playerBall.ballAnim.y),a.ButtonManager.getInstance().setupTween(i.playerBall.ballAnim,i,i.playerBall.ballAnim.x,i.playerBall.ballAnim.y+800,900),console.log(a.ButtonManager.getInstance().tweenArr[a.ButtonManager.getInstance().tweenArr.length-1]),a.ButtonManager.getInstance().setupTween(i.playerBall.ballShadow,i,i.playerBall.ballShadow.x,i.playerBall.ballShadow.y+800,900),a.ButtonManager.getInstance().setupTween(i.targetHoleSkin,i,i.targetHoleSkin.x,i.targetHoleSkin.y-800,900))},n.prototype.createObstaclesInCircle=function(t,e,a,s,i){void 0===i&&(i=0),this.createCircle(t,e,s),0==i&&(i=(.15+.1*Math.random())*(.5+Math.min(1,this.scene.levelNum/10)));for(var r=0;r<a;r++){var n=t-s*Math.sin(Phaser.Math.DEG_TO_RAD*(180+60*(5-a)*r)),l=e+s*Math.cos(Phaser.Math.DEG_TO_RAD*(180+60*(5-a)*r));this.movingObstacle=this.createMovingOfType(n,l),this.movingObstacle.speed=i,this.movingObstacle.circleMove=!0,this.movingObstacle.cMoveX=t,this.movingObstacle.cMoveY=e,this.movingObstacle.objPhys.setStatic(!0),this.movingObstacle.setAngle(90+60*(5-a)*r),this.movingObstacle.objPhys.setVelocity(1,0),this.movingObstacles.push(this.movingObstacle)}},n.prototype.createObstaclesInLine=function(t,e,a,s){0==s?this.createLine(t,-100,t,100):this.createLine(-100,e,100,e);for(var i=4+Math.floor(Math.random()*(.999+Math.min(12,this.scene.levelNum/2))),r=0;r<a;r++)0==s?(this.movingObstacle=this.createMovingOfType(t,e+300*r),this.movingObstacle.speed=i,this.movingObstacle.fixedX=!0,this.movingObstacle.startX=this.movingObstacle.objPhys.x,this.movingObstacle.objPhys.setStatic(!1),this.movingObstacle.startX=this.movingObstacle.objPhys.x,this.movingObstacle.objPhys.setVelocity(0,i)):(this.movingObstacle=this.createMovingOfType(t+300*r,e),this.movingObstacle.speed=i,this.movingObstacle.fixedY=!0,this.movingObstacle.startY=this.movingObstacle.objPhys.y,this.movingObstacle.objPhys.setStatic(!1),this.movingObstacle.startY=this.movingObstacle.objPhys.y,this.movingObstacle.objPhys.setVelocity(i,0),this.movingObstacle.setAngle(90)),this.movingObstacles.push(this.movingObstacle)},n.prototype.createMovingOfType=function(t,a){var s;return Math.random()<.33?(s=new e.MovingObject(this.scene,t,a,"balls","Jabzo",{shape:"circle",radius:50},"","Kapsel_Cien")).scale(.5):Math.random()<.5?s=new e.MovingObject(this.scene,t,a,"balls","Kapsel",{shape:"circle",radius:50},"","Kapsel_Cien"):(s=new e.MovingObject(this.scene,t,a,"balls","Obstacle_Sharpener",{shape:this.shapes.Obstacle_Sharpener},"","ObstacleShadow_Sharpener")).scale(.7),s},n.prototype.createHTP=function(){var t=this.scene;if(1==t.levelNum&&t.gameStatsModel.lastUnlockedNum>1&&(console.log("create leftright buttons"),t.leftBtn=t.make.sprite({x:t.playerBall.ballAnim.x-100,y:t.playerBall.ballAnim.y,key:"balls",frame:"Btn_PrevDoonies"}),t.m_layer_cover22Top.add(t.leftBtn),t.leftBtn.setInteractive(),t.leftBtn.setData("shape",t.leftBtn.getBounds()),t.buttonShapes.push(t.leftBtn.getData("shape")),t.leftBtn.on("pointerup",function(){if(console.log("left button clicked"),!(a.ButtonManager.getInstance().tweenArr.length>0)){do{t.gameStatsModel.currentBallSelected+=5,t.gameStatsModel.currentBallSelected=t.gameStatsModel.currentBallSelected%7+1}while(t.gameStatsModel.currentBallSelected>t.gameStatsModel.lastUnlockedNum);n.getInstance().renderSelectedBall(t),window.localStorage.setItem(t.gameStatsModel.DOONIES_BALLSELECTED,String(t.gameStatsModel.currentBallSelected))}}),t.rightBtn=t.make.sprite({x:t.playerBall.ballAnim.x+100,y:t.playerBall.ballAnim.y,key:"balls",frame:"Btn_NextDoonies"}),t.m_layer_cover22Top.add(t.rightBtn),t.rightBtn.setData("shape",t.rightBtn.getBounds()),t.buttonShapes.push(t.rightBtn.getData("shape")),t.rightBtn.setInteractive(),t.rightBtnTween=t.add.tween({repeat:-1,loop:!0,targets:t.rightBtn,scaleX:1.2,scaleY:1.2,yoyo:!0,duration:500,ease:"Sine"}),a.ButtonManager.getInstance().setupTween(t.rightBtn,t,0,0,700),t.rightBtn.on("pointerup",function(){if(!(a.ButtonManager.getInstance().tweenArr.length>0)){console.log("right button clicked"),console.log(t.rightBtn);do{t.gameStatsModel.currentBallSelected+=0,t.gameStatsModel.currentBallSelected=t.gameStatsModel.currentBallSelected%7+1}while(t.gameStatsModel.currentBallSelected>t.gameStatsModel.lastUnlockedNum);n.getInstance().renderSelectedBall(t),window.localStorage.setItem(t.gameStatsModel.DOONIES_BALLSELECTED,String(t.gameStatsModel.currentBallSelected))}})),t.joystickPartA=t.make.sprite({x:0,y:300,key:"balls",frame:"circleJoy"}),t.joystickPartA.setAlpha(0),t.m_layer_basic.add(t.joystickPartA),t.joystickPartB=t.make.sprite({x:0,y:300,key:"balls",frame:"circleJoy"}),t.joystickPartB.setScale(.5),t.joystickPartB.setAlpha(0),t.m_layer_basic.add(t.joystickPartB),!t.seenHTP){t.aimHere=t.make.sprite({x:t.targetHoleSkin.x,y:t.targetHoleSkin.y-170,key:"balls",frame:"AimHereArrow"}),t.m_layer_cover22Top.add(t.aimHere),t.howToPlay=t.make.sprite({x:t.playerBall.ballAnim.x,y:t.playerBall.ballAnim.y,key:"balls",frame:"Tap_0002"}).play("btnPlay"),t.howToPlay.setOrigin(69/266,66/213),t.howToPlay.anims.pause(),t.m_layer_cover22Top.add(t.howToPlay);var e=Phaser.Math.Distance.Between(t.targetHoleSkin.x,t.targetHoleSkin.y,t.playerBall.ballAnim.x,t.playerBall.ballAnim.y);t.tweenHTP=t.add.tween({repeat:-1,loop:!0,targets:t.howToPlay,x:t.playerBall.ballAnim.x+200*(-t.targetHoleSkin.x+t.playerBall.ballAnim.x)/e,y:t.playerBall.ballAnim.y+200*(-t.targetHoleSkin.y+t.playerBall.ballAnim.y)/e,duration:1500,ease:"Cubic"})}},n.prototype.renderSelectedBall=function(t){var e=t.playerBall.ballAnim,a=t.gameStatsModel.progressData["ball"+String(t.gameStatsModel.currentBallSelected)].iconName,s=t.gameStatsModel.progressData["ball"+String(t.gameStatsModel.currentBallSelected)].name;t.playerBall.ballAnim=t.make.sprite({x:e.x,y:e.y,key:"ball",frame:a}),e.destroy(),t.playerBall.ballAnim.play(s),t.playerBall.ballAnim.anims.pause(),t.m_layer_cover22.add(t.playerBall.ballAnim),t.playerBall.ballAnim.setScale(.75)},n.prototype.createFrame=function(){var t=this.scene.game.bm.moonEngineBootVals.gameWidth,e=this.scene.game.bm.moonEngineBootVals.gameHeight;this.frame1=this.scene.matter.add.image(10+this.startPX,.5*e,"balls","ObstacleShadow_Sharpener"),this.frame1.setCollisionCategory(this.cat1),this.frame1.setCollidesWith([this.cat1,this.cat3]),this.frame1.setScale(100/this.frame1.width,e/this.frame1.height),this.frame1.setPosition(-50+this.startPX,.5*e+this.deltaY),this.frame1.setStatic(!0),this.frame1.setVisible(!1);var a=this.scene.make.sprite({x:this.startPX-65-this.scene.m_layer_cover22.x,y:.5*e-this.scene.m_layer_cover22.y+this.deltaY,key:"balls",frame:"OgraniczenieBoku"});a.setScale(1.55,1.55),a.setAngle(180),this.frame1.setData("skin",a),this.scene.m_layer_cover22.add(a),this.frame2=this.scene.matter.add.image(10+this.startPX,.5*e,"balls","ObstacleShadow_Sharpener"),this.frame2.setCollisionCategory(this.cat1),this.frame2.setCollidesWith([this.cat1,this.cat3]),this.frame2.setScale(100/this.frame2.width,e/this.frame2.height),this.frame2.setPosition(this.startPX+t+50,this.frame2.y+this.deltaY),this.frame2.setStatic(!0),this.frame2.setVisible(!1),(a=this.scene.make.sprite({x:this.startPX+t+65-this.scene.m_layer_cover22.x,y:.5*e-this.scene.m_layer_cover22.y+this.deltaY,key:"balls",frame:"OgraniczenieBoku"})).setScale(1.55,1.55),a.setAngle(0),this.scene.m_layer_cover22.add(a),this.frame2.setData("skin",a),this.frame3=this.scene.matter.add.image(10+this.startPX,.5*e,"balls","ObstacleShadow_Sharpener"),this.frame3.setCollisionCategory(this.cat1),this.frame3.setCollidesWith([this.cat1,this.cat3]),this.frame3.setScale(t/this.frame3.width,100/this.frame3.height),this.frame3.setPosition(t/2+this.startPX,-50+this.deltaY),(a=this.scene.make.sprite({x:this.startPX+t/2+32.5-this.scene.m_layer_cover22.x,y:-65-e/2,key:"balls",frame:"OgraniczenieBoku"})).setScale(1.55,1.55),a.setAngle(270),this.scene.m_layer_cover22.add(a),this.frame3.setData("skin",a),this.frame3.setStatic(!0),this.frame3.setVisible(!1),this.frame4=this.scene.matter.add.image(10+this.startPX,.5*e,"balls","ObstacleShadow_Sharpener"),this.frame4.setCollisionCategory(this.cat1),this.frame4.setCollidesWith([this.cat1,this.cat3]),(a=this.scene.make.sprite({x:this.startPX+t/2+32.5-this.scene.m_layer_cover22.x,y:e-this.scene.m_layer_cover22.y+78+this.deltaY*this.gsy,key:"balls",frame:"OgraniczenieBoku"})).setScale(1.55,1.55),a.setAngle(270),this.scene.m_layer_cover22.add(a),this.frame4.setScale(t/this.frame4.width,110/this.frame4.height),this.frame4.setPosition(t/2+this.startPX,e+58+this.deltaY),this.frame4.setStatic(!0),console.log("f4d: "+this.frame4.y),this.frame4.setVisible(!1),this.frame4.setData("skin",a)},n.prototype.cleanLevel=function(){void 0!==n.getInstance().frame1&&(this.frame1.destroy(),this.frame1=null,this.frame2.destroy(),this.frame3.destroy(),this.frame4.destroy());for(var t=0,e=this.movingObstacles;t<e.length;t++){e[t].destroy()}if(this.movingObstacles.length=0,this.movingObstacles=[],this.scene&&this.scene.expAnim&&this.scene.expAnim.destroy(),this.scene.buttonShapes=[],void 0!==this.scene)for(;this.scene.children.count.length>2;){var a=this.scene.children.getRandom();a instanceof Phaser.GameObjects.Graphics||this.scene.children.remove(a)}},n}();exports.LevelFactory=n;
},{"../model/Ball":"jvKT","./MovingObject":"qMkz","./ButtonManager":"YVm7","./SoundPlayer":"4mTs","../utils/Utils":"0qTL","./ResizeManager":"Vrh8"}],"Vrh8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ResizeManager=void 0;var e=require("./LevelFactory"),i=function(){function i(){}return i.getInstance=function(){return i.instance||(i.instance=new i),i.instance},i.prototype.onWindowResize=function(e){if(i.NONEMODE){window.game.canvas.getBoundingClientRect();window.game.scale.resize(Math.round(window.innerWidth),i.getWindowHeight(),window.game.scene)}var n=window.game.curSceneRef.debugText;n.setText(n.text+"\n resize")},i.prototype.resize=function(n,t,r){if(void 0===window.game||i.lastWidth!=window.innerWidth||i.lastHeight!=i.getWindowHeight()){console.log("window.orientation"),console.log(screen.orientation);var a=function(){var e={},n=window.game.canvas.getBoundingClientRect();console.log("relsvg"),console.log(n);var t=document.body,r=document.documentElement;Math.min(t.scrollHeight,t.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight);return i.RESIZEMODE?(e.innerWidth=window.game.scale.parentSize.width,e.innerHeight=window.game.scale.parentSize.height+n.top):(e.innerWidth=window.innerWidth,e.innerHeight=i.getWindowHeight()),i.lastHeight=e.innerHeight,i.lastWidth=e.innerWidth,console.log("relsvg w:"+n.width+", h:"+n.height,"top: "+n.top),e.scaleWidth=e.innerWidth/this.game.bm.moonEngineBootVals.gameWidth,e.scaleHeight=(e.innerHeight-i.getTop())/this.game.bm.moonEngineBootVals.gameHeight,e.higherScale,e.lowerScale,e.scaleWidth>e.scaleHeight?(e.higherScale=e.scaleWidth,e.lowerScale=e.scaleHeight):(e.higherScale=e.scaleHeight,e.lowerScale=e.scaleWidth),e.multiplierWidth=1/e.scaleWidth,e.multiplierHeight=1/e.scaleHeight,e.higherMultiplier,e.lowerMultiplier,e.multiplierWidth>e.multiplierHeight?(e.higherMultiplier=e.multiplierWidth,e.lowerMultiplier=e.multiplierHeight):(e.higherMultiplier=e.multiplierHeight,e.lowerMultiplier=e.multiplierWidth),e.newScale=e.lowerScale,e.reverseNewScale=1/e.newScale,e.screenScaleForGame=e.newScale,e.screenMaxWidthForGame=e.innerWidth*e.higherMultiplier,e.screenMaxHeightForGame=(e.innerHeight-Math.abs(i.getTop()))*e.higherMultiplier,e}.bind(r)(),o=window.game.canvas.getBoundingClientRect();console.log("debug text relsvg w:"+o.width+", h:"+o.height+",top: "+o.top),r.debugText;var l=r.m_layer_basic;l.setScale(a.screenScaleForGame),l.setPosition(l.x,Math.round(-o.top)),r.lastC22=r.m_layer_cover22.y;r.m_layer_cover22.y;r.m_layer_cover22.setPosition(a.screenMaxWidthForGame/2,a.screenMaxHeightForGame/2),r.m_layer_cover22Top&&r.m_layer_cover22Top.setPosition(a.screenMaxWidthForGame/2,a.screenMaxHeightForGame/2),r.m_layer_cover00.x=0,r.m_layer_cover00.y=0,r.m_layer_cover33.x=a.screenMaxWidthForGame,r.m_layer_cover33.y=a.screenMaxHeightForGame,i.NONEMODE&&(r.game.renderer.width==a.innerWidth&&r.game.renderer.height==a.innerHeight||(r.game.renderer.resize(a.innerWidth,a.innerHeight),r.cameras.resize(a.innerWidth,a.innerHeight)));try{e.LevelFactory.getInstance().frame4}catch(g){}}},i.getTop=function(){var e=window.game.canvas.getBoundingClientRect();return 2*Math.abs(e.top)},i.getWindowHeight=function(){var e=window.game.canvas.getBoundingClientRect();return window.innerWidth>window.innerHeight?Math.round(window.innerHeight+e.top):Math.round(window.innerHeight+2*Math.abs(e.top))},i.prototype.initialize=function(e){if(window.game=e.game,(i.NONEMODE||i.RESIZEMODE)&&window.addEventListener("resize",function(e){if(i.NONEMODE){window.game.canvas.getBoundingClientRect();window.game.scale.resize(Math.round(window.innerWidth),i.getWindowHeight())}},!1),e.m_layer_basic=e.make.container({},!0),i.FITMODE&&(e.m_layer_basic.x=300,e.m_layer_basic.y=512),e.m_layer_cover22=e.make.container({},!1),e.m_layer_cover00=e.make.container({},!1),e.m_layer_cover33=e.make.container({},!1),e.m_layer_basic.add(e.m_layer_cover00),e.m_layer_basic.add(e.m_layer_cover22),e.m_layer_basic.add(e.m_layer_cover33),e.game.curSceneRef=e,i.NONEMODE||i.RESIZEMODE){e.scale.on("resize",function(n){console.log("gamesize: "),console.log(n),i.getInstance().resize(n.width,i.getWindowHeight(),e.game.curSceneRef)},e);window.game.canvas.getBoundingClientRect();console.log(window.game.canvas);window.game.canvas.getBoundingClientRect();console.log(window.game.canvas),i.NONEMODE?window.game.scale.resize(Math.round(window.innerWidth),i.getWindowHeight()):i.RESIZEMODE&&window.game.scale.setGameSize(window.innerWidth,i.getWindowHeight())}},i.NONEMODE=!0,i.FITMODE=!1,i.RESIZEMODE=!1,i.IOSMODE=!1,i.lastWidth=0,i.lastHeight=0,i}();exports.ResizeManager=i;
},{"./LevelFactory":"0Zwn"}],"G1z3":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(o,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t])})(o,t)};return function(o,t){function n(){this.constructor=o}e(o,t),o.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.LoadScene=void 0;var o=require("../CST"),t=require("../model/ResizeManager"),n=function(n){function i(){var e=n.call(this,{key:o.CST.SCENES.LOAD})||this;return e.mode="loadPreload",e}return e(i,n),i.getInstance=function(){return i.instance||(i.instance=new i),i.instance},i.prototype.init=function(){if(!t.ResizeManager.FITMODE&&void 0!==window.game)if(t.ResizeManager.RESIZEMODE){var e=this.game.canvas.getBoundingClientRect();this.game.scale.resize(Math.round(window.innerWidth),Math.round(window.innerHeight+Math.abs(e.top)))}else this.game.scale.resize(Math.round(window.innerWidth),Math.round(window.innerHeight))},i.prototype.loadImages=function(){console.log("loadImages"),this.load.setPath("./assets/image"),this.load.image("BMLogo.png","BMLogo.png"),this.load.image("PaperBG.png","PaperBG.png")},i.prototype.loadAudio=function(){if(this.load.setPath("./assets/audio"),window.isIOS)for(var e in o.CST.AUDIOIOS)this.load.audio(String(o.CST.AUDIOIOS[e]).slice(0,String(o.CST.AUDIOIOS[e]).length-4),o.CST.AUDIOIOS[e]);else for(var e in o.CST.AUDIO){console.log("no ios audio"),console.log(String(o.CST.AUDIO[e])),console.log(String(o.CST.AUDIO[e]).length);var t=String(o.CST.AUDIO[e]).slice(0,String(o.CST.AUDIO[e]).length-4);console.log("|"+t+"|"),this.load.audio(String(o.CST.AUDIO[e]).slice(0,String(o.CST.AUDIO[e]).length-4),o.CST.AUDIO[e])}},i.prototype.preload=function(){var e=this;window.isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,i.instance||(i.instance=this),this.cameras.main.setBackgroundColor(16710121),this.load.on("progress",function(o){if(console.log("progress"),console.log(o),e.loadText)console.log("set progress text"),e.loadText.setText(String(Math.floor(100*o))+"%");else{e.m_layer_basic||t.ResizeManager.getInstance().initialize(e);try{e.loadText=e.make.bitmapText({x:0,y:100,font:"obelixpro",text:"0",size:63,align:1,add:!1},!1),e.m_layer_cover22.add(e.loadText),console.log(e.loadText),console.log("success"),console.log(file)}catch(n){}}1==o&&(console.log("percent 1 state"),console.log(e))},this),this.load.on("filecomplete",function(o){if(console.log("filecomplete"),console.log(o),!e.loadLogo&&"BMLogo.png"==o)try{e.loadLogo||(e.loadLogo=e.make.image({x:0,y:-100,key:"BMLogo.png"}),e.m_layer_cover22.add(e.loadLogo))}catch(t){}},this),this.load.on("loaderror",function(e){console.log("load error")},this),this.load.on("complete",function(o){e.loadStartComplete()},this),this.load.on("load",function(e){console.log("load: "+e.src)}),this.load.setPath("./assets/image"),this.load.bitmapFont("obelixpro","ScoreFont_1.png","ScoreFont.xml"),this.preloadGameAssets()},i.prototype.loadStartComplete=function(){console.log("complete"),console.log(this);this.textures.get("balls").getFrameNames();window.game=this.game,window.addEventListener("resize",function(e){t.ResizeManager.NONEMODE&&window.game.renderer.resize(window.innerWidth,window.innerHeight)},!1),t.ResizeManager.RESIZEMODE||t.ResizeManager.NONEMODE?window.game.scale&&this.game.scale.parentSize&&window.game.scale.setGameSize(this.game.scale.parentSize.width,this.game.scale.parentSize.height):window.game.scale.resize(Math.round(window.innerWidth),Math.round(window.innerHeight)),this.scene.start(o.CST.SCENES.MENU)},i.prototype.preloadGameAssets=function(){this.load.setPath(""),this.load.multiatlas("balls","./assets/textures.json","./assets/"),this.loadImages(),this.loadAudio()},i.prototype.create=function(){this.mode},i}(Phaser.Scene);exports.LoadScene=n;
},{"../CST":"mOOU","../model/ResizeManager":"Vrh8"}],"mn3m":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AnimationFactory=void 0;var e=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.createCustomAnim=function(e,t,a,n){this.scene.anims.create({key:e,frameRate:10,frames:this.scene.anims.generateFrameNames("balls",{prefix:t,start:a,end:n}),repeat:-1})},e.prototype.createBallsAnimations=function(e){this.scene=e,console.log(" create animation bams"),this.createCustomAnim("bams","KulaZoltaBams_F00",11,22),this.createCustomAnim("brown","Brown00",31,60),this.createCustomAnim("fogger","Fogger00",61,90),this.createCustomAnim("chicken","Chicken00",61,90),this.createCustomAnim("snow","Snow00",61,90),this.createCustomAnim("tomato","Tomato00",61,90),this.createCustomAnim("blue","Blue00",61,90)},e.prototype.createButtonAnimations=function(e){e.anims.create({key:"btnPlay",frameRate:2,repeat:-1,frames:[{key:"balls",frame:"Tap_0001"},{key:"balls",frame:"Tap_0002"}]}),e.anims.create({key:"soundBtnAnim",frameRate:10,frames:[{key:"balls",frame:"MusicOn"},{key:"balls",frame:"MusicOff"}]}),e.anims.create({key:"pauseBtnAnim",frameRate:10,frames:[{key:"balls",frame:"Btn_Pause"},{key:"balls",frame:"Btn_Pause"}]})},e}();exports.AnimationFactory=e;
},{}],"iqaM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GameStatsModel=void 0;var t=function(){function t(){this.totalPoints=0,this.currentScore=0,this.lastUnlockedNum=1,this.lastUnlockedShownNum=1,this.lastTotalPointsShowed=0,this.currentBallSelected=1,this.DOONIES_HIGHSCORE="DOONIES_HIGHSCORE",this.DOONIES_TOTALPOINTS="DOONIES_TOTALPOINTS",this.DOONIES_BALLSELECTED="DOONIES_BALLSELECTED",this.progressData={ball1:{name:"brown",points:0,iconName:"Brown0060"},ball2:{name:"fogger",points:10,iconName:"Fogger0061"},ball3:{name:"chicken",points:30,iconName:"Chicken0061"},ball4:{name:"snow",points:50,iconName:"Snow0061"},ball5:{name:"tomato",points:80,iconName:"Tomato0061"},ball6:{name:"blue",points:120,iconName:"Blue0061"},ball7:{name:"kiss",points:170,iconName:"Kiss0061"}}}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.loadDataFromLocalStorage=function(){null!=window.localStorage.getItem(this.DOONIES_TOTALPOINTS)&&(this.totalPoints=Number(window.localStorage.getItem(this.DOONIES_TOTALPOINTS)),this.currentBallSelected=Number(window.localStorage.getItem(this.DOONIES_BALLSELECTED)),this.lastTotalPointsShowed=this.totalPoints,this.refreshLastUnlockedNum(),this.lastUnlockedShownNum=this.lastUnlockedNum)},t.prototype.refreshLastUnlockedNum=function(){for(var t=1,o=1;o<8;o++)this.progressData["ball"+o].points<=this.totalPoints&&(t=o);this.lastUnlockedNum=t},t.prototype.getUnlockedBallIcon=function(t){return this.progressData["ball"+t].iconName},t.prototype.getCurrentBallProgress=function(t){console.log("getCurrentBallProgress"),console.log(t);var o=0;if(1==this.lastUnlockedShownNum)return t/this.progressData.ball2.points;if(7==this.lastUnlockedShownNum)return 0;var e=this.progressData["ball"+this.lastUnlockedShownNum].points;return o=(t-e)/(this.progressData["ball"+(this.lastUnlockedShownNum+1)].points-e),Math.min(o,1)},t}();exports.GameStatsModel=t;
},{}],"OuK+":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.MenuScene=void 0;var t=require("../CST"),a=require("../model/AnimationFactory"),n=require("../model/ButtonManager"),i=require("../model/ResizeManager"),s=require("../model/SoundPlayer"),o=require("../model/GameStatsModel"),r=function(r){function c(){var e=r.call(this,{key:t.CST.SCENES.MENU})||this;return e.debugMode=!1,e}return e(c,r),c.prototype.preload=function(){i.ResizeManager.lastHeight=0;try{a.AnimationFactory.getInstance().createBallsAnimations(this)}catch(e){this.debstr=String(e),console.log("createAnimations error")}},c.prototype.update=function(e,t){if(void 0!==window.game){window.game.canvas.getBoundingClientRect();i.ResizeManager.lastWidth==window.innerWidth&&i.ResizeManager.lastHeight==i.ResizeManager.getWindowHeight()||window.game.scale.resize(Math.round(window.innerWidth),i.ResizeManager.getWindowHeight(),window.game.scene)}},c.prototype.initSoundPlayer=function(){try{s.SoundPlayer.getInstance().currentScene=this,s.SoundPlayer.getInstance().create(),s.SoundPlayer.getInstance().musicStarted=!0}catch(e){console.log("Sound player init error")}},c.prototype.initContainers=function(){this.m_layer_cover22=this.make.container({},!1),this.m_layer_cover00=this.make.container({},!1),this.m_layer_cover33=this.make.container({},!1),this.m_layer_basic.add(this.m_layer_cover00),this.m_layer_basic.add(this.m_layer_cover22),this.m_layer_basic.add(this.m_layer_cover33)},c.prototype.initCoverImages=function(){this.backgrounds=[this.make.image({x:0,y:0,key:"PaperBG.png"}),this.make.image({x:850,y:0,key:"PaperBG.png"}),this.make.image({x:-850,y:0,key:"PaperBG.png"})],this.coverImages=[this.make.image({x:-150,y:-200,key:"balls",frame:"MadScientist"}),this.make.image({x:200,y:-150,key:"balls",frame:"Rakieta"}),this.make.image({x:-200,y:350,key:"balls",frame:"KingKong"}),this.make.image({x:0,y:-250,key:"balls",frame:"Doonies_Title"}),this.make.image({x:100,y:-120,key:"balls",frame:"Brown0033"}),this.make.image({x:-200,y:-420,key:"balls",frame:"Fogger0061"}),this.make.image({x:200,y:-390,key:"balls",frame:"Tomato0062"}),this.make.image({x:100,y:-480,key:"balls",frame:"Obstacle_BlackCrayon"}),this.make.image({x:540,y:80,key:"balls",frame:"Obstacle_Pencil"}),this.make.image({x:-300,y:-30,key:"balls",frame:"Eraser"}),this.make.image({x:-300,y:400,key:"balls",frame:"Kapsel"})],this.titleImg=this.coverImages[3];for(var e=0,t=this.backgrounds;e<t.length;e++){var a=t[e];this.m_layer_cover22.add(a)}for(var n=0,i=this.coverImages;n<i.length;n++){var s=i[n];this.m_layer_cover22.add(s)}this.coverImages[4].setScale(.7,.7),this.coverImages[5].setScale(.7,.7),this.coverImages[7].setAngle(240),this.coverImages[8].setAngle(290),this.coverImages[9].setAngle(340),this.cameras.main.setBackgroundColor(16710121)},c.prototype.create=function(){var e=this;this.cameras.main.setBackgroundColor(16777215),n.ButtonManager.getInstance().clearTweens(),this.initSoundPlayer(),this.m_layer_basic=this.make.container({},!0),i.ResizeManager.FITMODE&&(this.m_layer_basic.x=300,this.m_layer_basic.y=512),this.initContainers(),this.initCoverImages(),window.game=this.game,(i.ResizeManager.NONEMODE||i.ResizeManager.RESIZEMODE)&&window.addEventListener("resize",i.ResizeManager.getInstance().onWindowResize,!1),this.game.curSceneRef=this,this.text=this.make.bitmapText({x:-300,y:-460,font:"obelixpro",text:"0",size:63,align:0,add:!1},!1),this.m_layer_cover22.add(this.text),null!=localStorage.getItem(o.GameStatsModel.getInstance().DOONIES_HIGHSCORE)&&this.text.setText(String(localStorage.getItem(o.GameStatsModel.getInstance().DOONIES_HIGHSCORE))),(i.ResizeManager.NONEMODE||i.ResizeManager.RESIZEMODE)&&this.scale.on("resize",function(e){i.ResizeManager.getInstance().resize(e.width,i.ResizeManager.getWindowHeight(),this.game.curSceneRef)},this),o.GameStatsModel.getInstance().loadDataFromLocalStorage(),null!=window.localStorage.getItem(o.GameStatsModel.getInstance().DOONIES_HIGHSCORE)&&(this.highscoreIcon=this.make.sprite({x:-220,y:-440,key:"balls",frame:"HighscoreIcon"}),this.m_layer_cover22.add(this.highscoreIcon),this.highscoreIconTween=this.add.tween({repeat:-1,loop:!0,targets:this.highscoreIcon,scaleX:1.2,scaleY:1.2,yoyo:!0,duration:500,ease:"Sine"}),n.ButtonManager.getInstance().setupTween(this.highscoreIcon,this,0,800,700)),a.AnimationFactory.getInstance().createButtonAnimations(this),this.coverImages[0].setAngle(-10),this.coverImages[0].setScale(.7),this.coverImages[0].setAlpha(.6),this.coverImages[1].setScale(1),this.coverImages[1].setAlpha(.6),this.coverImages[2].setScale(.9),this.coverImages[2].setAlpha(.6),this.coverImages[2].setAngle(12),this.playBtn=this.make.sprite({x:80,y:250,key:"balls",frame:"Tap_0002"}).play("btnPlay"),this.m_layer_cover22.add(this.playBtn),this.musicBtn=this.make.sprite({x:this.titleImg.x+250,y:-440,key:"balls",frame:"MusicOff"}).play("soundBtnAnim"),this.m_layer_cover22.add(this.musicBtn),this.musicBtn.anims.pause(),s.SoundPlayer.getInstance().isMusicPlaying||this.musicBtn.anims.nextFrame(),this.musicBtn.setInteractive(),this.playBtn.setInteractive(),n.ButtonManager.getInstance().setupTween(this.playBtn,this,0,-800,700),n.ButtonManager.getInstance().setupTween(this.titleImg,this,0,800,500),this.input.on("pointerup",function(){e.soundSwitchBtnShape=e.musicBtn.getBounds(),e.soundSwitchBtnShape.contains(e.input.activePointer.x,e.input.activePointer.y)||(console.log("OPEN THE GATES"),s.SoundPlayer.getInstance().playSound("puck",{volume:.5}),s.SoundPlayer.getInstance().playSound("dooniesmusic",{volume:.5}),e.playBtn.anims.previousFrame(),e.game.scene.stop(t.CST.SCENES.MENU),n.ButtonManager.getInstance().clearTweens(),e.cleanMenu(),e.game.scene.start(t.CST.SCENES.PHYSICS))}),this.musicBtn.on("pointerup",function(){console.log("toggle sound"),s.SoundPlayer.getInstance().setSoundEnabled(!s.SoundPlayer.getInstance().isMusicPlaying),s.SoundPlayer.getInstance().isMusicPlaying?s.SoundPlayer.getInstance().playSound("dooniesmusic",{volume:.5}):e.sound.stopAll(),s.SoundPlayer.getInstance().playSound("puck",{volume:.5}),s.SoundPlayer.getInstance().isMusicPlaying?e.musicBtn.anims.previousFrame():e.musicBtn.anims.nextFrame()});var r=window.game;r.canvas.getBoundingClientRect();console.log(r.canvas),console.log("nonemode init1"),i.ResizeManager.NONEMODE?(console.log("nonemode init2"),r.scale.resize(Math.round(window.innerWidth),i.ResizeManager.getWindowHeight(),r.scene)):i.ResizeManager.RESIZEMODE&&r.scale.setGameSize(window.innerWidth,i.ResizeManager.getWindowHeight())},c.prototype.cleanMenu=function(){console.log("cleanGameOverScreen"),this.highscoreIconTween&&this.highscoreIconTween.remove(),this.highscoreIcon&&this.highscoreIcon.destroy(),this.m_layer_basic&&this.m_layer_basic.destroy(),this.m_layer_cover00&&this.m_layer_cover00.destroy(),this.m_layer_cover22&&this.m_layer_cover22.destroy(),this.m_layer_cover33&&this.m_layer_cover33.destroy(),this.text&&this.text.destroy(),this.playBtn&&this.playBtn.destroy()},c.prototype.setupButton=function(e){e.setInteractive(),e.on("pointerover",e.onPointerOver=function(e,t,a,n){},e),e.on("pointerout",e.onPointerOut=function(){console.log("outaa here"),this.anims.previousFrame()},e)},c}(Phaser.Scene);exports.MenuScene=r;
},{"../CST":"mOOU","../model/AnimationFactory":"mn3m","../model/ButtonManager":"YVm7","../model/ResizeManager":"Vrh8","../model/SoundPlayer":"4mTs","../model/GameStatsModel":"iqaM"}],"mGIO":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.UIManager=void 0;var e=function(){function t(){}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.createParticles=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=0),console.log("createParticles");var n=window.innerWidth/640/2,a=50,o={min:1200*n,max:3600*n},c={min:300,max:350},s={start:.4*Math.pow(n,1.1),end:0},l=-400,p=400;e&&(0==i&&(p=0),0,l=0,{min:200,max:340},c={min:200,max:340},a=20,o={min:1200*Math.pow(n,1.1),max:3600*Math.pow(n,1.1)}),t.confParticlesArr||(t.confParticlesArr=[],t.confEmittersArr=[]);for(var u=1;u<6;u++){var f="Star";t.confettiParticles=t.add.particles("balls",f),t.m_layer_cover22.add(t.confettiParticles),console.log(u);var h=t.confettiParticles.createEmitter({frame:f,x:l,y:p,lifespan:2e3,speed:o,angle:c,gravityY:1300,maxParticles:a,scale:s,quantity:16,particleClass:r});t.confParticlesArr.push(t.confettiParticles),t.confEmittersArr.push(h)}},t}();exports.UIManager=e;var r=function(e){function r(t){var r=e.call(this,t)||this;return r.t=0,r.i=0,r.decay=0,r.t=0,r.i=0,r.decay=120+30*Math.random(),r}return t(r,e),r.prototype.update=function(t,r,i){var n=e.prototype.update.call(this,t,r,i);return this.t+=t,this.i++,this.i>5&&(this.velocityX=this.velocityX*this.decay/200,this.velocityY=this.velocityY*this.decay/200),this.t-=r,n},r}(Phaser.GameObjects.Particles.Particle);
},{}],"hwMd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GameOverMediator=void 0;var e=require("../model/ButtonManager"),t=require("../model/GameStatsModel"),a=require("../model/LevelFactory"),n=require("../model/ResizeManager"),o=require("../model/UIManager"),r=function(){function r(){this.lastProgressShown=0}return r.getInstance=function(){return r.instance||(r.instance=new r),r.instance},r.prototype.cleanGameOverScreen=function(e){if(console.log("cleanGameOverScreen"),e.endScreenTTween&&e.endScreenTTween.remove(),e.endScreenTrophy&&e.endScreenTrophy.destroy(),e.endScreenTryAgain&&e.endScreenTryAgain.destroy(),e.endScreenTryAgain)for(var t=0,a=e.unlockIcons;t<a.length;t++){a[t].destroy()}e.unlockIcons.length=0;for(var n=0,o=e.unlockProgress;n<o.length;n++){o[n].destroy()}e.unlockProgress.length=0,e.ballIcon&&e.ballIcon.destroy(),e.restartBtn&&e.restartBtn.destroy()},r.prototype.createGameOverScreen=function(a){console.log("save score: "+String(a.gameStatsModel.currentScore)),r.scaleDeltaY=0,n.ResizeManager.FITMODE?r.scaleDeltaY=512:r.scaleDeltaY=400-a.m_layer_cover22.y,window.localStorage.setItem(t.GameStatsModel.getInstance().DOONIES_TOTALPOINTS,String(a.gameStatsModel.totalPoints)),window.localStorage.setItem(t.GameStatsModel.getInstance().DOONIES_BALLSELECTED,String(a.gameStatsModel.currentBallSelected)),a.gameStatsModel.currentScore>Number(window.localStorage.getItem(t.GameStatsModel.getInstance().DOONIES_HIGHSCORE))&&(o.UIManager.getInstance().createParticles(a,!0,800),window.localStorage.setItem(t.GameStatsModel.getInstance().DOONIES_HIGHSCORE,String(a.gameStatsModel.currentScore)),a.endScreenTrophy=a.make.sprite({x:0,y:-300+r.scaleDeltaY,key:"balls",frame:"HighscoreIconBigOne"}),a.m_layer_cover22.add(a.endScreenTrophy),a.endScreenTTween=a.add.tween({repeat:-1,loop:!0,targets:a.endScreenTrophy,scaleX:1.2,scaleY:1.2,yoyo:!0,duration:500,ease:"Sine"}),e.ButtonManager.getInstance().setupTween(a.endScreenTrophy,a,0,800,700)),t.GameStatsModel.getInstance().lastUnlockedShownNum=t.GameStatsModel.getInstance().lastUnlockedNum,a.endScreenTryAgain=a.make.sprite({x:0,y:-100+r.scaleDeltaY,key:"balls",frame:"Restart"}),a.endScreenTryAgain.setScale(.6),a.endScreenRTween=a.add.tween({repeat:-1,loop:!0,targets:a.endScreenTryAgain,angle:-45,yoyo:!0,duration:1e3,ease:"Sine"}),a.m_layer_cover22.add(a.endScreenTryAgain),e.ButtonManager.getInstance().setupTween(a.endScreenTryAgain,a,0,-800,700);var s=7-a.gameStatsModel.lastUnlockedNum;if(console.log("lun: "+a.gameStatsModel.lastUnlockedNum),a.gameStatsModel.lastUnlockedShownNum<7){for(var l=1;l<2+Math.min(3,s);l++){var c=void 0;if(c=1!=l?"UnknownDunia":a.gameStatsModel.getUnlockedBallIcon(a.gameStatsModel.lastUnlockedShownNum),a.gameStatsModel.lastUnlockedNum<6||6==a.gameStatsModel.lastUnlockedNum&&l<4){var g=a.make.sprite({x:125*(l-1)-125,y:110+r.scaleDeltaY,key:"balls",frame:c});2!=l&&g.setScale(.8),a.m_layer_cover22Top.add(g),a.unlockIcons.push(g)}}var d=t.GameStatsModel.getInstance().getCurrentBallProgress(a.gameStatsModel.lastTotalPointsShowed),S=t.GameStatsModel.getInstance().getCurrentBallProgress(a.gameStatsModel.totalPoints);console.log("ball progress: "+S);for(l=0;l<Math.floor(64*Math.min(1,S));l++){e.ButtonManager.getInstance().onStartCallback=63!=l?this.onProgressStart:this.onLastProgressStart;var m=a.make.sprite({x:0+63*Math.cos(Phaser.Math.DEG_TO_RAD*(5.625*l+270)),y:110+63*Math.sin(Phaser.Math.DEG_TO_RAD*(5.625*l+270))+r.scaleDeltaY,key:"balls",frame:"ProgressPart"});m.setAngle(5.625*l+270),l>Math.floor(64*d)&&(m.setAlpha(0),e.ButtonManager.getInstance().setupAlphaTween(m,a,1,100,1e3+100*(l-Math.floor(64*d)))),a.m_layer_cover22Top.add(m),a.unlockProgress.push(m)}}a.gameStatsModel.lastTotalPointsShowed=a.gameStatsModel.totalPoints,e.ButtonManager.getInstance().onStartCallback=void 0,a.restartBtn=a.make.sprite({x:0,y:300+r.scaleDeltaY,key:"balls",frame:"Btn_Play_Normal_Blue"}).play("btnPlay"),a.m_layer_cover22.add(a.restartBtn),e.ButtonManager.getInstance().setupTween(a.restartBtn,a,0,-800,500),e.ButtonManager.getInstance().setupButton(a.restartBtn,a),t.GameStatsModel.getInstance().refreshLastUnlockedNum()},r.prototype.onProgressStart=function(e){a.LevelFactory.getInstance().scene.playStarsAnim(e.targets[0].x,e.targets[0].y)},r.prototype.onLastProgressStart=function(n){var o=a.LevelFactory.getInstance().scene,s=r.getInstance();if(console.log("onLastProgressStart"),console.log(n),o.unlockProgress.length>0){t.GameStatsModel.getInstance().lastUnlockedShownNum++;var l=t.GameStatsModel.getInstance().getUnlockedBallIcon(t.GameStatsModel.getInstance().lastUnlockedShownNum);console.log("onLastProgressStart: "+l),console.log("lusn: "+t.GameStatsModel.getInstance().lastUnlockedShownNum),o.ballIcon=o.make.sprite({x:0,y:110+r.scaleDeltaY,key:"balls",frame:l}),o.ballIcon.setScale(1),o.m_layer_cover22Top.add(o.ballIcon),s.lastProgressShown+=1;for(var c=0,g=o.unlockProgress;c<g.length;c++){g[c].destroy()}if(o.unlockProgress.length=0,o.unlockIcons[0].destroy(),o.unlockIcons.shift(),o.unlockIcons[0].destroy(),o.unlockIcons[0]=o.ballIcon,o.ballIcon.setScale(.8),o.unlockIcons.length>=2&&o.unlockIcons[1].setScale(1),o.gameStatsModel.lastUnlockedShownNum<6){var d=o.make.sprite({x:375,y:110+r.scaleDeltaY,key:"balls",frame:"UnknownDunia"});d.setScale(.8),o.m_layer_cover22Top.add(d),o.unlockIcons.push(d)}if(o.gameStatsModel.lastUnlockedShownNum<8)for(var S=0;S<o.unlockIcons.length;S++){var m=o.unlockIcons[S];o.add.tween({targets:m,x:m.x-125,y:m.y,duration:500,ease:"Cubic"})}if(a.LevelFactory.getInstance().scene.playStarsAnim(n.targets[0].x,n.targets[0].y),o.gameStatsModel.lastUnlockedShownNum<8){var u=t.GameStatsModel.getInstance().getCurrentBallProgress(o.gameStatsModel.totalPoints);if(u>0)for(S=0;S<Math.floor(64*Math.min(1,u));S++){e.ButtonManager.getInstance().onStartCallback=63!=S?s.onProgressStart:s.onLastProgressStart;var i=o.make.sprite({x:0+63*Math.cos(Phaser.Math.DEG_TO_RAD*(5.625*S+270)),y:110+63*Math.sin(Phaser.Math.DEG_TO_RAD*(5.625*S+270))+r.scaleDeltaY,key:"balls",frame:"ProgressPart"});i.setAngle(5.625*S+270),i.setAlpha(0);e.ButtonManager.getInstance().setupAlphaTween(i,o,1,100,1e3+100*S);o.m_layer_cover22Top.add(i),o.unlockProgress.push(i)}}e.ButtonManager.getInstance().onStartCallback=void 0}},r.prototype.checkButtonsCollision=function(e,t,a){for(var n=!1,o=0,r=e.buttonShapes;o<r.length;o++){var s=r[o];n=n||s.contains(t,a)}return n&&(console.log("checkButtonsCollision true"),console.log(e.buttonShapes)),n},r.scaleDeltaY=0,r}();exports.GameOverMediator=r;
},{"../model/ButtonManager":"YVm7","../model/GameStatsModel":"iqaM","../model/LevelFactory":"0Zwn","../model/ResizeManager":"Vrh8","../model/UIManager":"mGIO"}],"8bpT":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])})(t,s)};return function(t,s){function a(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(a.prototype=s.prototype,new a)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.PhysicsScene=void 0;var t=require("../CST"),s=require("../model/LevelFactory"),a=require("../model/ButtonManager"),i=require("../model/ResizeManager"),l=require("../model/SoundPlayer"),o=require("../utils/Utils"),n=require("../model/GameStatsModel"),r=require("../view/GameOverMediator"),h=require("../model/UIManager"),y=function(y){function c(){var e=y.call(this,{key:t.CST.SCENES.PHYSICS})||this;return e.firstFocusSkipped=!1,e.unlockIcons=[],e.unlockProgress=[],e.debugMode=!1,e.isIE11=!1,e.isIOS=!1,e.buttonShapes=[],e.isPaused=!1,e.seenHTP=!1,e.wasPointerUp=!1,e.maxShotPoints=10,e.lastC22=0,e.levelNum=0,e.lastLevelType=0,e.levels=[],e}return e(c,y),c.prototype.preload=function(){i.ResizeManager.lastHeight=0},c.prototype.create=function(){l.SoundPlayer.getInstance().currentScene=this,this.gameStatsModel=n.GameStatsModel.getInstance(),s.LevelFactory.getInstance().createPhysicsScene(this),i.ResizeManager.getInstance().spacebar=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE),s.LevelFactory.getInstance().startPX=this.m_layer_cover22.x-this.bg1.width/2+124,console.log("this.lastLevelType1: "+this.lastLevelType),this.levelNum++,this.levelNum>1?(n.GameStatsModel.getInstance().totalPoints+=1,n.GameStatsModel.getInstance().currentScore+=1):n.GameStatsModel.getInstance().currentScore=0,this.lastLevelType=Math.max(1,this.lastLevelType);if(0==this.levels.length){this.levels[0]=24,this.levels[1]=23,this.levels[2]=22;for(var e=3;e<21;e++)this.levels[e]=e;o.Utils.shuffleArray(this.levels)}1==this.levelNum?this.lastLevelType=2:this.levelNum<2?this.lastLevelType=1+(this.lastLevelType+Math.floor(1.99999*Math.random()))%3:(this.lastLevelType=this.levels.pop(),this.lastLevelType=Math.max(3,this.lastLevelType)),console.log("this.lastLevelType2: "+this.lastLevelType),s.LevelFactory.getInstance().createLevel(this.lastLevelType,this),s.LevelFactory.getInstance().createFrame(),l.SoundPlayer.getInstance().isMusicPlaying||this.musicBtn.anims.nextFrame(),this.scoreText.setText(String(this.levelNum-1)),this.matter.world.on("collisionstart",function(e){if(this.playerBall.ballPhys&&this.playerBall.ballPhys.body)for(var t=e.pairs,s=0;s<t.length;s++)this.playerBall.ballPhys.body!=t[s].bodyA&&this.playerBall.ballPhys.body!=t[s].bodyB||(this.game.getTime()-this.playerBall.ballPhys.getData("collTime")<50?this.playerBall.ballPhys.getData("crushDamage")>0?this.playerBall.ballPhys.setData("crushDamage",this.playerBall.ballPhys.getData("crushDamage")+1):this.playerBall.ballPhys.setData("crushDamage",1):l.SoundPlayer.getInstance().playSound("marble_hit"+String(Math.floor(2.999*Math.random())+1)),this.playerBall.ballPhys.setData("collTime",this.game.getTime())),t[s].bodyA.gameObject&&t[s].bodyB.gameObject&&(t[s].bodyA.gameObject.getData("isEnemy")&&this.playerBall.ballPhys.body==t[s].bodyB||t[s].bodyB.gameObject.getData("isEnemy")&&this.playerBall.ballPhys.body==t[s].bodyA)&&(this.playerBall.ballPhys.setData("crushDamage",50),l.SoundPlayer.getInstance().playSound("saw_single"))},this),i.ResizeManager.FITMODE||i.ResizeManager.RESIZEMODE?this.matter.world.setBounds(-1300,-1200,3600,6e3).disableGravity():this.matter.world.setBounds(-300,-200,2400,4e3).disableGravity(),this.balls=[],this.playerBall.ballPhys.data.set("animNum",this.balls.length),this.balls.push(this.playerBall),this.playerBall.ballPhys.active=!0,this.input.on("pointerup",function(e){this.wasPointerUp=!0},this),this.input.on("pointerdown",function(e){if(console.log("pointerDown: "+this.isPaused),this.isPaused)return this.onResume(),void(this.isPaused=!1);if(!r.GameOverMediator.getInstance().checkButtonsCollision(this,this.input.activePointer.x,this.input.activePointer.y)){if(void 0!==this.restartBtn)return this.gotoRestart(),void(this.restartBtn=void 0);var t=o.Utils.getGlobalX(this.playerBall.ballAnim,this),s=o.Utils.getGlobalY(this.playerBall.ballAnim,this);if(Phaser.Math.Distance.Between(this.input.activePointer.x,this.input.activePointer.y,t,s)>80)console.log("pointerdown 2 miss");else if(console.log("pointerdown3"),this.playerBall&&0==a.ButtonManager.getInstance().tweenArr.length&&this.playerBall.ballPhys&&!this.playerBall.ballPhys.getData("started")){void 0!==this.leftBtn&&(console.log("scene cc: "+this.children.length),console.log("bs1: "),this.buttonShapes.splice(this.buttonShapes.indexOf(this.leftBtn.getData("shape")),1),this.leftBtn.destroy(),console.log(this.buttonShapes)),void 0!==this.rightBtn&&(this.buttonShapes.splice(this.buttonShapes.indexOf(this.rightBtn.getData("shape")),1),this.rightBtn.destroy(),this.rightBtnTween&&this.rightBtnTween.remove(),console.log(this.buttonShapes)),this.mouseStartX=o.Utils.getGlobalX(this.playerBall.ballAnim,this),this.mouseStartY=o.Utils.getGlobalY(this.playerBall.ballAnim,this),this.joystickPartA.setAlpha(1),this.joystickPartB.setAlpha(1),this.joystickPartA.setPosition(this.mouseStartX/this.m_layer_basic.scale+this.m_layer_basic.x,this.mouseStartY/this.m_layer_basic.scale+this.m_layer_basic.y),this.joystickPartB.setPosition(this.mouseStartX/this.m_layer_basic.scale+this.m_layer_basic.x,this.mouseStartY/this.m_layer_basic.scale+this.m_layer_basic.y);try{this.playerBall.ballPhys.setVelocity(0,0)}catch(h){return}for(var i=0;i<this.maxShotPoints;i++){var l=this.make.sprite({x:this.mouseStartX+50*i,y:this.mouseStartY,key:"balls",frame:"GameUI_Point"});l.setScale(.5),this.m_layer_cover22Top.add(l),this.shotPointers.push(l)}var n=this.make.sprite({x:this.mouseStartX+50*i,y:this.mouseStartY,key:"balls",frame:"GameUI_Strzalka"});n.setScale(.5),this.m_layer_cover22Top.add(n),this.shotPointers.push(n)}}},this),l.SoundPlayer.getInstance().focusListenersAdded||this.initOnFocus(),this.input.keyboard.on("keydown_W",function(e){this.showGameOver()},this)},c.prototype.update=function(e,t){if(void 0!==window.game){window.game.canvas.getBoundingClientRect();i.ResizeManager.lastWidth==window.innerWidth&&i.ResizeManager.lastHeight==i.ResizeManager.getWindowHeight()||(console.log("update resize.orientation"),console.log(window.orientation),window.game.scale.resize(Math.round(window.innerWidth),i.ResizeManager.getWindowHeight(),window.game.scene))}if(Phaser.Input.Keyboard.JustDown(i.ResizeManager.getInstance().spacebar)){console.log("just down");var o=s.LevelFactory.getInstance().frame4;o.setCollidesWith([]),o.setStatic(!1),o.setPosition(s.LevelFactory.getInstance().frame4.x,s.LevelFactory.getInstance().frame4.y-50),console.log("f4a1: "+s.LevelFactory.getInstance().frame4.y);var n=s.LevelFactory.getInstance().frame1,y=s.LevelFactory.getInstance().frame1.getData("skin"),c=this.playerBall.ballPhys,d=this.playerBall.ballAnim,m=(this.bg1.y,this.bg1.height,d.y,this.game.bm.moonEngineBootVals.gameHeight/this.m_layer_basic.scale);console.log("f4a2: "+n.y),console.log("f4a3: "+n.height/2),console.log("f4a4: "+y.y),console.log("f4a5: "+c.y),console.log("f4a6: "+d.y),console.log("f4a7: "+m),console.log("f4a7: "+s.LevelFactory.getInstance().frame4.y),o.setCollidesWith([s.LevelFactory.getInstance().cat3]),o.setStatic(!0)}if(!this.isPaused&&this.playerBall&&this.playerBall.ballPhys&&this.playerBall.ballPhys.body){if(this.playerBall&&a.ButtonManager.getInstance().tweenArr.length>0)return a.ButtonManager.getInstance().tweenArr[0].progress,void(this.matter.world.enabled&&this.matter.world.pause());if(this.matter.world.enabled||this.matter.world.resume(),s.LevelFactory.getInstance().movingObstacles.length>0)for(var p=0;p<s.LevelFactory.getInstance().movingObstacles.length;p++){var u=s.LevelFactory.getInstance().movingObstacles[p],g=0;u.circleMove?-1==u.radiant?(u.radiant=Phaser.Math.Distance.Between(u.cMoveX,u.cMoveY,u.objPhys.x,u.objPhys.y),g=u.radiant,u.objPhys.getData("isEnemy")||(u.angle=u.objPhys.angle),u.objPhys.setStatic(!1),u.objPhys.setPosition(u.cMoveX-g*Math.sin(Phaser.Math.DEG_TO_RAD*(90+u.objPhys.angle)),u.cMoveY+g*Math.cos(Phaser.Math.DEG_TO_RAD*(90+u.objPhys.angle)))):(g=u.radiant,u.objPhys.setStatic(!1),u.objPhys.getData("isEnemy")||u.objPhys.setAngle(u.angle),u.angle=u.angle-t*u.speed,u.destX=u.cMoveX-g*Math.sin(Phaser.Math.DEG_TO_RAD*(90+u.angle)),u.destY=u.cMoveY+g*Math.cos(Phaser.Math.DEG_TO_RAD*(90+u.angle)),u.objPhys.setVelocity(.2*(u.destX-u.objPhys.x),.2*(u.destY-u.objPhys.y))):(u.fixedX&&(u.objPhys.setVelocity(0,u.speed),u.objPhys.setPosition(u.startX,u.objPhys.y)),u.fixedY&&(u.objPhys.setVelocity(u.speed,0),u.objPhys.setPosition(u.objPhys.x,u.startY)),u.fixedY&&(u.speed>0?u.objPhys.x>800+s.LevelFactory.getInstance().startPX&&u.objPhys.setPosition(u.objPhys.x-800-100,u.objPhys.y):u.objPhys.x<-100+s.LevelFactory.getInstance().startPX&&u.objPhys.setPosition(u.objPhys.x+800+100,u.objPhys.y)),u.fixedX&&(u.speed>0?u.objPhys.y>1100&&u.objPhys.setPosition(u.objPhys.x,u.objPhys.y-1100-100):u.objPhys.y<-100&&u.objPhys.setPosition(u.objPhys.x,1100-(u.objPhys.y+100))),Math.abs(u.angularVelocity-u.objPhys.body.angularVelocity)>.001&&u.objPhys.setAngularVelocity(u.angularVelocity)),u.objShadow.setPosition(u.objShadow.x+u.objPhys.x-u.lastX,u.objShadow.y+u.objPhys.y-u.lastY),u.objShadow.setAngle(u.objPhys.angle),u.objSkin.setPosition(u.objSkin.x+u.objPhys.x-u.lastX,u.objSkin.y+u.objPhys.y-u.lastY),u.objPhys.getData("isEnemy")||u.objSkin.setAngle(u.objPhys.angle),u.lastX=u.objPhys.x,u.lastY=u.objPhys.y}this.playerBall.ballPhys.active;var P=.5;if(Phaser.Math.Distance.Between(0,0,this.playerBall.ballPhys.body.velocity.x,this.playerBall.ballPhys.body.velocity.y)<.2&&this.playerBall.ballPhys.setVelocity(.5*this.playerBall.ballPhys.body.velocity.x,.5*this.playerBall.ballPhys.body.velocity.y),Phaser.Math.Distance.Between(0,0,this.playerBall.ballPhys.body.velocity.x,this.playerBall.ballPhys.body.velocity.y)<.05){var b=Phaser.Math.Distance.Between(this.playerBall.ballPhys.x,this.playerBall.ballPhys.y,this.targetHole.x,this.targetHole.y);this.playerBall.ballPhys.getData("started")&&b>80&&(this.playerBall.ballPhys.setData("removeTime",this.playerBall.ballPhys.getData("removeTime")+1),this.playerBall.ballPhys.getData("removeTime")>10&&(this.playerBall.ballPhys.setData("toRemove",!0),this.levelNum=0,this.expAnim||(this.expAnim=this.make.sprite({x:this.playerBall.ballAnim.x,y:this.playerBall.ballAnim.y,key:"balls",frame:"KulaZoltaBams_F0011"}),this.m_layer_cover22.add(this.expAnim),l.SoundPlayer.getInstance().playSound("glasssmash"),l.SoundPlayer.getInstance().stopSound("marbleroll"),this.expAnim.play("bams"),this.expAnim.anims.setTimeScale(2),this.expAnim.anims.stopOnRepeat(),this.expAnim.on("animationcomplete",this.onDestroyComplete,this))))}if(this.playerBall.ballPhys.getData("crushDamage")>5&&(this.playerBall.ballPhys.setData("toRemove",!0),this.levelNum=0),this.wasPointerUp&&0!==this.mouseStartX&&0==a.ButtonManager.getInstance().tweenArr.length)if(this.joystickPartA.setAlpha(0),this.joystickPartB.setAlpha(0),this.isPaused);else if(r.GameOverMediator.getInstance().checkButtonsCollision(this,this.input.activePointer.x,this.input.activePointer.y)){for(p=0;p<this.shotPointers.length;p++)this.shotPointers[p].destroy();this.shotPointers.length=0,this.mouseStartX=0,this.mouseStartY=0}else{this.seenHTP||(this.seenHTP=!0,this.howToPlay.destroy()),this.mouseEndX=this.mouseStartX,this.mouseEndY=this.mouseStartY,this.mouseStartX=this.input.activePointer.worldX,this.mouseStartY=this.input.activePointer.worldY,l.SoundPlayer.getInstance().playSound("puck",{volume:.5}),l.SoundPlayer.getInstance().playSound("marbleroll",{volume:.5}),P=Math.min(40/Phaser.Math.Distance.Between(this.mouseStartX,this.mouseStartY,this.mouseEndX,this.mouseEndY),.5),this.playerBall.ballPhys.setVelocityX((this.mouseEndX-this.mouseStartX)*P),this.playerBall.ballPhys.setVelocityY((this.mouseEndY-this.mouseStartY)*P),this.playerBall.dir=0;var v=this.playerBall.ballPhys.body,S=Phaser.Math.Angle.Between(v.positionPrev.x,v.positionPrev.y,v.position.x,v.position.y);S=Phaser.Math.RadToDeg(S)+90,this.playerBall.prevAngle=S;for(p=0;p<this.shotPointers.length;p++)this.shotPointers[p].destroy();this.shotPointers.length=0,this.playerBall.ballPhys.getData("started")||(this.playerBall.ballPhys.setData("started",!0),this.playerBall.ballPhys.setData("removeTime",1),this.mouseStartX=0,this.mouseEndX=0)}this.wasPointerUp&&(this.wasPointerUp=!1);if(this.shotPointers.length>0){var B=Phaser.Math.Angle.Between(this.input.activePointer.worldX,this.input.activePointer.worldY,this.mouseStartX,this.mouseStartY);this.joystickPartB.setPosition(this.joystickPartA.x,this.joystickPartA.y);var f=Phaser.Math.Distance.Between(this.mouseStartX,this.mouseStartY,this.input.activePointer.worldX,this.input.activePointer.worldY);this.joystickPartB.x-=Math.min(60,f)*Math.cos(B),this.joystickPartB.y-=Math.min(60,f)*Math.sin(B);for(p=0;p<this.shotPointers.length-1;p++)this.shotPointers[p].setPosition(this.playerBall.ballAnim.x+30*(p+1.5)*Math.cos(B),this.playerBall.ballAnim.y+30*(p+1.5)*Math.sin(B)),Phaser.Math.Distance.Between(this.mouseStartX,this.mouseStartY,this.input.activePointer.worldX,this.input.activePointer.worldY)>=10*p/1?(this.shotPointers[p].setVisible(!0),this.shotPointers[p].setAngle(B),this.shotPointers[this.shotPointers.length-1].setPosition(this.playerBall.ballAnim.x+30*(p+2.5)*Math.cos(B),this.playerBall.ballAnim.y+30*(p+2.5)*Math.sin(B))):this.shotPointers[p].setVisible(!1),this.shotPointers[this.shotPointers.length-1].setVisible(!0),this.shotPointers[this.shotPointers.length-1].setAngle(B/Math.PI*180+90)}var M=Phaser.Math.Distance.Between(this.playerBall.ballPhys.x,this.playerBall.ballPhys.y,this.targetHole.x,this.targetHole.y);if(M<80){var w=this.targetHole.x-this.playerBall.ballPhys.x,x=this.targetHole.y-this.playerBall.ballPhys.y;M<5?(Math.abs(this.playerBall.ballPhys.body.velocity.x)+Math.abs(this.playerBall.ballPhys.body.velocity.y)>0&&(l.SoundPlayer.getInstance().playSound("swoosh"),l.SoundPlayer.getInstance().stopSound("marbleroll"),this.playStarsAnim(),h.UIManager.getInstance().createParticles(this,!0,800)),this.playerBall.ballPhys.setVelocity(0,0),this.playerBall.ballPhys.setPosition(this.targetHole.x,this.targetHole.y),this.playerBall.fallSpeed+=t,this.playerBall.fallSpeed>200&&this.playerBall.ballAnim.setAlpha(this.playerBall.ballAnim.alpha-this.playerBall.fallSpeed/5e3),this.playerBall.ballAnim.setScale(this.playerBall.ballAnim.scaleX-this.playerBall.fallSpeed/3e5),this.playerBall.ballPhys.alpha=0,this.playerBall.fallSpeed>900&&this.playerBall.ballPhys.setData("toRemove",!0)):(this.playerBall.ballPhys.setVelocity(1.1*this.playerBall.ballPhys.body.velocity.x*Math.abs(M)/80,1.1*this.playerBall.ballPhys.body.velocity.y*Math.abs(M)/80),this.playerBall.ballPhys.applyForce(new Phaser.Math.Vector2(5e-5*t*w,5e-5*t*x)))}var A=0;for(p=0;p<this.balls.length;p++){var I=this.balls[p],j=this.balls[p].ballPhys,D=this.balls[p].ballAnim,_=this.balls[p].ballSensor,T=this.balls[p].ballShadow,k=(v=j.body,Phaser.Math.Distance.Between(v.positionPrev.x,v.positionPrev.y,v.position.x,v.position.y));D.anims.setTimeScale(0),D.anims.resume(),D.getData("toRemove")&&(D.setVisible(!1),T.setVisible(!1),j.setVisible(!1));var X=Phaser.Math.Distance.Between(v.position.x,v.position.y,j.data.get("lastFramePosX"),j.data.get("lastFramePosY"));if(X>2){j.data.set("lastFramePosX",v.position.x),j.data.set("lastFramePosY",v.position.y);var Y=0;Y=1==I.dir?D.anims.currentFrame.index+D.anims.currentAnim.frames.length-2:D.anims.currentFrame.index,Y%=D.anims.currentAnim.frames.length,D.anims.setCurrentFrame(D.anims.currentAnim.frames[Y]),D.anims.pause(),l.SoundPlayer.getInstance().setRate("marbleroll",Math.max(.25,Math.min(.9,X/5)))}if(k>.001){S=Phaser.Math.Angle.Between(v.positionPrev.x,v.positionPrev.y,v.position.x,v.position.y);S=Phaser.Math.RadToDeg(S)+90,Math.abs(I.prevAngle-S)>90&&(I.dir=(I.dir+1)%2),D.setAngle(S+180*I.dir),I.prevAngle=S}D.setPosition(D.x+j.x-I.lastX,D.y+j.y-I.lastY),T.setPosition(T.x+j.x-I.lastX,T.y+j.y-I.lastY),I.lastX=j.x,I.lastY=j.y,_.setPosition(j.x,j.y),j.getData("toRemove")&&(j.getData("crushDamage")>5&&(this.expAnim||(this.expAnim=this.make.sprite({x:D.x,y:D.y,key:"balls",frame:"KulaZoltaBams_F0011"}),this.m_layer_cover22.add(this.expAnim),l.SoundPlayer.getInstance().playSound("glasssmash"),l.SoundPlayer.getInstance().stopSound("marbleroll"),this.expAnim.play("bams"),this.expAnim.anims.setTimeScale(2),this.expAnim.anims.stopOnRepeat(),this.expAnim.on("animationcomplete",this.onDestroyComplete,this)),D.setVisible(!1)),D.setVisible(!1),T.setVisible(!1),j.setVisible(!1),this.balls.splice(p,1),D.destroy(),_.destroy(),T.destroy(),j.destroy(),p--,A++)}!this.expAnim&&A>0&&this.showGameOver()}},c.prototype.playStarsAnim=function(e,t){if(void 0===e&&(e=-1),void 0===t&&(t=-1),-1==e?(e=o.Utils.getGlobalX(this.targetHoleSkin,this),t=o.Utils.getGlobalY(this.targetHoleSkin,this)):(e=o.Utils.getGlobalX(e,this),t=o.Utils.getGlobalY(t,this)),this.particles=this.add.particles("balls","Star"),this.emitter=this.particles.createEmitter({speed:{min:150,max:300},alpha:{start:1,end:.5},scale:.3,accelerationY:-800,lifespan:{min:300,max:500},blendMode:"NORMAL",frequency:8100,gravityY:2e3,quantity:20,maxParticles:100,x:e,y:t,on:!1}),this.confParticlesArr){if(this.confParticlesArr.length>20){console.log("cont children num: "+this.m_layer_cover22.length);for(var s=0,a=this.confParticlesArr;s<a.length;s++){a[s].destroy()}for(var i=0,l=this.confEmittersArr;i<l.length;i++){l[i].remove()}this.confParticlesArr=[],this.confEmittersArr=[]}}else this.confParticlesArr=[],this.confEmittersArr=[];this.confParticlesArr.push(this.particles),this.confEmittersArr.push(this.emitter),this.particles.emitParticleAt(e,t)},c.prototype.gotoRestart=function(){this.gameStatsModel.lastUnlockedShownNum=this.gameStatsModel.lastUnlockedNum,this.restartBtn.anims.previousFrame(),r.GameOverMediator.getInstance().cleanGameOverScreen(this),a.ButtonManager.getInstance().clearTweens(),this.game.scene.stop(t.CST.SCENES.MENU),a.ButtonManager.getInstance().clearTweens(),this.game.scene.start(t.CST.SCENES.PHYSICS)},c.prototype.showGameOver=function(){if(console.log("icon name:"+n.GameStatsModel.getInstance().getUnlockedBallIcon(n.GameStatsModel.getInstance().lastUnlockedNum)),console.log("show game over "),this.levelNum>0)return a.ButtonManager.getInstance().clearTweens(),this.game.scene.stop(t.CST.SCENES.MENU),a.ButtonManager.getInstance().clearTweens(),void this.game.scene.start(t.CST.SCENES.PHYSICS);r.GameOverMediator.getInstance().createGameOverScreen(this)},c.prototype.onDestroyComplete=function(e,t){this.expAnim.destroy(),this.expAnim=void 0,this.showGameOver()},c.prototype.onResume=function(){this.isPaused&&(l.SoundPlayer.getInstance().wasMusicPlaying&&l.SoundPlayer.getInstance().onFocusResumeUnmute(),this.btnResume.destroy(),this.pausedCurtain.destroy(),this.pausedIcon.destroy(),this.playerBall&&a.ButtonManager.getInstance().tweenArr.length>0||(this.matter.world.resume(),l.SoundPlayer.getInstance().setVolume("marbleroll",.5)))},c.prototype.gotoPause=function(){console.log("gotopause"),this.isPaused||(this.pauseBtnShape=this.pauseBtn.getBounds(),this.pausedCurtain=this.make.sprite({x:0,y:0,key:"balls",frame:"PausedCurtain"}),this.pausedCurtain.setScale(this.bg1.height/this.pausedCurtain.height),this.pausedCurtain.setAlpha(.7),this.m_layer_cover22Top.add(this.pausedCurtain),this.pausedIcon=this.make.sprite({x:0,y:-180,key:"balls",frame:"PausedIcon"}),this.m_layer_cover22Top.add(this.pausedIcon),this.btnResume=this.make.sprite({x:80,y:250,key:"balls",frame:"Tap_0002"}).play("btnPlay"),this.m_layer_cover22Top.add(this.btnResume),this.isPaused=!0,this.matter.world.pause())},c.prototype.initOnFocus=function(){!function(){var e="hidden";function t(t){if(console.log("onchange"),l.SoundPlayer.getInstance().currentScene.firstFocusSkipped){console.log(t);var s="visible",a="hidden",i={focus:s,focusin:s,pageshow:s,blur:a,focusout:a,pagehide:a};(t=t||window.event).type in i?document.body.className=i[t.type]:document.body.className=document[e]?"hidden":"visible",console.log("hidden change"),console.log(l.SoundPlayer.getInstance().currentScene),console.log("ispaused: "+l.SoundPlayer.getInstance().currentScene.isPaused),l.SoundPlayer.getInstance().currentScene.isPaused||l.SoundPlayer.getInstance().currentScene.gotoPause(),l.SoundPlayer.getInstance().onFocusMute()}else l.SoundPlayer.getInstance().currentScene.firstFocusSkipped=!0}console.log("initOnFocus"),e in document?document.addEventListener("visibilitychange",t):(e="mozHidden")in document?document.addEventListener("mozvisibilitychange",t):(e="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",t):(e="msHidden")in document?document.addEventListener("msvisibilitychange",t):"onfocusin"in document?document.onfocusin=document.onfocusout=t:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=t,l.SoundPlayer.getInstance().focusListenersAdded=!0,void 0!==document[e]&&t({type:document[e]?"blur":"focus"})}()},c}(Phaser.Scene);exports.PhysicsScene=y;
},{"../CST":"mOOU","../model/LevelFactory":"0Zwn","../model/ButtonManager":"YVm7","../model/ResizeManager":"Vrh8","../model/SoundPlayer":"4mTs","../utils/Utils":"0qTL","../model/GameStatsModel":"iqaM","../view/GameOverMediator":"hwMd","../model/UIManager":"mGIO"}],"jP6t":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./scenes/LoadScene"),n=require("./scenes/MenuScene"),a=require("./scenes/PhysicsScene");console.log("08102020");var t={type:Phaser.AUTO,parent:"game-container",scene:[e.LoadScene,n.MenuScene,a.PhysicsScene],physics:{default:"matter",matter:{debug:!1,gravity:0}},scale:{mode:Phaser.Scale.NONE,width:600,height:960,roundPixels:!0}},r=new Phaser.Game(t);r.bm={},r.bm.moonEngineBootVals={scalingEnabled:!0,gameWidth:600,gameHeight:960,gameOrientation:"Portrait",allowOrientationScreen:!0,allowOSSettingsOverrideRotationScreen:!0,tweensEnabled:!0};
},{"./scenes/LoadScene":"G1z3","./scenes/MenuScene":"OuK+","./scenes/PhysicsScene":"8bpT"}]},{},["jP6t"], null)
//# sourceMappingURL=/main.d774547d.js.map